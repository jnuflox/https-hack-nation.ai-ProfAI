"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_jnufloga_Documents_Hacknation_profai_mvp_app_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/jnufloga/Documents/Hacknation/profai_mvp/app/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_jnufloga_Documents_Hacknation_profai_mvp_app_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmpudWZsb2dhJTJGRG9jdW1lbnRzJTJGSGFja25hdGlvbiUyRnByb2ZhaV9tdnAlMkZhcHAlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGam51ZmxvZ2ElMkZEb2N1bWVudHMlMkZIYWNrbmF0aW9uJTJGcHJvZmFpX212cCUyRmFwcCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUI7QUFDdEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcHAvPzU2NTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2pudWZsb2dhL0RvY3VtZW50cy9IYWNrbmF0aW9uL3Byb2ZhaV9tdnAvYXBwL2FwcC9hcGkvY2hhdC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvam51ZmxvZ2EvRG9jdW1lbnRzL0hhY2tuYXRpb24vcHJvZmFpX212cC9hcHAvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_gemini__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/gemini */ \"(rsc)/./lib/gemini.ts\");\n/* harmony import */ var _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/enhanced-gemini */ \"(rsc)/./lib/enhanced-gemini.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_mock_data__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/mock-data */ \"(rsc)/./lib/mock-data.ts\");\n/**\n * Chat API Route for ProfAI\n * Handles conversational interactions with the AI tutor system using Gemini Pro 2.5\n * \n * DEVELOPMENT MODE:\n * - Authentication validation is disabled for easier testing\n * - Using mock user session to bypass auth requirements\n * - To enable authentication: uncomment getServerSession imports and validation\n */ \n// DESARROLLO: Comentado para facilitar pruebas\n// import { getServerSession } from 'next-auth';\n// import { authOptions } from '@/lib/auth';\n\n// Add Enhanced Gemini Service import\n\n\n\nconst dynamic = \"force-dynamic\";\nasync function POST(request) {\n    try {\n        // DESARROLLO: Usuario mock para pruebas (sin validación de autenticación)\n        const session = {\n            user: {\n                id: \"demo_user_dev\",\n                email: \"dev@profai.com\",\n                name: \"Usuario Desarrollo\"\n            }\n        };\n        const body = await request.json();\n        const { message, context, action = \"chat\", conversationId, emotionalState } = body;\n        if (!message || message.trim().length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Message is required\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(\"\\uD83D\\uDCAC Chat request for user:\", session.user.id, \"action:\", action);\n        // CAMBIO: Usar Enhanced Gemini para todos los usuarios, incluyendo demo users\n        // Eliminar el bypass de usuario demo para usar siempre la IA real\n        // Si es usuario demo, usar Enhanced Gemini directamente sin base de datos\n        if ((0,_lib_mock_data__WEBPACK_IMPORTED_MODULE_4__.isDemoUser)(session.user.id)) {\n            try {\n                // Usar Enhanced Gemini directamente para usuarios demo\n                const messageHistory = (context?.previousMessages || []).map((msg, index)=>({\n                        id: msg.id || `msg_${index}`,\n                        text: msg.content,\n                        sender: msg.role === \"user\" ? _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.MessageSender.USER : _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.MessageSender.AI,\n                        timestamp: msg.timestamp ? new Date(msg.timestamp) : new Date(),\n                        metadata: msg.metadata || {}\n                    }));\n                const chatResponse = await _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.enhancedGeminiService.analyzeAndRespond(messageHistory, message, {\n                    currentTopic: context?.currentTopic,\n                    userProfile: {\n                        name: session.user.name || \"estudiante\",\n                        learningLevel: \"intermediate\"\n                    },\n                    emotionalState: emotionalState?.primary_emotion,\n                    userName: context?.userName || session.user.name\n                });\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    conversationId: conversationId || \"demo-conversation-\" + Date.now(),\n                    data: {\n                        type: \"enhanced_chat\",\n                        message: chatResponse.text,\n                        text: chatResponse.text,\n                        content: chatResponse.text,\n                        video: chatResponse.video,\n                        suggestions: chatResponse.suggestions,\n                        audio: chatResponse.audio,\n                        metadata: {\n                            ...chatResponse.metadata,\n                            enhancedFeatures: true,\n                            emotionalAdaptation: true,\n                            videoSupport: !!chatResponse.video,\n                            audioSupport: !!chatResponse.audio?.enabled,\n                            isDemoMode: true\n                        }\n                    },\n                    metadata: {\n                        userId: session.user.id,\n                        action,\n                        isDemoMode: true,\n                        enhancedAI: true,\n                        timestamp: new Date().toISOString()\n                    }\n                });\n            } catch (error) {\n                console.error(\"❌ Enhanced Gemini error for demo user:\", error);\n                // Fallback a respuesta mock solo si Enhanced Gemini falla\n                const mockResponse = generateMockChatResponse(message, action, emotionalState);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true,\n                    conversationId: conversationId || \"mock-conversation-\" + Date.now(),\n                    data: mockResponse,\n                    metadata: {\n                        userId: session.user.id,\n                        action,\n                        isDemoMode: true,\n                        fallback: true,\n                        timestamp: new Date().toISOString()\n                    }\n                });\n            }\n        }\n        // Get user profile from database with timeout\n        let user;\n        try {\n            user = await Promise.race([\n                _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.user.findUnique({\n                    where: {\n                        id: session.user.id\n                    }\n                }),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Database timeout\")), 10000))\n            ]);\n        } catch (dbError) {\n            console.error(\"\\uD83D\\uDDC4️ Database error getting user, using fallback\");\n            // Use fallback mock response for database issues\n            const mockResponse = generateMockChatResponse(message, action, emotionalState);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                conversationId: conversationId || \"fallback-conversation-\" + Date.now(),\n                data: mockResponse,\n                metadata: {\n                    userId: session.user.id,\n                    action,\n                    isDemoMode: true,\n                    timestamp: new Date().toISOString(),\n                    warning: \"Modo de demostraci\\xf3n - base de datos no disponible\"\n                }\n            });\n        }\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Create or get conversation\n        let conversation = null;\n        if (conversationId) {\n            conversation = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.conversation.findFirst({\n                where: {\n                    id: conversationId,\n                    userId: session.user.id\n                }\n            });\n        }\n        if (!conversation) {\n            conversation = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.conversation.create({\n                data: {\n                    userId: session.user.id,\n                    title: message.substring(0, 50) + (message.length > 50 ? \"...\" : \"\"),\n                    context: {\n                        emotional_state: emotionalState?.primary_emotion || \"neutral\",\n                        adaptation_count: 0,\n                        topic: context?.currentTopic\n                    }\n                }\n            });\n        }\n        // Save user message\n        await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.message.create({\n            data: {\n                conversationId: conversation.id,\n                content: message,\n                role: \"user\",\n                emotionalState: emotionalState\n            }\n        });\n        let response;\n        switch(action){\n            case \"enhanced_chat\":\n                response = await handleEnhancedChatInteraction(user, message, context, emotionalState);\n                break;\n            case \"chat\":\n                response = await handleChatInteraction(user, message, context, emotionalState);\n                break;\n            case \"help\":\n                response = await handleHelpRequest(user, message, context, emotionalState);\n                break;\n            case \"exercise_evaluation\":\n                response = await handleExerciseEvaluation(user, message, context, emotionalState);\n                break;\n            default:\n                // Default to enhanced chat for better experience\n                response = await handleEnhancedChatInteraction(user, message, context, emotionalState);\n        }\n        // ...rest of existing code...\n        // New Enhanced Chat Handler using Enhanced Gemini Service\n        async function handleEnhancedChatInteraction(user, message, context, emotionalState) {\n            try {\n                // Convert previous messages to Enhanced Gemini format\n                const messageHistory = (context?.previousMessages || []).map((msg, index)=>({\n                        id: msg.id || `msg_${index}`,\n                        text: msg.content,\n                        sender: msg.role === \"user\" ? _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.MessageSender.USER : _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.MessageSender.AI,\n                        timestamp: msg.timestamp ? new Date(msg.timestamp) : new Date(),\n                        metadata: msg.metadata || {}\n                    }));\n                // Prepare lesson context if available\n                let enhancedContext = {\n                    currentTopic: context?.currentTopic,\n                    userProfile: {\n                        name: user?.firstName || \"estudiante\",\n                        learningLevel: \"intermediate\" // Could be derived from user data\n                    },\n                    emotionalState: emotionalState?.primary_emotion,\n                    userName: context?.userName\n                };\n                // Add lesson-specific context if available\n                if (context?.lessonPrompt) {\n                    enhancedContext = {\n                        ...enhancedContext,\n                        lessonPrompt: context.lessonPrompt,\n                        lessonId: context.lessonId,\n                        courseId: context.courseId,\n                        isLessonMode: context.isLessonMode || true\n                    };\n                }\n                // Call Enhanced Gemini Service\n                const chatResponse = await _lib_enhanced_gemini__WEBPACK_IMPORTED_MODULE_2__.enhancedGeminiService.analyzeAndRespond(messageHistory, message, enhancedContext); // Format response for the frontend\n                return {\n                    type: \"enhanced_chat\",\n                    message: chatResponse.text,\n                    text: chatResponse.text,\n                    video: chatResponse.video,\n                    suggestions: chatResponse.suggestions,\n                    audio: chatResponse.audio,\n                    metadata: {\n                        ...chatResponse.metadata,\n                        enhancedFeatures: true,\n                        emotionalAdaptation: true,\n                        videoSupport: !!chatResponse.video,\n                        audioSupport: !!chatResponse.audio?.enabled\n                    },\n                    currentTopic: context?.currentTopic,\n                    emotionalFeedback: {\n                        detectedEmotion: chatResponse.metadata?.emotion,\n                        confidence: chatResponse.metadata?.confidence,\n                        adaptedResponse: true\n                    }\n                };\n            } catch (error) {\n                console.error(\"❌ Enhanced chat error:\", error);\n                // Fallback to regular Gemini service\n                try {\n                    const fallbackResponse = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.generateChatResponse(message, context);\n                    return {\n                        type: \"chat_fallback\",\n                        message: fallbackResponse.message,\n                        text: fallbackResponse.message,\n                        followUpQuestions: fallbackResponse.followUpQuestions,\n                        relatedTopics: fallbackResponse.relatedTopics,\n                        metadata: {\n                            fallbackMode: true,\n                            error: \"Enhanced service unavailable\"\n                        }\n                    };\n                } catch (fallbackError) {\n                    console.error(\"❌ Fallback chat also failed:\", fallbackError);\n                    // Final fallback - static response\n                    return {\n                        type: \"static_fallback\",\n                        message: `Entiendo tu pregunta sobre \"${message}\". Aunque estoy teniendo problemas técnicos, puedo ayudarte con conceptos de IA. ¿Podrías ser más específico sobre qué tema te interesa?`,\n                        text: `Entiendo tu pregunta sobre \"${message}\". Aunque estoy teniendo problemas técnicos, puedo ayudarte con conceptos de IA. ¿Podrías ser más específico sobre qué tema te interesa?`,\n                        suggestions: [\n                            \"\\xbfQu\\xe9 es machine learning?\",\n                            \"Explica las redes neuronales\",\n                            \"Dame ejemplos de IA\",\n                            \"Ayuda con Python\"\n                        ],\n                        metadata: {\n                            staticFallback: true,\n                            error: \"All AI services unavailable\"\n                        }\n                    };\n                }\n            }\n        }\n        // Mock chat response generator for demo mode\n        function generateMockChatResponse(message, action, emotionalState) {\n            const lowerMessage = message.toLowerCase();\n            // Define mock responses based on common topics\n            if (lowerMessage.includes(\"machine learning\") || lowerMessage.includes(\"ml\")) {\n                return {\n                    type: \"learning_session\",\n                    lesson: {\n                        title: \"Introducci\\xf3n a Machine Learning\",\n                        content: `¡Excelente pregunta sobre Machine Learning! \n\nMachine Learning es una rama de la inteligencia artificial que permite a las computadoras aprender y tomar decisiones basándose en datos, sin ser explícitamente programadas para cada tarea específica.\n\n**Key concepts:**\n- **Supervised algorithms**: Learn from examples with known answers\n- **Unsupervised algorithms**: Find patterns in unlabeled data\n- **Reinforcement learning**: Learn through trial and error\n\n**Practical example:**\nImagine you want to teach a computer to recognize cats in photos. You show it thousands of images labeled as \"cat\" or \"not cat\", and the algorithm learns to identify the characteristics that define a cat.\n\nWould you like me to dive deeper into some specific type of algorithm or would you prefer to see an example with code?`,\n                        objectives: [\n                            \"Understand what Machine Learning is\",\n                            \"Identify the main types\",\n                            \"Visualize practical applications\"\n                        ],\n                        nextSteps: [\n                            \"Explore specific algorithms\",\n                            \"Practice with real datasets\",\n                            \"Implement your first model\"\n                        ]\n                    },\n                    recommendations: [\n                        \"Start with linear regression\",\n                        \"Practice with small datasets\",\n                        \"Use libraries like scikit-learn\"\n                    ],\n                    isDemoMode: true\n                };\n            }\n            if (lowerMessage.includes(\"neural\") || lowerMessage.includes(\"neural networks\")) {\n                return {\n                    type: \"learning_session\",\n                    lesson: {\n                        title: \"Neural Networks Explained\",\n                        content: `Neural networks are computational systems inspired by the functioning of the human brain.\n\n**Basic structure:**\n- **Artificial neurons**: Simple processing units\n- **Layers**: Groups of connected neurons\n- **Weights and biases**: Parameters that adjust during learning\n- **Activation function**: Determines when a neuron is \"activated\"\n\n**How do they learn?**\n1. Receive input data\n2. Process information through layers\n3. Compare result with correct answer\n4. Adjust weights to improve accuracy\n\n**Popular applications:**\n- Image recognition\n- Natural language processing\n- Recommendation systems\n\nWould you like me to show you a simple code example of a neural network?`,\n                        objectives: [\n                            \"Understand the structure of neural networks\",\n                            \"Know the learning process\",\n                            \"Identify applications\"\n                        ],\n                        nextSteps: [\n                            \"Implement a simple network\",\n                            \"Experiment with different architectures\",\n                            \"Learn about deep learning\"\n                        ]\n                    },\n                    recommendations: [\n                        \"Start with perceptrons\",\n                        \"Use TensorFlow or PyTorch\",\n                        \"Practice with datasets like MNIST\"\n                    ],\n                    isDemoMode: true\n                };\n            }\n            if (lowerMessage.includes(\"prompt\") || lowerMessage.includes(\"prompting\")) {\n                return {\n                    type: \"learning_session\",\n                    lesson: {\n                        title: \"Prompt Engineering Fundamentals\",\n                        content: `Prompt Engineering is the art of designing effective instructions for generative AI models.\n\n**Fundamental principles:**\n- **Clarity**: Be specific and direct\n- **Context**: Provide relevant information\n- **Structure**: Organize your prompt logically\n- **Examples**: Use few-shot learning when helpful\n\n**Advanced techniques:**\n1. **Chain-of-Thought**: Ask it to explain its reasoning\n2. **Role Playing**: Define a specific role for the AI\n3. **Template-based**: Use reusable templates\n4. **Iterative refinement**: Improve progressively\n\n**Practical example:**\n❌ Bad: \"Write code\"\n✅ Good: \"As a Python expert, write a function that calculates the factorial of a number. Include explanatory comments and error handling for invalid inputs.\"\n\nWould you like to practice creating prompts for some specific case?`,\n                        objectives: [\n                            \"Master prompt engineering principles\",\n                            \"Apply advanced techniques\",\n                            \"Optimize AI interactions\"\n                        ],\n                        nextSteps: [\n                            \"Practice with different types of prompts\",\n                            \"Experiment with diverse models\",\n                            \"Build your template library\"\n                        ]\n                    },\n                    recommendations: [\n                        \"Experiment with different styles\",\n                        \"Measure the effectiveness of your prompts\",\n                        \"Keep a repository of successful prompts\"\n                    ],\n                    isDemoMode: true\n                };\n            }\n            // Default response for general questions\n            return {\n                type: \"chat_response\",\n                content: `Hello! I'm ProfAI, your personal artificial intelligence tutor. \n\nI noticed you're asking about: \"${message}\"\n\nAs an adaptive professor, I can help you with:\n📚 **Theoretical concepts** - Clear explanations of AI, ML, Deep Learning\n🛠️ **Practical tools** - Code, libraries, implementations\n🧠 **Prompt Engineering** - Optimization of AI interactions\n🎯 **Applied projects** - Real use cases and exercises\n\nMy approach adapts to your learning style and level. I can explain from basic concepts to advanced techniques.\n\nWhat area would you like to dive into? Do you prefer to start with theory, see practical examples, or do you have a specific project in mind?`,\n                suggestions: [\n                    \"What is machine learning and how to get started?\",\n                    \"Explain neural networks with examples\",\n                    \"How to create better AI prompts?\",\n                    \"I want to do an AI project, where do I start?\"\n                ],\n                isDemoMode: true\n            };\n        }\n        // Handler for general chat interactions\n        async function handleChatInteraction(user, message, context, emotionalState) {\n            // Determine the topic and difficulty  \n            const topic = extractTopicFromMessage(message) || context?.currentTopic || \"AI concepts\";\n            const difficulty = determineUserDifficulty(user);\n            // Generate personalized lesson using Gemini\n            const lesson = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.generateLesson(topic, difficulty);\n            // Check if user wants exercises\n            const includeExercises = shouldIncludeExercises(message);\n            let exercise = null;\n            if (includeExercises) {\n                exercise = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.generateExercise(topic, difficulty);\n            }\n            return {\n                type: \"learning_session\",\n                lesson,\n                exercise,\n                recommendations: generateRecommendations(emotionalState, lesson),\n                nextSteps: generateNextSteps(lesson, exercise)\n            };\n        }\n        // Handler for help requests\n        async function handleHelpRequest(user, message, context, emotionalState) {\n            const currentContent = context?.lessonId ? await getLessonContent(context.lessonId) : null;\n            if (currentContent) {\n                // For now, provide a simple reformulated response since reformulateContent doesn't exist\n                const reformulatedContent = `Entiendo tu confusión sobre el tema. Déjame explicarlo de otra manera: ${currentContent.toString()}`;\n                return {\n                    type: \"help_response\",\n                    reformulatedContent,\n                    supportMessage: generateSupportMessage(emotionalState?.primary_emotion || \"confused\"),\n                    suggestions: [\n                        \"Would you like me to break this down further?\",\n                        \"Should I provide more examples?\",\n                        \"Do you want to try a practice exercise?\"\n                    ]\n                };\n            }\n            // General help without specific content\n            const helpResponse = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.generateContent(`The student is asking for help: \"${message}\". They seem ${emotionalState?.primary_emotion || \"neutral\"}. Provide encouraging, specific help.`, buildSystemPrompt(emotionalState, {}));\n            return {\n                type: \"general_help\",\n                content: helpResponse,\n                supportMessage: generateSupportMessage(emotionalState?.primary_emotion || \"confused\")\n            };\n        }\n        // Handler for exercise submissions\n        async function handleExerciseSubmission(user, submission, context) {\n            if (!context?.exerciseId) {\n                throw new Error(\"Exercise ID required for submission evaluation\");\n            }\n            const exercise = await getExerciseDetails(context.exerciseId);\n            const evaluation = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.evaluateSubmission(exercise, {\n                code: submission,\n                timestamp: new Date().toISOString()\n            });\n            // Update user progress\n            await updateUserProgress(user.id, context.exerciseId, evaluation);\n            return {\n                type: \"exercise_evaluation\",\n                evaluation,\n                progressUpdate: await getUserProgressUpdate(user.id),\n                nextSteps: generatePostEvaluationSteps(evaluation)\n            };\n        }\n        // Handler for reformulation requests\n        async function handleReformulationRequest(user, feedback, context, emotionalState) {\n            const currentContent = context?.lessonId ? await getLessonContent(context.lessonId) : null;\n            if (!currentContent) {\n                return {\n                    type: \"error\",\n                    message: \"No content available for reformulation\"\n                };\n            }\n            // Simple reformulation since the API method doesn't exist yet\n            const reformulatedContent = `Entiendo tu confusión. Déjame explicarlo de otra manera: ${currentContent}`;\n            return {\n                type: \"reformulation\",\n                originalEmotion: emotionalState?.primary_emotion || \"confused\",\n                newExplanation: reformulatedContent,\n                encouragement: generateEncouragementMessage(),\n                suggestions: [\n                    \"Is this clearer now?\",\n                    \"Would you like even more examples?\",\n                    \"Ready to try a practice exercise?\"\n                ]\n            };\n        }\n        // Utility functions\n        function extractTopicFromMessage(message) {\n            const aiTopics = [\n                \"machine learning\",\n                \"deep learning\",\n                \"neural networks\",\n                \"transformers\",\n                \"llm\",\n                \"gpt\",\n                \"prompt engineering\",\n                \"fine-tuning\",\n                \"embeddings\",\n                \"rag\",\n                \"retrieval augmented generation\",\n                \"langchain\",\n                \"openai\",\n                \"hugging face\"\n            ];\n            const lowerMessage = message.toLowerCase();\n            for (const topic of aiTopics){\n                if (lowerMessage.includes(topic)) {\n                    return topic;\n                }\n            }\n            return null;\n        }\n        function determineUserDifficulty(user) {\n            const skillLevel = user.skillLevel;\n            if (!skillLevel) return \"beginner\";\n            const levels = [\n                skillLevel.theory,\n                skillLevel.tooling,\n                skillLevel.prompting\n            ].filter(Boolean);\n            const avgLevel = levels.reduce((sum, level)=>{\n                let score;\n                if (level === \"beginner\") {\n                    score = 1;\n                } else if (level === \"intermediate\") {\n                    score = 2;\n                } else {\n                    score = 3;\n                }\n                return sum + score;\n            }, 0) / levels.length;\n            if (avgLevel <= 1.5) return \"beginner\";\n            if (avgLevel <= 2.5) return \"intermediate\";\n            return \"advanced\";\n        }\n        function determineLearningStyle(user) {\n            const preferences = user.preferences;\n            return preferences?.preferred_format || \"hybrid\";\n        }\n        function getUserBackground(user) {\n            const skillLevel = user.skillLevel;\n            if (!skillLevel) return \"General audience with mixed background\";\n            const levels = [];\n            if (skillLevel.theory) levels.push(`Theory: ${skillLevel.theory}`);\n            if (skillLevel.tooling) levels.push(`Tooling: ${skillLevel.tooling}`);\n            if (skillLevel.prompting) levels.push(`Prompting: ${skillLevel.prompting}`);\n            return levels.join(\", \");\n        }\n        function shouldIncludeExercises(message) {\n            const practiceKeywords = [\n                \"practice\",\n                \"exercise\",\n                \"code\",\n                \"example\",\n                \"try\",\n                \"build\",\n                \"implement\"\n            ];\n            const lowerMessage = message.toLowerCase();\n            return practiceKeywords.some((keyword)=>lowerMessage.includes(keyword));\n        }\n        function buildSystemPrompt(emotionalState, context) {\n            const userName = context?.userName || \"student\";\n            const emotion = emotionalState?.primary_emotion || \"neutral\";\n            const isConfused = emotionalState?.detected_confusion || false;\n            let basePrompt = `You are ProfAI, an expert professor in artificial intelligence with advanced emotional intelligence. \n\nYour personality is:\n- Empathetic and adaptive\n- Clear in explanations but academically rigorous  \n- You detect emotions and adjust your teaching style\n- You combine solid theory with practical examples\n- You use analogies when necessary to simplify\n\nThe student is called ${userName}.`;\n            // Adaptation based on emotional state\n            if (isConfused || emotion === \"confusion\") {\n                basePrompt += `\\n\\n🧠 EMOTIONAL STATE DETECTED: CONFUSION\n- Use simpler step-by-step explanations\n- Include real-world analogies\n- Ask if they need more clarification\n- Break complex concepts into small parts\n- Be especially patient and encouraging`;\n            } else if (emotion === \"frustration\") {\n                basePrompt += `\\n\\n😤 EMOTIONAL STATE DETECTED: FRUSTRATION  \n- Be extra understanding and encouraging\n- Offer a different approach to the problem\n- Suggest taking a break if necessary\n- Simplify the explanation\n- Highlight that frustration is normal in learning`;\n            } else if (emotion === \"curiosity\") {\n                basePrompt += `\\n\\n🤔 EMOTIONAL STATE DETECTED: CURIOSITY\n- Can go deeper into details\n- Add extra interesting information\n- Suggest additional resources\n- Connect with related topics\n- Encourage exploration`;\n            }\n            basePrompt += `\\n\\nALWAYS RESPOND IN ENGLISH in a clear, structured and educational way. Use emojis occasionally to make the conversation more friendly.`;\n            return basePrompt;\n        }\n        function generateRecommendations(emotionalState, lesson) {\n            const recommendations = [];\n            if (emotionalState?.primary_emotion === \"confused\") {\n                recommendations.push(\"Take your time with this concept\");\n                recommendations.push(\"Review the examples carefully\");\n            } else if (emotionalState?.primary_emotion === \"engaged\") {\n                recommendations.push(\"Great enthusiasm! Keep going\");\n                recommendations.push(\"Ready for more advanced topics\");\n            }\n            return recommendations;\n        }\n        function generateNextSteps(lesson, exercise) {\n            const steps = [];\n            if (lesson) {\n                steps.push(\"Review the lesson concepts\");\n            }\n            if (exercise) {\n                steps.push(\"Try the practice exercise\");\n            } else {\n                steps.push(\"Ask for a practice exercise when ready\");\n            }\n            steps.push(\"Let me know if you need clarification\");\n            return steps;\n        }\n        function generateSupportMessage(emotion) {\n            const supportMessages = {\n                frustrated: \"I understand this can be challenging. Let's break it down step by step.\",\n                confused: \"No worries! Let me try a different approach to explain this.\",\n                bored: \"Ready for something more challenging? Let's kick it up a notch!\",\n                neutral: \"You're doing great! Keep up the good work.\",\n                engaged: \"I love your enthusiasm! Let's keep building on that momentum.\"\n            };\n            return supportMessages[emotion] || supportMessages.neutral;\n        }\n        function generateEncouragementMessage() {\n            const messages = [\n                \"Learning is a journey, and every question helps you grow!\",\n                \"Great job asking for clarification - that's how experts think!\",\n                \"Your curiosity is exactly what makes a great AI practitioner!\"\n            ];\n            return messages[Math.floor(Math.random() * messages.length)];\n        }\n        function generatePostEvaluationSteps(evaluation) {\n            const steps = [];\n            if (evaluation.score >= 80) {\n                steps.push(\"Excellent work! Ready for the next challenge\");\n            } else if (evaluation.score >= 60) {\n                steps.push(\"Good progress! Review feedback and try again\");\n            } else {\n                steps.push(\"Review the concepts and try again\");\n                steps.push(\"Ask for help if you need clarification\");\n            }\n            return steps;\n        }\n        // Database helper functions - temporary implementations\n        async function getLessonContent(lessonId) {\n            return `Contenido de la lección ${lessonId}: Este es contenido de ejemplo mientras se implementa la base de datos completa.`;\n        }\n        async function getExerciseDetails(exerciseId) {\n            // Temporary mock data while database tables are being implemented\n            return {\n                title: `Ejercicio ${exerciseId}`,\n                description: \"Ejercicio de ejemplo mientras se implementa la base de datos\",\n                instructions: [\n                    \"Completa el ejercicio\",\n                    \"Sigue las mejores pr\\xe1cticas\"\n                ],\n                evaluationCriteria: [\n                    \"Correctitud\",\n                    \"Estilo de c\\xf3digo\",\n                    \"Eficiencia\"\n                ]\n            };\n        }\n        async function updateUserProgress(userId, exerciseId, evaluation) {\n            console.log(`Progress updated for user ${userId} on exercise ${exerciseId}`);\n            // Update user stats (this table exists)\n            if (evaluation.score && evaluation.score >= 70) {\n                await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.user.update({\n                    where: {\n                        id: userId\n                    },\n                    data: {\n                        totalLessonsCompleted: {\n                            increment: 1\n                        },\n                        lastActiveAt: new Date()\n                    }\n                });\n            }\n        }\n        async function getUserProgressUpdate(userId) {\n            const user = await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.user.findUnique({\n                where: {\n                    id: userId\n                },\n                select: {\n                    totalLessonsCompleted: true,\n                    currentStreak: true,\n                    lastActiveAt: true\n                }\n            });\n            return user;\n        }\n        // Handler for exercise evaluation  \n        async function handleExerciseEvaluation(user, message, context, emotionalState) {\n            if (!context?.exerciseId) {\n                // If no specific exercise, treat as general code evaluation\n                const evaluation = await _lib_gemini__WEBPACK_IMPORTED_MODULE_1__.geminiService.generateContent(`Evaluate this student's work: \"${message}\". Provide constructive feedback.`, buildSystemPrompt(emotionalState, context));\n                return {\n                    type: \"code_evaluation\",\n                    feedback: evaluation,\n                    score: null,\n                    suggestions: [\n                        \"\\xbfQuieres intentar otro ejercicio?\",\n                        \"\\xbfNecesitas m\\xe1s explicaci\\xf3n sobre alg\\xfan concepto?\",\n                        \"\\xbfTe gustar\\xeda ver un ejemplo mejorado?\"\n                    ]\n                };\n            }\n            return await handleExerciseSubmission(user, message, context);\n        }\n        // Save assistant response\n        await _lib_db__WEBPACK_IMPORTED_MODULE_3__.prisma.message.create({\n            data: {\n                conversationId: conversation.id,\n                content: typeof response === \"string\" ? response : JSON.stringify(response),\n                role: \"assistant\"\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            conversationId: conversation.id,\n            data: response,\n            metadata: {\n                userId: session.user.id,\n                action,\n                timestamp: new Date().toISOString()\n            }\n        });\n    } catch (error) {\n        console.error(\"❌ Chat API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            message: error instanceof Error ? error.message : \"Unknown error\",\n            fallbackResponse: {\n                type: \"error_fallback\",\n                message: \"Disculpa, estoy teniendo problemas t\\xe9cnicos. \\xbfPuedes intentar reformular tu pregunta?\",\n                suggestions: [\n                    \"\\xbfQu\\xe9 es machine learning?\",\n                    \"Expl\\xedcame las redes neuronales\",\n                    \"Ay\\xfadame con prompt engineering\",\n                    \"Quiero aprender sobre IA\"\n                ]\n            }\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUMsTUFBTW1DO1lBQ043QyxVQUFVO2dCQUNScUIsUUFBUXBELFFBQVFDLElBQUksQ0FBQ0MsRUFBRTtnQkFDdkJPO2dCQUNBb0IsV0FBVyxJQUFJQyxPQUFPd0IsV0FBVztZQUNuQztRQUNGO0lBRUYsRUFBRSxPQUFPeEMsT0FBTztRQUNkRSxRQUFRRixLQUFLLENBQUMscUJBQXFCQTtRQUVuQyxPQUFPdkIscURBQVlBLENBQUNlLElBQUksQ0FDdEI7WUFDRVEsT0FBTztZQUNQUCxTQUFTTyxpQkFBaUJtRCxRQUFRbkQsTUFBTVAsT0FBTyxHQUFHO1lBQ2xEcUYsa0JBQWtCO2dCQUNoQmxELE1BQU07Z0JBQ05uQyxTQUFTO2dCQUNUcUMsYUFBYTtvQkFDWDtvQkFDQTtvQkFDQTtvQkFDQTtpQkFDRDtZQUNIO1FBQ0YsR0FDQTtZQUFFN0IsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcHAvLi9hcHAvYXBpL2NoYXQvcm91dGUudHM/ZGU0NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENoYXQgQVBJIFJvdXRlIGZvciBQcm9mQUlcbiAqIEhhbmRsZXMgY29udmVyc2F0aW9uYWwgaW50ZXJhY3Rpb25zIHdpdGggdGhlIEFJIHR1dG9yIHN5c3RlbSB1c2luZyBHZW1pbmkgUHJvIDIuNVxuICogXG4gKiBERVZFTE9QTUVOVCBNT0RFOlxuICogLSBBdXRoZW50aWNhdGlvbiB2YWxpZGF0aW9uIGlzIGRpc2FibGVkIGZvciBlYXNpZXIgdGVzdGluZ1xuICogLSBVc2luZyBtb2NrIHVzZXIgc2Vzc2lvbiB0byBieXBhc3MgYXV0aCByZXF1aXJlbWVudHNcbiAqIC0gVG8gZW5hYmxlIGF1dGhlbnRpY2F0aW9uOiB1bmNvbW1lbnQgZ2V0U2VydmVyU2Vzc2lvbiBpbXBvcnRzIGFuZCB2YWxpZGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbi8vIERFU0FSUk9MTE86IENvbWVudGFkbyBwYXJhIGZhY2lsaXRhciBwcnVlYmFzXG4vLyBpbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJztcbi8vIGltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCc7XG5pbXBvcnQgeyBnZW1pbmlTZXJ2aWNlIH0gZnJvbSAnQC9saWIvZ2VtaW5pJztcbi8vIEFkZCBFbmhhbmNlZCBHZW1pbmkgU2VydmljZSBpbXBvcnRcbmltcG9ydCB7IGVuaGFuY2VkR2VtaW5pU2VydmljZSwgTWVzc2FnZVNlbmRlciwgdHlwZSBNZXNzYWdlIGFzIEVuaGFuY2VkTWVzc2FnZSwgdHlwZSBDaGF0UmVzcG9uc2UgfSBmcm9tICdAL2xpYi9lbmhhbmNlZC1nZW1pbmknO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvZGInO1xuaW1wb3J0IHsgaXNEZW1vVXNlciB9IGZyb20gJ0AvbGliL21vY2stZGF0YSc7XG5cbmV4cG9ydCBjb25zdCBkeW5hbWljID0gXCJmb3JjZS1keW5hbWljXCI7XG5cbmludGVyZmFjZSBDaGF0UmVxdWVzdCB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgY29udmVyc2F0aW9uSWQ/OiBzdHJpbmc7XG4gIGNvbnRleHQ/OiBhbnk7XG4gIGFjdGlvbj86ICdjaGF0JyB8ICdoZWxwJyB8ICdleGVyY2lzZV9ldmFsdWF0aW9uJyB8ICdlbmhhbmNlZF9jaGF0JztcbiAgZW1vdGlvbmFsU3RhdGU/OiB7XG4gICAgcHJpbWFyeV9lbW90aW9uOiBzdHJpbmc7XG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xuICAgIGRldGVjdGVkX2NvbmZ1c2lvbj86IGJvb2xlYW47XG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gREVTQVJST0xMTzogVXN1YXJpbyBtb2NrIHBhcmEgcHJ1ZWJhcyAoc2luIHZhbGlkYWNpw7NuIGRlIGF1dGVudGljYWNpw7NuKVxuICAgIGNvbnN0IHNlc3Npb24gPSB7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiAnZGVtb191c2VyX2RldicsXG4gICAgICAgIGVtYWlsOiAnZGV2QHByb2ZhaS5jb20nLFxuICAgICAgICBuYW1lOiAnVXN1YXJpbyBEZXNhcnJvbGxvJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBib2R5OiBDaGF0UmVxdWVzdCA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgY29udGV4dCwgYWN0aW9uID0gJ2NoYXQnLCBjb252ZXJzYXRpb25JZCwgZW1vdGlvbmFsU3RhdGUgfSA9IGJvZHk7XG5cbiAgICBpZiAoIW1lc3NhZ2UgfHwgbWVzc2FnZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdNZXNzYWdlIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ/CfkqwgQ2hhdCByZXF1ZXN0IGZvciB1c2VyOicsIHNlc3Npb24udXNlci5pZCwgJ2FjdGlvbjonLCBhY3Rpb24pO1xuXG4gICAgLy8gQ0FNQklPOiBVc2FyIEVuaGFuY2VkIEdlbWluaSBwYXJhIHRvZG9zIGxvcyB1c3VhcmlvcywgaW5jbHV5ZW5kbyBkZW1vIHVzZXJzXG4gICAgLy8gRWxpbWluYXIgZWwgYnlwYXNzIGRlIHVzdWFyaW8gZGVtbyBwYXJhIHVzYXIgc2llbXByZSBsYSBJQSByZWFsXG4gICAgXG4gICAgLy8gU2kgZXMgdXN1YXJpbyBkZW1vLCB1c2FyIEVuaGFuY2VkIEdlbWluaSBkaXJlY3RhbWVudGUgc2luIGJhc2UgZGUgZGF0b3NcbiAgICBpZiAoaXNEZW1vVXNlcihzZXNzaW9uLnVzZXIuaWQpKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBVc2FyIEVuaGFuY2VkIEdlbWluaSBkaXJlY3RhbWVudGUgcGFyYSB1c3VhcmlvcyBkZW1vXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5OiBFbmhhbmNlZE1lc3NhZ2VbXSA9IChjb250ZXh0Py5wcmV2aW91c01lc3NhZ2VzIHx8IFtdKS5tYXAoKG1zZzogYW55LCBpbmRleDogbnVtYmVyKSA9PiAoe1xuICAgICAgICAgIGlkOiBtc2cuaWQgfHwgYG1zZ18ke2luZGV4fWAsXG4gICAgICAgICAgdGV4dDogbXNnLmNvbnRlbnQsXG4gICAgICAgICAgc2VuZGVyOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gTWVzc2FnZVNlbmRlci5VU0VSIDogTWVzc2FnZVNlbmRlci5BSSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG1zZy50aW1lc3RhbXAgPyBuZXcgRGF0ZShtc2cudGltZXN0YW1wKSA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgbWV0YWRhdGE6IG1zZy5tZXRhZGF0YSB8fCB7fVxuICAgICAgICB9KSk7XG5cbiAgICAgICAgY29uc3QgY2hhdFJlc3BvbnNlOiBDaGF0UmVzcG9uc2UgPSBhd2FpdCBlbmhhbmNlZEdlbWluaVNlcnZpY2UuYW5hbHl6ZUFuZFJlc3BvbmQoXG4gICAgICAgICAgbWVzc2FnZUhpc3RvcnksXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBjdXJyZW50VG9waWM6IGNvbnRleHQ/LmN1cnJlbnRUb3BpYyxcbiAgICAgICAgICAgIHVzZXJQcm9maWxlOiB7XG4gICAgICAgICAgICAgIG5hbWU6IHNlc3Npb24udXNlci5uYW1lIHx8ICdlc3R1ZGlhbnRlJyxcbiAgICAgICAgICAgICAgbGVhcm5pbmdMZXZlbDogJ2ludGVybWVkaWF0ZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbW90aW9uYWxTdGF0ZTogZW1vdGlvbmFsU3RhdGU/LnByaW1hcnlfZW1vdGlvbixcbiAgICAgICAgICAgIHVzZXJOYW1lOiBjb250ZXh0Py51c2VyTmFtZSB8fCBzZXNzaW9uLnVzZXIubmFtZVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkIHx8ICdkZW1vLWNvbnZlcnNhdGlvbi0nICsgRGF0ZS5ub3coKSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICB0eXBlOiAnZW5oYW5jZWRfY2hhdCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBjaGF0UmVzcG9uc2UudGV4dCxcbiAgICAgICAgICAgIHRleHQ6IGNoYXRSZXNwb25zZS50ZXh0LFxuICAgICAgICAgICAgY29udGVudDogY2hhdFJlc3BvbnNlLnRleHQsIC8vIEFncmVnYXIgdGFtYmnDqW4gY29udGVudCBwYXJhIGNvbXBhdGliaWxpZGFkXG4gICAgICAgICAgICB2aWRlbzogY2hhdFJlc3BvbnNlLnZpZGVvLFxuICAgICAgICAgICAgc3VnZ2VzdGlvbnM6IGNoYXRSZXNwb25zZS5zdWdnZXN0aW9ucyxcbiAgICAgICAgICAgIGF1ZGlvOiBjaGF0UmVzcG9uc2UuYXVkaW8sXG4gICAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgICAuLi5jaGF0UmVzcG9uc2UubWV0YWRhdGEsXG4gICAgICAgICAgICAgIGVuaGFuY2VkRmVhdHVyZXM6IHRydWUsXG4gICAgICAgICAgICAgIGVtb3Rpb25hbEFkYXB0YXRpb246IHRydWUsXG4gICAgICAgICAgICAgIHZpZGVvU3VwcG9ydDogISFjaGF0UmVzcG9uc2UudmlkZW8sXG4gICAgICAgICAgICAgIGF1ZGlvU3VwcG9ydDogISFjaGF0UmVzcG9uc2UuYXVkaW8/LmVuYWJsZWQsXG4gICAgICAgICAgICAgIGlzRGVtb01vZGU6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgIGFjdGlvbixcbiAgICAgICAgICAgIGlzRGVtb01vZGU6IHRydWUsXG4gICAgICAgICAgICBlbmhhbmNlZEFJOiB0cnVlLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRW5oYW5jZWQgR2VtaW5pIGVycm9yIGZvciBkZW1vIHVzZXI6JywgZXJyb3IpO1xuICAgICAgICBcbiAgICAgICAgLy8gRmFsbGJhY2sgYSByZXNwdWVzdGEgbW9jayBzb2xvIHNpIEVuaGFuY2VkIEdlbWluaSBmYWxsYVxuICAgICAgICBjb25zdCBtb2NrUmVzcG9uc2UgPSBnZW5lcmF0ZU1vY2tDaGF0UmVzcG9uc2UobWVzc2FnZSwgYWN0aW9uLCBlbW90aW9uYWxTdGF0ZSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbklkIHx8ICdtb2NrLWNvbnZlcnNhdGlvbi0nICsgRGF0ZS5ub3coKSxcbiAgICAgICAgICBkYXRhOiBtb2NrUmVzcG9uc2UsXG4gICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgaXNEZW1vTW9kZTogdHJ1ZSxcbiAgICAgICAgICAgIGZhbGxiYWNrOiB0cnVlLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdldCB1c2VyIHByb2ZpbGUgZnJvbSBkYXRhYmFzZSB3aXRoIHRpbWVvdXRcbiAgICBsZXQgdXNlcjtcbiAgICB0cnkge1xuICAgICAgdXNlciA9IGF3YWl0IFByb21pc2UucmFjZShbXG4gICAgICAgIHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uLnVzZXIuaWQgfVxuICAgICAgICB9KSxcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCdEYXRhYmFzZSB0aW1lb3V0JykpLCAxMDAwMClcbiAgICAgICAgKVxuICAgICAgXSk7XG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign8J+XhO+4jyBEYXRhYmFzZSBlcnJvciBnZXR0aW5nIHVzZXIsIHVzaW5nIGZhbGxiYWNrJyk7XG4gICAgICAvLyBVc2UgZmFsbGJhY2sgbW9jayByZXNwb25zZSBmb3IgZGF0YWJhc2UgaXNzdWVzXG4gICAgICBjb25zdCBtb2NrUmVzcG9uc2UgPSBnZW5lcmF0ZU1vY2tDaGF0UmVzcG9uc2UobWVzc2FnZSwgYWN0aW9uLCBlbW90aW9uYWxTdGF0ZSk7XG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb25JZCB8fCAnZmFsbGJhY2stY29udmVyc2F0aW9uLScgKyBEYXRlLm5vdygpLFxuICAgICAgICBkYXRhOiBtb2NrUmVzcG9uc2UsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgIGlzRGVtb01vZGU6IHRydWUsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgd2FybmluZzogJ01vZG8gZGUgZGVtb3N0cmFjacOzbiAtIGJhc2UgZGUgZGF0b3Mgbm8gZGlzcG9uaWJsZSdcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBvciBnZXQgY29udmVyc2F0aW9uXG4gICAgbGV0IGNvbnZlcnNhdGlvbiA9IG51bGw7XG4gICAgaWYgKGNvbnZlcnNhdGlvbklkKSB7XG4gICAgICBjb252ZXJzYXRpb24gPSBhd2FpdCBwcmlzbWEuY29udmVyc2F0aW9uLmZpbmRGaXJzdCh7XG4gICAgICAgIHdoZXJlOiB7IFxuICAgICAgICAgIGlkOiBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFjb252ZXJzYXRpb24pIHtcbiAgICAgIGNvbnZlcnNhdGlvbiA9IGF3YWl0IHByaXNtYS5jb252ZXJzYXRpb24uY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgIHRpdGxlOiBtZXNzYWdlLnN1YnN0cmluZygwLCA1MCkgKyAobWVzc2FnZS5sZW5ndGggPiA1MCA/ICcuLi4nIDogJycpLFxuICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgIGVtb3Rpb25hbF9zdGF0ZTogZW1vdGlvbmFsU3RhdGU/LnByaW1hcnlfZW1vdGlvbiB8fCAnbmV1dHJhbCcsXG4gICAgICAgICAgICBhZGFwdGF0aW9uX2NvdW50OiAwLFxuICAgICAgICAgICAgdG9waWM6IGNvbnRleHQ/LmN1cnJlbnRUb3BpY1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2F2ZSB1c2VyIG1lc3NhZ2VcbiAgICBhd2FpdCBwcmlzbWEubWVzc2FnZS5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICBjb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uLmlkLFxuICAgICAgICBjb250ZW50OiBtZXNzYWdlLFxuICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgIGVtb3Rpb25hbFN0YXRlOiBlbW90aW9uYWxTdGF0ZVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbGV0IHJlc3BvbnNlO1xuXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgIGNhc2UgJ2VuaGFuY2VkX2NoYXQnOlxuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGhhbmRsZUVuaGFuY2VkQ2hhdEludGVyYWN0aW9uKHVzZXIsIG1lc3NhZ2UsIGNvbnRleHQsIGVtb3Rpb25hbFN0YXRlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjaGF0JzpcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVDaGF0SW50ZXJhY3Rpb24odXNlciwgbWVzc2FnZSwgY29udGV4dCwgZW1vdGlvbmFsU3RhdGUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2hlbHAnOlxuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGhhbmRsZUhlbHBSZXF1ZXN0KHVzZXIsIG1lc3NhZ2UsIGNvbnRleHQsIGVtb3Rpb25hbFN0YXRlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdleGVyY2lzZV9ldmFsdWF0aW9uJzpcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVFeGVyY2lzZUV2YWx1YXRpb24odXNlciwgbWVzc2FnZSwgY29udGV4dCwgZW1vdGlvbmFsU3RhdGUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIC8vIERlZmF1bHQgdG8gZW5oYW5jZWQgY2hhdCBmb3IgYmV0dGVyIGV4cGVyaWVuY2VcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVFbmhhbmNlZENoYXRJbnRlcmFjdGlvbih1c2VyLCBtZXNzYWdlLCBjb250ZXh0LCBlbW90aW9uYWxTdGF0ZSk7XG4gICAgfVxuXG4gICAgLy8gLi4ucmVzdCBvZiBleGlzdGluZyBjb2RlLi4uXG5cbi8vIE5ldyBFbmhhbmNlZCBDaGF0IEhhbmRsZXIgdXNpbmcgRW5oYW5jZWQgR2VtaW5pIFNlcnZpY2VcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUVuaGFuY2VkQ2hhdEludGVyYWN0aW9uKFxuICB1c2VyOiBhbnksIFxuICBtZXNzYWdlOiBzdHJpbmcsIFxuICBjb250ZXh0OiBhbnksIFxuICBlbW90aW9uYWxTdGF0ZTogYW55XG4pOiBQcm9taXNlPGFueT4ge1xuICB0cnkge1xuICAgIC8vIENvbnZlcnQgcHJldmlvdXMgbWVzc2FnZXMgdG8gRW5oYW5jZWQgR2VtaW5pIGZvcm1hdFxuICAgIGNvbnN0IG1lc3NhZ2VIaXN0b3J5OiBFbmhhbmNlZE1lc3NhZ2VbXSA9IChjb250ZXh0Py5wcmV2aW91c01lc3NhZ2VzIHx8IFtdKS5tYXAoKG1zZzogYW55LCBpbmRleDogbnVtYmVyKSA9PiAoe1xuICAgICAgaWQ6IG1zZy5pZCB8fCBgbXNnXyR7aW5kZXh9YCxcbiAgICAgIHRleHQ6IG1zZy5jb250ZW50LFxuICAgICAgc2VuZGVyOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gTWVzc2FnZVNlbmRlci5VU0VSIDogTWVzc2FnZVNlbmRlci5BSSxcbiAgICAgIHRpbWVzdGFtcDogbXNnLnRpbWVzdGFtcCA/IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApIDogbmV3IERhdGUoKSxcbiAgICAgIG1ldGFkYXRhOiBtc2cubWV0YWRhdGEgfHwge31cbiAgICB9KSk7XG5cbiAgICAvLyBQcmVwYXJlIGxlc3NvbiBjb250ZXh0IGlmIGF2YWlsYWJsZVxuICAgIGxldCBlbmhhbmNlZENvbnRleHQ6IHtcbiAgICAgIGN1cnJlbnRUb3BpYz86IHN0cmluZztcbiAgICAgIHVzZXJQcm9maWxlPzogYW55O1xuICAgICAgZW1vdGlvbmFsU3RhdGU/OiBzdHJpbmc7XG4gICAgICB1c2VyTmFtZT86IHN0cmluZztcbiAgICAgIGxlc3NvblByb21wdD86IHN0cmluZztcbiAgICAgIGxlc3NvbklkPzogc3RyaW5nO1xuICAgICAgY291cnNlSWQ/OiBzdHJpbmc7XG4gICAgICBpc0xlc3Nvbk1vZGU/OiBib29sZWFuO1xuICAgIH0gPSB7XG4gICAgICBjdXJyZW50VG9waWM6IGNvbnRleHQ/LmN1cnJlbnRUb3BpYyxcbiAgICAgIHVzZXJQcm9maWxlOiB7XG4gICAgICAgIG5hbWU6IHVzZXI/LmZpcnN0TmFtZSB8fCAnZXN0dWRpYW50ZScsXG4gICAgICAgIGxlYXJuaW5nTGV2ZWw6ICdpbnRlcm1lZGlhdGUnIC8vIENvdWxkIGJlIGRlcml2ZWQgZnJvbSB1c2VyIGRhdGFcbiAgICAgIH0sXG4gICAgICBlbW90aW9uYWxTdGF0ZTogZW1vdGlvbmFsU3RhdGU/LnByaW1hcnlfZW1vdGlvbixcbiAgICAgIHVzZXJOYW1lOiBjb250ZXh0Py51c2VyTmFtZVxuICAgIH07XG5cbiAgICAvLyBBZGQgbGVzc29uLXNwZWNpZmljIGNvbnRleHQgaWYgYXZhaWxhYmxlXG4gICAgaWYgKGNvbnRleHQ/Lmxlc3NvblByb21wdCkge1xuICAgICAgZW5oYW5jZWRDb250ZXh0ID0ge1xuICAgICAgICAuLi5lbmhhbmNlZENvbnRleHQsXG4gICAgICAgIGxlc3NvblByb21wdDogY29udGV4dC5sZXNzb25Qcm9tcHQsXG4gICAgICAgIGxlc3NvbklkOiBjb250ZXh0Lmxlc3NvbklkLFxuICAgICAgICBjb3Vyc2VJZDogY29udGV4dC5jb3Vyc2VJZCxcbiAgICAgICAgaXNMZXNzb25Nb2RlOiBjb250ZXh0LmlzTGVzc29uTW9kZSB8fCB0cnVlXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIENhbGwgRW5oYW5jZWQgR2VtaW5pIFNlcnZpY2VcbiAgICBjb25zdCBjaGF0UmVzcG9uc2U6IENoYXRSZXNwb25zZSA9IGF3YWl0IGVuaGFuY2VkR2VtaW5pU2VydmljZS5hbmFseXplQW5kUmVzcG9uZChcbiAgICAgIG1lc3NhZ2VIaXN0b3J5LFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGVuaGFuY2VkQ29udGV4dFxuICAgICk7ICAgICAgLy8gRm9ybWF0IHJlc3BvbnNlIGZvciB0aGUgZnJvbnRlbmRcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdlbmhhbmNlZF9jaGF0JyxcbiAgICAgICAgbWVzc2FnZTogY2hhdFJlc3BvbnNlLnRleHQsXG4gICAgICAgIHRleHQ6IGNoYXRSZXNwb25zZS50ZXh0LCAvLyBGb3IgY29tcGF0aWJpbGl0eVxuICAgICAgICB2aWRlbzogY2hhdFJlc3BvbnNlLnZpZGVvLFxuICAgICAgICBzdWdnZXN0aW9uczogY2hhdFJlc3BvbnNlLnN1Z2dlc3Rpb25zLFxuICAgICAgICBhdWRpbzogY2hhdFJlc3BvbnNlLmF1ZGlvLCAvLyBBZGQgYXVkaW8gc3VwcG9ydFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIC4uLmNoYXRSZXNwb25zZS5tZXRhZGF0YSxcbiAgICAgICAgICBlbmhhbmNlZEZlYXR1cmVzOiB0cnVlLFxuICAgICAgICAgIGVtb3Rpb25hbEFkYXB0YXRpb246IHRydWUsXG4gICAgICAgICAgdmlkZW9TdXBwb3J0OiAhIWNoYXRSZXNwb25zZS52aWRlbyxcbiAgICAgICAgICBhdWRpb1N1cHBvcnQ6ICEhY2hhdFJlc3BvbnNlLmF1ZGlvPy5lbmFibGVkXG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJlbnRUb3BpYzogY29udGV4dD8uY3VycmVudFRvcGljLFxuICAgICAgICBlbW90aW9uYWxGZWVkYmFjazoge1xuICAgICAgICAgIGRldGVjdGVkRW1vdGlvbjogY2hhdFJlc3BvbnNlLm1ldGFkYXRhPy5lbW90aW9uLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IGNoYXRSZXNwb25zZS5tZXRhZGF0YT8uY29uZmlkZW5jZSxcbiAgICAgICAgICBhZGFwdGVkUmVzcG9uc2U6IHRydWVcbiAgICAgICAgfVxuICAgICAgfTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFbmhhbmNlZCBjaGF0IGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICAvLyBGYWxsYmFjayB0byByZWd1bGFyIEdlbWluaSBzZXJ2aWNlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBhd2FpdCBnZW1pbmlTZXJ2aWNlLmdlbmVyYXRlQ2hhdFJlc3BvbnNlKG1lc3NhZ2UsIGNvbnRleHQpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ2NoYXRfZmFsbGJhY2snLFxuICAgICAgICBtZXNzYWdlOiBmYWxsYmFja1Jlc3BvbnNlLm1lc3NhZ2UsXG4gICAgICAgIHRleHQ6IGZhbGxiYWNrUmVzcG9uc2UubWVzc2FnZSxcbiAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IGZhbGxiYWNrUmVzcG9uc2UuZm9sbG93VXBRdWVzdGlvbnMsXG4gICAgICAgIHJlbGF0ZWRUb3BpY3M6IGZhbGxiYWNrUmVzcG9uc2UucmVsYXRlZFRvcGljcyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBmYWxsYmFja01vZGU6IHRydWUsXG4gICAgICAgICAgZXJyb3I6ICdFbmhhbmNlZCBzZXJ2aWNlIHVuYXZhaWxhYmxlJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGZhbGxiYWNrRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWxsYmFjayBjaGF0IGFsc28gZmFpbGVkOicsIGZhbGxiYWNrRXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBGaW5hbCBmYWxsYmFjayAtIHN0YXRpYyByZXNwb25zZVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ3N0YXRpY19mYWxsYmFjaycsXG4gICAgICAgIG1lc3NhZ2U6IGBFbnRpZW5kbyB0dSBwcmVndW50YSBzb2JyZSBcIiR7bWVzc2FnZX1cIi4gQXVucXVlIGVzdG95IHRlbmllbmRvIHByb2JsZW1hcyB0w6ljbmljb3MsIHB1ZWRvIGF5dWRhcnRlIGNvbiBjb25jZXB0b3MgZGUgSUEuIMK/UG9kcsOtYXMgc2VyIG3DoXMgZXNwZWPDrWZpY28gc29icmUgcXXDqSB0ZW1hIHRlIGludGVyZXNhP2AsXG4gICAgICAgIHRleHQ6IGBFbnRpZW5kbyB0dSBwcmVndW50YSBzb2JyZSBcIiR7bWVzc2FnZX1cIi4gQXVucXVlIGVzdG95IHRlbmllbmRvIHByb2JsZW1hcyB0w6ljbmljb3MsIHB1ZWRvIGF5dWRhcnRlIGNvbiBjb25jZXB0b3MgZGUgSUEuIMK/UG9kcsOtYXMgc2VyIG3DoXMgZXNwZWPDrWZpY28gc29icmUgcXXDqSB0ZW1hIHRlIGludGVyZXNhP2AsXG4gICAgICAgIHN1Z2dlc3Rpb25zOiBbXG4gICAgICAgICAgJ8K/UXXDqSBlcyBtYWNoaW5lIGxlYXJuaW5nPycsXG4gICAgICAgICAgJ0V4cGxpY2EgbGFzIHJlZGVzIG5ldXJvbmFsZXMnLFxuICAgICAgICAgICdEYW1lIGVqZW1wbG9zIGRlIElBJyxcbiAgICAgICAgICAnQXl1ZGEgY29uIFB5dGhvbidcbiAgICAgICAgXSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBzdGF0aWNGYWxsYmFjazogdHJ1ZSxcbiAgICAgICAgICBlcnJvcjogJ0FsbCBBSSBzZXJ2aWNlcyB1bmF2YWlsYWJsZSdcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbn1cblxuLy8gTW9jayBjaGF0IHJlc3BvbnNlIGdlbmVyYXRvciBmb3IgZGVtbyBtb2RlXG5mdW5jdGlvbiBnZW5lcmF0ZU1vY2tDaGF0UmVzcG9uc2UobWVzc2FnZTogc3RyaW5nLCBhY3Rpb246IHN0cmluZywgZW1vdGlvbmFsU3RhdGU/OiBhbnkpIHtcbiAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICBcbiAgLy8gRGVmaW5lIG1vY2sgcmVzcG9uc2VzIGJhc2VkIG9uIGNvbW1vbiB0b3BpY3NcbiAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcygnbWFjaGluZSBsZWFybmluZycpIHx8IGxvd2VyTWVzc2FnZS5pbmNsdWRlcygnbWwnKSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbGVhcm5pbmdfc2Vzc2lvbicsXG4gICAgICBsZXNzb246IHtcbiAgICAgICAgdGl0bGU6ICdJbnRyb2R1Y2Npw7NuIGEgTWFjaGluZSBMZWFybmluZycsXG4gICAgICAgIGNvbnRlbnQ6IGDCoUV4Y2VsZW50ZSBwcmVndW50YSBzb2JyZSBNYWNoaW5lIExlYXJuaW5nISBcblxuTWFjaGluZSBMZWFybmluZyBlcyB1bmEgcmFtYSBkZSBsYSBpbnRlbGlnZW5jaWEgYXJ0aWZpY2lhbCBxdWUgcGVybWl0ZSBhIGxhcyBjb21wdXRhZG9yYXMgYXByZW5kZXIgeSB0b21hciBkZWNpc2lvbmVzIGJhc8OhbmRvc2UgZW4gZGF0b3MsIHNpbiBzZXIgZXhwbMOtY2l0YW1lbnRlIHByb2dyYW1hZGFzIHBhcmEgY2FkYSB0YXJlYSBlc3BlY8OtZmljYS5cblxuKipLZXkgY29uY2VwdHM6Kipcbi0gKipTdXBlcnZpc2VkIGFsZ29yaXRobXMqKjogTGVhcm4gZnJvbSBleGFtcGxlcyB3aXRoIGtub3duIGFuc3dlcnNcbi0gKipVbnN1cGVydmlzZWQgYWxnb3JpdGhtcyoqOiBGaW5kIHBhdHRlcm5zIGluIHVubGFiZWxlZCBkYXRhXG4tICoqUmVpbmZvcmNlbWVudCBsZWFybmluZyoqOiBMZWFybiB0aHJvdWdoIHRyaWFsIGFuZCBlcnJvclxuXG4qKlByYWN0aWNhbCBleGFtcGxlOioqXG5JbWFnaW5lIHlvdSB3YW50IHRvIHRlYWNoIGEgY29tcHV0ZXIgdG8gcmVjb2duaXplIGNhdHMgaW4gcGhvdG9zLiBZb3Ugc2hvdyBpdCB0aG91c2FuZHMgb2YgaW1hZ2VzIGxhYmVsZWQgYXMgXCJjYXRcIiBvciBcIm5vdCBjYXRcIiwgYW5kIHRoZSBhbGdvcml0aG0gbGVhcm5zIHRvIGlkZW50aWZ5IHRoZSBjaGFyYWN0ZXJpc3RpY3MgdGhhdCBkZWZpbmUgYSBjYXQuXG5cbldvdWxkIHlvdSBsaWtlIG1lIHRvIGRpdmUgZGVlcGVyIGludG8gc29tZSBzcGVjaWZpYyB0eXBlIG9mIGFsZ29yaXRobSBvciB3b3VsZCB5b3UgcHJlZmVyIHRvIHNlZSBhbiBleGFtcGxlIHdpdGggY29kZT9gLFxuICAgICAgICBvYmplY3RpdmVzOiBbJ1VuZGVyc3RhbmQgd2hhdCBNYWNoaW5lIExlYXJuaW5nIGlzJywgJ0lkZW50aWZ5IHRoZSBtYWluIHR5cGVzJywgJ1Zpc3VhbGl6ZSBwcmFjdGljYWwgYXBwbGljYXRpb25zJ10sXG4gICAgICAgIG5leHRTdGVwczogWydFeHBsb3JlIHNwZWNpZmljIGFsZ29yaXRobXMnLCAnUHJhY3RpY2Ugd2l0aCByZWFsIGRhdGFzZXRzJywgJ0ltcGxlbWVudCB5b3VyIGZpcnN0IG1vZGVsJ11cbiAgICAgIH0sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFsnU3RhcnQgd2l0aCBsaW5lYXIgcmVncmVzc2lvbicsICdQcmFjdGljZSB3aXRoIHNtYWxsIGRhdGFzZXRzJywgJ1VzZSBsaWJyYXJpZXMgbGlrZSBzY2lraXQtbGVhcm4nXSxcbiAgICAgIGlzRGVtb01vZGU6IHRydWVcbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcygnbmV1cmFsJykgfHwgbG93ZXJNZXNzYWdlLmluY2x1ZGVzKCduZXVyYWwgbmV0d29ya3MnKSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbGVhcm5pbmdfc2Vzc2lvbicsXG4gICAgICBsZXNzb246IHtcbiAgICAgICAgdGl0bGU6ICdOZXVyYWwgTmV0d29ya3MgRXhwbGFpbmVkJyxcbiAgICAgICAgY29udGVudDogYE5ldXJhbCBuZXR3b3JrcyBhcmUgY29tcHV0YXRpb25hbCBzeXN0ZW1zIGluc3BpcmVkIGJ5IHRoZSBmdW5jdGlvbmluZyBvZiB0aGUgaHVtYW4gYnJhaW4uXG5cbioqQmFzaWMgc3RydWN0dXJlOioqXG4tICoqQXJ0aWZpY2lhbCBuZXVyb25zKio6IFNpbXBsZSBwcm9jZXNzaW5nIHVuaXRzXG4tICoqTGF5ZXJzKio6IEdyb3VwcyBvZiBjb25uZWN0ZWQgbmV1cm9uc1xuLSAqKldlaWdodHMgYW5kIGJpYXNlcyoqOiBQYXJhbWV0ZXJzIHRoYXQgYWRqdXN0IGR1cmluZyBsZWFybmluZ1xuLSAqKkFjdGl2YXRpb24gZnVuY3Rpb24qKjogRGV0ZXJtaW5lcyB3aGVuIGEgbmV1cm9uIGlzIFwiYWN0aXZhdGVkXCJcblxuKipIb3cgZG8gdGhleSBsZWFybj8qKlxuMS4gUmVjZWl2ZSBpbnB1dCBkYXRhXG4yLiBQcm9jZXNzIGluZm9ybWF0aW9uIHRocm91Z2ggbGF5ZXJzXG4zLiBDb21wYXJlIHJlc3VsdCB3aXRoIGNvcnJlY3QgYW5zd2VyXG40LiBBZGp1c3Qgd2VpZ2h0cyB0byBpbXByb3ZlIGFjY3VyYWN5XG5cbioqUG9wdWxhciBhcHBsaWNhdGlvbnM6Kipcbi0gSW1hZ2UgcmVjb2duaXRpb25cbi0gTmF0dXJhbCBsYW5ndWFnZSBwcm9jZXNzaW5nXG4tIFJlY29tbWVuZGF0aW9uIHN5c3RlbXNcblxuV291bGQgeW91IGxpa2UgbWUgdG8gc2hvdyB5b3UgYSBzaW1wbGUgY29kZSBleGFtcGxlIG9mIGEgbmV1cmFsIG5ldHdvcms/YCxcbiAgICAgICAgb2JqZWN0aXZlczogWydVbmRlcnN0YW5kIHRoZSBzdHJ1Y3R1cmUgb2YgbmV1cmFsIG5ldHdvcmtzJywgJ0tub3cgdGhlIGxlYXJuaW5nIHByb2Nlc3MnLCAnSWRlbnRpZnkgYXBwbGljYXRpb25zJ10sXG4gICAgICAgIG5leHRTdGVwczogWydJbXBsZW1lbnQgYSBzaW1wbGUgbmV0d29yaycsICdFeHBlcmltZW50IHdpdGggZGlmZmVyZW50IGFyY2hpdGVjdHVyZXMnLCAnTGVhcm4gYWJvdXQgZGVlcCBsZWFybmluZyddXG4gICAgICB9LFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbJ1N0YXJ0IHdpdGggcGVyY2VwdHJvbnMnLCAnVXNlIFRlbnNvckZsb3cgb3IgUHlUb3JjaCcsICdQcmFjdGljZSB3aXRoIGRhdGFzZXRzIGxpa2UgTU5JU1QnXSxcbiAgICAgIGlzRGVtb01vZGU6IHRydWVcbiAgICB9O1xuICB9XG5cbiAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcygncHJvbXB0JykgfHwgbG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdwcm9tcHRpbmcnKSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnbGVhcm5pbmdfc2Vzc2lvbicsXG4gICAgICBsZXNzb246IHtcbiAgICAgICAgdGl0bGU6ICdQcm9tcHQgRW5naW5lZXJpbmcgRnVuZGFtZW50YWxzJyxcbiAgICAgICAgY29udGVudDogYFByb21wdCBFbmdpbmVlcmluZyBpcyB0aGUgYXJ0IG9mIGRlc2lnbmluZyBlZmZlY3RpdmUgaW5zdHJ1Y3Rpb25zIGZvciBnZW5lcmF0aXZlIEFJIG1vZGVscy5cblxuKipGdW5kYW1lbnRhbCBwcmluY2lwbGVzOioqXG4tICoqQ2xhcml0eSoqOiBCZSBzcGVjaWZpYyBhbmQgZGlyZWN0XG4tICoqQ29udGV4dCoqOiBQcm92aWRlIHJlbGV2YW50IGluZm9ybWF0aW9uXG4tICoqU3RydWN0dXJlKio6IE9yZ2FuaXplIHlvdXIgcHJvbXB0IGxvZ2ljYWxseVxuLSAqKkV4YW1wbGVzKio6IFVzZSBmZXctc2hvdCBsZWFybmluZyB3aGVuIGhlbHBmdWxcblxuKipBZHZhbmNlZCB0ZWNobmlxdWVzOioqXG4xLiAqKkNoYWluLW9mLVRob3VnaHQqKjogQXNrIGl0IHRvIGV4cGxhaW4gaXRzIHJlYXNvbmluZ1xuMi4gKipSb2xlIFBsYXlpbmcqKjogRGVmaW5lIGEgc3BlY2lmaWMgcm9sZSBmb3IgdGhlIEFJXG4zLiAqKlRlbXBsYXRlLWJhc2VkKio6IFVzZSByZXVzYWJsZSB0ZW1wbGF0ZXNcbjQuICoqSXRlcmF0aXZlIHJlZmluZW1lbnQqKjogSW1wcm92ZSBwcm9ncmVzc2l2ZWx5XG5cbioqUHJhY3RpY2FsIGV4YW1wbGU6KipcbuKdjCBCYWQ6IFwiV3JpdGUgY29kZVwiXG7inIUgR29vZDogXCJBcyBhIFB5dGhvbiBleHBlcnQsIHdyaXRlIGEgZnVuY3Rpb24gdGhhdCBjYWxjdWxhdGVzIHRoZSBmYWN0b3JpYWwgb2YgYSBudW1iZXIuIEluY2x1ZGUgZXhwbGFuYXRvcnkgY29tbWVudHMgYW5kIGVycm9yIGhhbmRsaW5nIGZvciBpbnZhbGlkIGlucHV0cy5cIlxuXG5Xb3VsZCB5b3UgbGlrZSB0byBwcmFjdGljZSBjcmVhdGluZyBwcm9tcHRzIGZvciBzb21lIHNwZWNpZmljIGNhc2U/YCxcbiAgICAgICAgb2JqZWN0aXZlczogWydNYXN0ZXIgcHJvbXB0IGVuZ2luZWVyaW5nIHByaW5jaXBsZXMnLCAnQXBwbHkgYWR2YW5jZWQgdGVjaG5pcXVlcycsICdPcHRpbWl6ZSBBSSBpbnRlcmFjdGlvbnMnXSxcbiAgICAgICAgbmV4dFN0ZXBzOiBbJ1ByYWN0aWNlIHdpdGggZGlmZmVyZW50IHR5cGVzIG9mIHByb21wdHMnLCAnRXhwZXJpbWVudCB3aXRoIGRpdmVyc2UgbW9kZWxzJywgJ0J1aWxkIHlvdXIgdGVtcGxhdGUgbGlicmFyeSddXG4gICAgICB9LFxuICAgICAgcmVjb21tZW5kYXRpb25zOiBbJ0V4cGVyaW1lbnQgd2l0aCBkaWZmZXJlbnQgc3R5bGVzJywgJ01lYXN1cmUgdGhlIGVmZmVjdGl2ZW5lc3Mgb2YgeW91ciBwcm9tcHRzJywgJ0tlZXAgYSByZXBvc2l0b3J5IG9mIHN1Y2Nlc3NmdWwgcHJvbXB0cyddLFxuICAgICAgaXNEZW1vTW9kZTogdHJ1ZVxuICAgIH07XG4gIH1cblxuICAvLyBEZWZhdWx0IHJlc3BvbnNlIGZvciBnZW5lcmFsIHF1ZXN0aW9uc1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdjaGF0X3Jlc3BvbnNlJyxcbiAgICBjb250ZW50OiBgSGVsbG8hIEknbSBQcm9mQUksIHlvdXIgcGVyc29uYWwgYXJ0aWZpY2lhbCBpbnRlbGxpZ2VuY2UgdHV0b3IuIFxuXG5JIG5vdGljZWQgeW91J3JlIGFza2luZyBhYm91dDogXCIke21lc3NhZ2V9XCJcblxuQXMgYW4gYWRhcHRpdmUgcHJvZmVzc29yLCBJIGNhbiBoZWxwIHlvdSB3aXRoOlxu8J+TmiAqKlRoZW9yZXRpY2FsIGNvbmNlcHRzKiogLSBDbGVhciBleHBsYW5hdGlvbnMgb2YgQUksIE1MLCBEZWVwIExlYXJuaW5nXG7wn5ug77iPICoqUHJhY3RpY2FsIHRvb2xzKiogLSBDb2RlLCBsaWJyYXJpZXMsIGltcGxlbWVudGF0aW9uc1xu8J+noCAqKlByb21wdCBFbmdpbmVlcmluZyoqIC0gT3B0aW1pemF0aW9uIG9mIEFJIGludGVyYWN0aW9uc1xu8J+OryAqKkFwcGxpZWQgcHJvamVjdHMqKiAtIFJlYWwgdXNlIGNhc2VzIGFuZCBleGVyY2lzZXNcblxuTXkgYXBwcm9hY2ggYWRhcHRzIHRvIHlvdXIgbGVhcm5pbmcgc3R5bGUgYW5kIGxldmVsLiBJIGNhbiBleHBsYWluIGZyb20gYmFzaWMgY29uY2VwdHMgdG8gYWR2YW5jZWQgdGVjaG5pcXVlcy5cblxuV2hhdCBhcmVhIHdvdWxkIHlvdSBsaWtlIHRvIGRpdmUgaW50bz8gRG8geW91IHByZWZlciB0byBzdGFydCB3aXRoIHRoZW9yeSwgc2VlIHByYWN0aWNhbCBleGFtcGxlcywgb3IgZG8geW91IGhhdmUgYSBzcGVjaWZpYyBwcm9qZWN0IGluIG1pbmQ/YCxcbiAgICBzdWdnZXN0aW9uczogW1xuICAgICAgJ1doYXQgaXMgbWFjaGluZSBsZWFybmluZyBhbmQgaG93IHRvIGdldCBzdGFydGVkPycsXG4gICAgICAnRXhwbGFpbiBuZXVyYWwgbmV0d29ya3Mgd2l0aCBleGFtcGxlcycsXG4gICAgICAnSG93IHRvIGNyZWF0ZSBiZXR0ZXIgQUkgcHJvbXB0cz8nLFxuICAgICAgJ0kgd2FudCB0byBkbyBhbiBBSSBwcm9qZWN0LCB3aGVyZSBkbyBJIHN0YXJ0PydcbiAgICBdLFxuICAgIGlzRGVtb01vZGU6IHRydWVcbiAgfTtcbn1cblxuLy8gSGFuZGxlciBmb3IgZ2VuZXJhbCBjaGF0IGludGVyYWN0aW9uc1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ2hhdEludGVyYWN0aW9uKFxuICB1c2VyOiBhbnksIFxuICBtZXNzYWdlOiBzdHJpbmcsIFxuICBjb250ZXh0OiBhbnksIFxuICBlbW90aW9uYWxTdGF0ZTogYW55XG4pIHtcbiAgLy8gRGV0ZXJtaW5lIHRoZSB0b3BpYyBhbmQgZGlmZmljdWx0eSAgXG4gIGNvbnN0IHRvcGljID0gZXh0cmFjdFRvcGljRnJvbU1lc3NhZ2UobWVzc2FnZSkgfHwgY29udGV4dD8uY3VycmVudFRvcGljIHx8ICdBSSBjb25jZXB0cyc7XG4gIGNvbnN0IGRpZmZpY3VsdHkgPSBkZXRlcm1pbmVVc2VyRGlmZmljdWx0eSh1c2VyKTtcblxuICAvLyBHZW5lcmF0ZSBwZXJzb25hbGl6ZWQgbGVzc29uIHVzaW5nIEdlbWluaVxuICBjb25zdCBsZXNzb24gPSBhd2FpdCBnZW1pbmlTZXJ2aWNlLmdlbmVyYXRlTGVzc29uKFxuICAgIHRvcGljLFxuICAgIGRpZmZpY3VsdHlcbiAgKTtcblxuICAvLyBDaGVjayBpZiB1c2VyIHdhbnRzIGV4ZXJjaXNlc1xuICBjb25zdCBpbmNsdWRlRXhlcmNpc2VzID0gc2hvdWxkSW5jbHVkZUV4ZXJjaXNlcyhtZXNzYWdlKTtcbiAgbGV0IGV4ZXJjaXNlID0gbnVsbDtcbiAgXG4gIGlmIChpbmNsdWRlRXhlcmNpc2VzKSB7XG4gICAgZXhlcmNpc2UgPSBhd2FpdCBnZW1pbmlTZXJ2aWNlLmdlbmVyYXRlRXhlcmNpc2UoXG4gICAgICB0b3BpYyxcbiAgICAgIGRpZmZpY3VsdHlcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnbGVhcm5pbmdfc2Vzc2lvbicsXG4gICAgbGVzc29uLFxuICAgIGV4ZXJjaXNlLFxuICAgIHJlY29tbWVuZGF0aW9uczogZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoZW1vdGlvbmFsU3RhdGUsIGxlc3NvbiksXG4gICAgbmV4dFN0ZXBzOiBnZW5lcmF0ZU5leHRTdGVwcyhsZXNzb24sIGV4ZXJjaXNlKVxuICB9O1xufVxuXG4vLyBIYW5kbGVyIGZvciBoZWxwIHJlcXVlc3RzXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVIZWxwUmVxdWVzdChcbiAgdXNlcjogYW55LCBcbiAgbWVzc2FnZTogc3RyaW5nLCBcbiAgY29udGV4dDogYW55LCBcbiAgZW1vdGlvbmFsU3RhdGU6IGFueVxuKSB7XG4gIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gY29udGV4dD8ubGVzc29uSWQgPyBhd2FpdCBnZXRMZXNzb25Db250ZW50KGNvbnRleHQubGVzc29uSWQpIDogbnVsbDtcbiAgXG4gIGlmIChjdXJyZW50Q29udGVudCkge1xuICAgIC8vIEZvciBub3csIHByb3ZpZGUgYSBzaW1wbGUgcmVmb3JtdWxhdGVkIHJlc3BvbnNlIHNpbmNlIHJlZm9ybXVsYXRlQ29udGVudCBkb2Vzbid0IGV4aXN0XG4gICAgY29uc3QgcmVmb3JtdWxhdGVkQ29udGVudCA9IGBFbnRpZW5kbyB0dSBjb25mdXNpw7NuIHNvYnJlIGVsIHRlbWEuIETDqWphbWUgZXhwbGljYXJsbyBkZSBvdHJhIG1hbmVyYTogJHtjdXJyZW50Q29udGVudC50b1N0cmluZygpfWA7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdoZWxwX3Jlc3BvbnNlJyxcbiAgICAgIHJlZm9ybXVsYXRlZENvbnRlbnQsXG4gICAgICBzdXBwb3J0TWVzc2FnZTogZ2VuZXJhdGVTdXBwb3J0TWVzc2FnZShlbW90aW9uYWxTdGF0ZT8ucHJpbWFyeV9lbW90aW9uIHx8ICdjb25mdXNlZCcpLFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ1dvdWxkIHlvdSBsaWtlIG1lIHRvIGJyZWFrIHRoaXMgZG93biBmdXJ0aGVyPycsXG4gICAgICAgICdTaG91bGQgSSBwcm92aWRlIG1vcmUgZXhhbXBsZXM/JyxcbiAgICAgICAgJ0RvIHlvdSB3YW50IHRvIHRyeSBhIHByYWN0aWNlIGV4ZXJjaXNlPydcbiAgICAgIF1cbiAgICB9O1xuICB9XG5cbiAgLy8gR2VuZXJhbCBoZWxwIHdpdGhvdXQgc3BlY2lmaWMgY29udGVudFxuICBjb25zdCBoZWxwUmVzcG9uc2UgPSBhd2FpdCBnZW1pbmlTZXJ2aWNlLmdlbmVyYXRlQ29udGVudChcbiAgICBgVGhlIHN0dWRlbnQgaXMgYXNraW5nIGZvciBoZWxwOiBcIiR7bWVzc2FnZX1cIi4gVGhleSBzZWVtICR7ZW1vdGlvbmFsU3RhdGU/LnByaW1hcnlfZW1vdGlvbiB8fCAnbmV1dHJhbCd9LiBQcm92aWRlIGVuY291cmFnaW5nLCBzcGVjaWZpYyBoZWxwLmAsXG4gICAgYnVpbGRTeXN0ZW1Qcm9tcHQoZW1vdGlvbmFsU3RhdGUsIHt9KVxuICApO1xuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ2dlbmVyYWxfaGVscCcsXG4gICAgY29udGVudDogaGVscFJlc3BvbnNlLFxuICAgIHN1cHBvcnRNZXNzYWdlOiBnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlKGVtb3Rpb25hbFN0YXRlPy5wcmltYXJ5X2Vtb3Rpb24gfHwgJ2NvbmZ1c2VkJylcbiAgfTtcbn1cblxuLy8gSGFuZGxlciBmb3IgZXhlcmNpc2Ugc3VibWlzc2lvbnNcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUV4ZXJjaXNlU3VibWlzc2lvbihcbiAgdXNlcjogYW55LCBcbiAgc3VibWlzc2lvbjogc3RyaW5nLCBcbiAgY29udGV4dDogYW55XG4pIHtcbiAgaWYgKCFjb250ZXh0Py5leGVyY2lzZUlkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdFeGVyY2lzZSBJRCByZXF1aXJlZCBmb3Igc3VibWlzc2lvbiBldmFsdWF0aW9uJyk7XG4gIH1cblxuICBjb25zdCBleGVyY2lzZSA9IGF3YWl0IGdldEV4ZXJjaXNlRGV0YWlscyhjb250ZXh0LmV4ZXJjaXNlSWQpO1xuICBcbiAgY29uc3QgZXZhbHVhdGlvbiA9IGF3YWl0IGdlbWluaVNlcnZpY2UuZXZhbHVhdGVTdWJtaXNzaW9uKFxuICAgIGV4ZXJjaXNlLFxuICAgIHtcbiAgICAgIGNvZGU6IHN1Ym1pc3Npb24sXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH1cbiAgKTtcblxuICAvLyBVcGRhdGUgdXNlciBwcm9ncmVzc1xuICBhd2FpdCB1cGRhdGVVc2VyUHJvZ3Jlc3ModXNlci5pZCwgY29udGV4dC5leGVyY2lzZUlkLCBldmFsdWF0aW9uKTtcblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdleGVyY2lzZV9ldmFsdWF0aW9uJyxcbiAgICBldmFsdWF0aW9uLFxuICAgIHByb2dyZXNzVXBkYXRlOiBhd2FpdCBnZXRVc2VyUHJvZ3Jlc3NVcGRhdGUodXNlci5pZCksXG4gICAgbmV4dFN0ZXBzOiBnZW5lcmF0ZVBvc3RFdmFsdWF0aW9uU3RlcHMoZXZhbHVhdGlvbilcbiAgfTtcbn1cblxuLy8gSGFuZGxlciBmb3IgcmVmb3JtdWxhdGlvbiByZXF1ZXN0c1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVmb3JtdWxhdGlvblJlcXVlc3QoXG4gIHVzZXI6IGFueSwgXG4gIGZlZWRiYWNrOiBzdHJpbmcsIFxuICBjb250ZXh0OiBhbnksIFxuICBlbW90aW9uYWxTdGF0ZTogYW55XG4pIHtcbiAgY29uc3QgY3VycmVudENvbnRlbnQgPSBjb250ZXh0Py5sZXNzb25JZCA/IGF3YWl0IGdldExlc3NvbkNvbnRlbnQoY29udGV4dC5sZXNzb25JZCkgOiBudWxsO1xuICBcbiAgaWYgKCFjdXJyZW50Q29udGVudCkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgbWVzc2FnZTogJ05vIGNvbnRlbnQgYXZhaWxhYmxlIGZvciByZWZvcm11bGF0aW9uJ1xuICAgIH07XG4gIH1cblxuICAvLyBTaW1wbGUgcmVmb3JtdWxhdGlvbiBzaW5jZSB0aGUgQVBJIG1ldGhvZCBkb2Vzbid0IGV4aXN0IHlldFxuICBjb25zdCByZWZvcm11bGF0ZWRDb250ZW50ID0gYEVudGllbmRvIHR1IGNvbmZ1c2nDs24uIETDqWphbWUgZXhwbGljYXJsbyBkZSBvdHJhIG1hbmVyYTogJHtjdXJyZW50Q29udGVudH1gO1xuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ3JlZm9ybXVsYXRpb24nLFxuICAgIG9yaWdpbmFsRW1vdGlvbjogZW1vdGlvbmFsU3RhdGU/LnByaW1hcnlfZW1vdGlvbiB8fCAnY29uZnVzZWQnLFxuICAgIG5ld0V4cGxhbmF0aW9uOiByZWZvcm11bGF0ZWRDb250ZW50LFxuICAgIGVuY291cmFnZW1lbnQ6IGdlbmVyYXRlRW5jb3VyYWdlbWVudE1lc3NhZ2UoKSxcbiAgICBzdWdnZXN0aW9uczogW1xuICAgICAgJ0lzIHRoaXMgY2xlYXJlciBub3c/JyxcbiAgICAgICdXb3VsZCB5b3UgbGlrZSBldmVuIG1vcmUgZXhhbXBsZXM/JyxcbiAgICAgICdSZWFkeSB0byB0cnkgYSBwcmFjdGljZSBleGVyY2lzZT8nXG4gICAgXVxuICB9O1xufVxuXG4vLyBVdGlsaXR5IGZ1bmN0aW9uc1xuZnVuY3Rpb24gZXh0cmFjdFRvcGljRnJvbU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGFpVG9waWNzID0gW1xuICAgICdtYWNoaW5lIGxlYXJuaW5nJywgJ2RlZXAgbGVhcm5pbmcnLCAnbmV1cmFsIG5ldHdvcmtzJywgJ3RyYW5zZm9ybWVycycsXG4gICAgJ2xsbScsICdncHQnLCAncHJvbXB0IGVuZ2luZWVyaW5nJywgJ2ZpbmUtdHVuaW5nJywgJ2VtYmVkZGluZ3MnLFxuICAgICdyYWcnLCAncmV0cmlldmFsIGF1Z21lbnRlZCBnZW5lcmF0aW9uJywgJ2xhbmdjaGFpbicsICdvcGVuYWknLCAnaHVnZ2luZyBmYWNlJ1xuICBdO1xuXG4gIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcbiAgZm9yIChjb25zdCB0b3BpYyBvZiBhaVRvcGljcykge1xuICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXModG9waWMpKSB7XG4gICAgICByZXR1cm4gdG9waWM7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gZGV0ZXJtaW5lVXNlckRpZmZpY3VsdHkodXNlcjogYW55KTogJ2JlZ2lubmVyJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJyB7XG4gIGNvbnN0IHNraWxsTGV2ZWwgPSB1c2VyLnNraWxsTGV2ZWw7XG4gIGlmICghc2tpbGxMZXZlbCkgcmV0dXJuICdiZWdpbm5lcic7XG4gIFxuICBjb25zdCBsZXZlbHMgPSBbc2tpbGxMZXZlbC50aGVvcnksIHNraWxsTGV2ZWwudG9vbGluZywgc2tpbGxMZXZlbC5wcm9tcHRpbmddLmZpbHRlcihCb29sZWFuKTtcbiAgY29uc3QgYXZnTGV2ZWwgPSBsZXZlbHMucmVkdWNlKChzdW06IG51bWJlciwgbGV2ZWw6IHN0cmluZykgPT4ge1xuICAgIGxldCBzY29yZTogbnVtYmVyO1xuICAgIGlmIChsZXZlbCA9PT0gJ2JlZ2lubmVyJykge1xuICAgICAgc2NvcmUgPSAxO1xuICAgIH0gZWxzZSBpZiAobGV2ZWwgPT09ICdpbnRlcm1lZGlhdGUnKSB7XG4gICAgICBzY29yZSA9IDI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNjb3JlID0gMztcbiAgICB9XG4gICAgcmV0dXJuIHN1bSArIHNjb3JlO1xuICB9LCAwKSAvIGxldmVscy5sZW5ndGg7XG4gIFxuICBpZiAoYXZnTGV2ZWwgPD0gMS41KSByZXR1cm4gJ2JlZ2lubmVyJztcbiAgaWYgKGF2Z0xldmVsIDw9IDIuNSkgcmV0dXJuICdpbnRlcm1lZGlhdGUnO1xuICByZXR1cm4gJ2FkdmFuY2VkJztcbn1cblxuZnVuY3Rpb24gZGV0ZXJtaW5lTGVhcm5pbmdTdHlsZSh1c2VyOiBhbnkpOiAndGhlb3J5JyB8ICd0b29saW5nJyB8ICdoeWJyaWQnIHtcbiAgY29uc3QgcHJlZmVyZW5jZXMgPSB1c2VyLnByZWZlcmVuY2VzO1xuICByZXR1cm4gcHJlZmVyZW5jZXM/LnByZWZlcnJlZF9mb3JtYXQgfHwgJ2h5YnJpZCc7XG59XG5cbmZ1bmN0aW9uIGdldFVzZXJCYWNrZ3JvdW5kKHVzZXI6IGFueSk6IHN0cmluZyB7XG4gIGNvbnN0IHNraWxsTGV2ZWwgPSB1c2VyLnNraWxsTGV2ZWw7XG4gIGlmICghc2tpbGxMZXZlbCkgcmV0dXJuIFwiR2VuZXJhbCBhdWRpZW5jZSB3aXRoIG1peGVkIGJhY2tncm91bmRcIjtcblxuICBjb25zdCBsZXZlbHMgPSBbXTtcbiAgaWYgKHNraWxsTGV2ZWwudGhlb3J5KSBsZXZlbHMucHVzaChgVGhlb3J5OiAke3NraWxsTGV2ZWwudGhlb3J5fWApO1xuICBpZiAoc2tpbGxMZXZlbC50b29saW5nKSBsZXZlbHMucHVzaChgVG9vbGluZzogJHtza2lsbExldmVsLnRvb2xpbmd9YCk7XG4gIGlmIChza2lsbExldmVsLnByb21wdGluZykgbGV2ZWxzLnB1c2goYFByb21wdGluZzogJHtza2lsbExldmVsLnByb21wdGluZ31gKTtcblxuICByZXR1cm4gbGV2ZWxzLmpvaW4oJywgJyk7XG59XG5cbmZ1bmN0aW9uIHNob3VsZEluY2x1ZGVFeGVyY2lzZXMobWVzc2FnZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IHByYWN0aWNlS2V5d29yZHMgPSBbJ3ByYWN0aWNlJywgJ2V4ZXJjaXNlJywgJ2NvZGUnLCAnZXhhbXBsZScsICd0cnknLCAnYnVpbGQnLCAnaW1wbGVtZW50J107XG4gIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIHByYWN0aWNlS2V5d29yZHMuc29tZShrZXl3b3JkID0+IGxvd2VyTWVzc2FnZS5pbmNsdWRlcyhrZXl3b3JkKSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkU3lzdGVtUHJvbXB0KGVtb3Rpb25hbFN0YXRlOiBhbnksIGNvbnRleHQ6IGFueSkge1xuICBjb25zdCB1c2VyTmFtZSA9IGNvbnRleHQ/LnVzZXJOYW1lIHx8ICdzdHVkZW50JztcbiAgY29uc3QgZW1vdGlvbiA9IGVtb3Rpb25hbFN0YXRlPy5wcmltYXJ5X2Vtb3Rpb24gfHwgJ25ldXRyYWwnO1xuICBjb25zdCBpc0NvbmZ1c2VkID0gZW1vdGlvbmFsU3RhdGU/LmRldGVjdGVkX2NvbmZ1c2lvbiB8fCBmYWxzZTtcbiAgXG4gIGxldCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgUHJvZkFJLCBhbiBleHBlcnQgcHJvZmVzc29yIGluIGFydGlmaWNpYWwgaW50ZWxsaWdlbmNlIHdpdGggYWR2YW5jZWQgZW1vdGlvbmFsIGludGVsbGlnZW5jZS4gXG5cbllvdXIgcGVyc29uYWxpdHkgaXM6XG4tIEVtcGF0aGV0aWMgYW5kIGFkYXB0aXZlXG4tIENsZWFyIGluIGV4cGxhbmF0aW9ucyBidXQgYWNhZGVtaWNhbGx5IHJpZ29yb3VzICBcbi0gWW91IGRldGVjdCBlbW90aW9ucyBhbmQgYWRqdXN0IHlvdXIgdGVhY2hpbmcgc3R5bGVcbi0gWW91IGNvbWJpbmUgc29saWQgdGhlb3J5IHdpdGggcHJhY3RpY2FsIGV4YW1wbGVzXG4tIFlvdSB1c2UgYW5hbG9naWVzIHdoZW4gbmVjZXNzYXJ5IHRvIHNpbXBsaWZ5XG5cblRoZSBzdHVkZW50IGlzIGNhbGxlZCAke3VzZXJOYW1lfS5gO1xuXG4gIC8vIEFkYXB0YXRpb24gYmFzZWQgb24gZW1vdGlvbmFsIHN0YXRlXG4gIGlmIChpc0NvbmZ1c2VkIHx8IGVtb3Rpb24gPT09ICdjb25mdXNpb24nKSB7XG4gICAgYmFzZVByb21wdCArPSBgXFxuXFxu8J+noCBFTU9USU9OQUwgU1RBVEUgREVURUNURUQ6IENPTkZVU0lPTlxuLSBVc2Ugc2ltcGxlciBzdGVwLWJ5LXN0ZXAgZXhwbGFuYXRpb25zXG4tIEluY2x1ZGUgcmVhbC13b3JsZCBhbmFsb2dpZXNcbi0gQXNrIGlmIHRoZXkgbmVlZCBtb3JlIGNsYXJpZmljYXRpb25cbi0gQnJlYWsgY29tcGxleCBjb25jZXB0cyBpbnRvIHNtYWxsIHBhcnRzXG4tIEJlIGVzcGVjaWFsbHkgcGF0aWVudCBhbmQgZW5jb3VyYWdpbmdgO1xuICB9IGVsc2UgaWYgKGVtb3Rpb24gPT09ICdmcnVzdHJhdGlvbicpIHtcbiAgICBiYXNlUHJvbXB0ICs9IGBcXG5cXG7wn5ikIEVNT1RJT05BTCBTVEFURSBERVRFQ1RFRDogRlJVU1RSQVRJT04gIFxuLSBCZSBleHRyYSB1bmRlcnN0YW5kaW5nIGFuZCBlbmNvdXJhZ2luZ1xuLSBPZmZlciBhIGRpZmZlcmVudCBhcHByb2FjaCB0byB0aGUgcHJvYmxlbVxuLSBTdWdnZXN0IHRha2luZyBhIGJyZWFrIGlmIG5lY2Vzc2FyeVxuLSBTaW1wbGlmeSB0aGUgZXhwbGFuYXRpb25cbi0gSGlnaGxpZ2h0IHRoYXQgZnJ1c3RyYXRpb24gaXMgbm9ybWFsIGluIGxlYXJuaW5nYDtcbiAgfSBlbHNlIGlmIChlbW90aW9uID09PSAnY3VyaW9zaXR5Jykge1xuICAgIGJhc2VQcm9tcHQgKz0gYFxcblxcbvCfpJQgRU1PVElPTkFMIFNUQVRFIERFVEVDVEVEOiBDVVJJT1NJVFlcbi0gQ2FuIGdvIGRlZXBlciBpbnRvIGRldGFpbHNcbi0gQWRkIGV4dHJhIGludGVyZXN0aW5nIGluZm9ybWF0aW9uXG4tIFN1Z2dlc3QgYWRkaXRpb25hbCByZXNvdXJjZXNcbi0gQ29ubmVjdCB3aXRoIHJlbGF0ZWQgdG9waWNzXG4tIEVuY291cmFnZSBleHBsb3JhdGlvbmA7XG4gIH1cblxuICBiYXNlUHJvbXB0ICs9IGBcXG5cXG5BTFdBWVMgUkVTUE9ORCBJTiBFTkdMSVNIIGluIGEgY2xlYXIsIHN0cnVjdHVyZWQgYW5kIGVkdWNhdGlvbmFsIHdheS4gVXNlIGVtb2ppcyBvY2Nhc2lvbmFsbHkgdG8gbWFrZSB0aGUgY29udmVyc2F0aW9uIG1vcmUgZnJpZW5kbHkuYDtcblxuICByZXR1cm4gYmFzZVByb21wdDtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoZW1vdGlvbmFsU3RhdGU6IGFueSwgbGVzc29uOiBhbnkpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IFtdO1xuICBcbiAgaWYgKGVtb3Rpb25hbFN0YXRlPy5wcmltYXJ5X2Vtb3Rpb24gPT09ICdjb25mdXNlZCcpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVGFrZSB5b3VyIHRpbWUgd2l0aCB0aGlzIGNvbmNlcHQnKTtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmV2aWV3IHRoZSBleGFtcGxlcyBjYXJlZnVsbHknKTtcbiAgfSBlbHNlIGlmIChlbW90aW9uYWxTdGF0ZT8ucHJpbWFyeV9lbW90aW9uID09PSAnZW5nYWdlZCcpIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnR3JlYXQgZW50aHVzaWFzbSEgS2VlcCBnb2luZycpO1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdSZWFkeSBmb3IgbW9yZSBhZHZhbmNlZCB0b3BpY3MnKTtcbiAgfVxuXG4gIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlTmV4dFN0ZXBzKGxlc3NvbjogYW55LCBleGVyY2lzZTogYW55KTogc3RyaW5nW10ge1xuICBjb25zdCBzdGVwcyA9IFtdO1xuICBcbiAgaWYgKGxlc3Nvbikge1xuICAgIHN0ZXBzLnB1c2goJ1JldmlldyB0aGUgbGVzc29uIGNvbmNlcHRzJyk7XG4gIH1cbiAgXG4gIGlmIChleGVyY2lzZSkge1xuICAgIHN0ZXBzLnB1c2goJ1RyeSB0aGUgcHJhY3RpY2UgZXhlcmNpc2UnKTtcbiAgfSBlbHNlIHtcbiAgICBzdGVwcy5wdXNoKCdBc2sgZm9yIGEgcHJhY3RpY2UgZXhlcmNpc2Ugd2hlbiByZWFkeScpO1xuICB9XG4gIFxuICBzdGVwcy5wdXNoKCdMZXQgbWUga25vdyBpZiB5b3UgbmVlZCBjbGFyaWZpY2F0aW9uJyk7XG4gIFxuICByZXR1cm4gc3RlcHM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3VwcG9ydE1lc3NhZ2UoZW1vdGlvbjogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3Qgc3VwcG9ydE1lc3NhZ2VzID0ge1xuICAgIGZydXN0cmF0ZWQ6IFwiSSB1bmRlcnN0YW5kIHRoaXMgY2FuIGJlIGNoYWxsZW5naW5nLiBMZXQncyBicmVhayBpdCBkb3duIHN0ZXAgYnkgc3RlcC5cIixcbiAgICBjb25mdXNlZDogXCJObyB3b3JyaWVzISBMZXQgbWUgdHJ5IGEgZGlmZmVyZW50IGFwcHJvYWNoIHRvIGV4cGxhaW4gdGhpcy5cIixcbiAgICBib3JlZDogXCJSZWFkeSBmb3Igc29tZXRoaW5nIG1vcmUgY2hhbGxlbmdpbmc/IExldCdzIGtpY2sgaXQgdXAgYSBub3RjaCFcIixcbiAgICBuZXV0cmFsOiBcIllvdSdyZSBkb2luZyBncmVhdCEgS2VlcCB1cCB0aGUgZ29vZCB3b3JrLlwiLFxuICAgIGVuZ2FnZWQ6IFwiSSBsb3ZlIHlvdXIgZW50aHVzaWFzbSEgTGV0J3Mga2VlcCBidWlsZGluZyBvbiB0aGF0IG1vbWVudHVtLlwiXG4gIH07XG5cbiAgcmV0dXJuIHN1cHBvcnRNZXNzYWdlc1tlbW90aW9uIGFzIGtleW9mIHR5cGVvZiBzdXBwb3J0TWVzc2FnZXNdIHx8IHN1cHBvcnRNZXNzYWdlcy5uZXV0cmFsO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUVuY291cmFnZW1lbnRNZXNzYWdlKCk6IHN0cmluZyB7XG4gIGNvbnN0IG1lc3NhZ2VzID0gW1xuICAgIFwiTGVhcm5pbmcgaXMgYSBqb3VybmV5LCBhbmQgZXZlcnkgcXVlc3Rpb24gaGVscHMgeW91IGdyb3chXCIsXG4gICAgXCJHcmVhdCBqb2IgYXNraW5nIGZvciBjbGFyaWZpY2F0aW9uIC0gdGhhdCdzIGhvdyBleHBlcnRzIHRoaW5rIVwiLFxuICAgIFwiWW91ciBjdXJpb3NpdHkgaXMgZXhhY3RseSB3aGF0IG1ha2VzIGEgZ3JlYXQgQUkgcHJhY3RpdGlvbmVyIVwiXG4gIF07XG4gIFxuICByZXR1cm4gbWVzc2FnZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWVzc2FnZXMubGVuZ3RoKV07XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUG9zdEV2YWx1YXRpb25TdGVwcyhldmFsdWF0aW9uOiBhbnkpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IHN0ZXBzID0gW107XG4gIFxuICBpZiAoZXZhbHVhdGlvbi5zY29yZSA+PSA4MCkge1xuICAgIHN0ZXBzLnB1c2goJ0V4Y2VsbGVudCB3b3JrISBSZWFkeSBmb3IgdGhlIG5leHQgY2hhbGxlbmdlJyk7XG4gIH0gZWxzZSBpZiAoZXZhbHVhdGlvbi5zY29yZSA+PSA2MCkge1xuICAgIHN0ZXBzLnB1c2goJ0dvb2QgcHJvZ3Jlc3MhIFJldmlldyBmZWVkYmFjayBhbmQgdHJ5IGFnYWluJyk7XG4gIH0gZWxzZSB7XG4gICAgc3RlcHMucHVzaCgnUmV2aWV3IHRoZSBjb25jZXB0cyBhbmQgdHJ5IGFnYWluJyk7XG4gICAgc3RlcHMucHVzaCgnQXNrIGZvciBoZWxwIGlmIHlvdSBuZWVkIGNsYXJpZmljYXRpb24nKTtcbiAgfVxuXG4gIHJldHVybiBzdGVwcztcbn1cblxuLy8gRGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucyAtIHRlbXBvcmFyeSBpbXBsZW1lbnRhdGlvbnNcbmFzeW5jIGZ1bmN0aW9uIGdldExlc3NvbkNvbnRlbnQobGVzc29uSWQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBgQ29udGVuaWRvIGRlIGxhIGxlY2Npw7NuICR7bGVzc29uSWR9OiBFc3RlIGVzIGNvbnRlbmlkbyBkZSBlamVtcGxvIG1pZW50cmFzIHNlIGltcGxlbWVudGEgbGEgYmFzZSBkZSBkYXRvcyBjb21wbGV0YS5gO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRFeGVyY2lzZURldGFpbHMoZXhlcmNpc2VJZDogc3RyaW5nKSB7XG4gIC8vIFRlbXBvcmFyeSBtb2NrIGRhdGEgd2hpbGUgZGF0YWJhc2UgdGFibGVzIGFyZSBiZWluZyBpbXBsZW1lbnRlZFxuICByZXR1cm4ge1xuICAgIHRpdGxlOiBgRWplcmNpY2lvICR7ZXhlcmNpc2VJZH1gLFxuICAgIGRlc2NyaXB0aW9uOiAnRWplcmNpY2lvIGRlIGVqZW1wbG8gbWllbnRyYXMgc2UgaW1wbGVtZW50YSBsYSBiYXNlIGRlIGRhdG9zJyxcbiAgICBpbnN0cnVjdGlvbnM6IFsnQ29tcGxldGEgZWwgZWplcmNpY2lvJywgJ1NpZ3VlIGxhcyBtZWpvcmVzIHByw6FjdGljYXMnXSxcbiAgICBldmFsdWF0aW9uQ3JpdGVyaWE6IFsnQ29ycmVjdGl0dWQnLCAnRXN0aWxvIGRlIGPDs2RpZ28nLCAnRWZpY2llbmNpYSddXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVVzZXJQcm9ncmVzcyh1c2VySWQ6IHN0cmluZywgZXhlcmNpc2VJZDogc3RyaW5nLCBldmFsdWF0aW9uOiBhbnkpIHtcbiAgY29uc29sZS5sb2coYFByb2dyZXNzIHVwZGF0ZWQgZm9yIHVzZXIgJHt1c2VySWR9IG9uIGV4ZXJjaXNlICR7ZXhlcmNpc2VJZH1gKTtcblxuICAvLyBVcGRhdGUgdXNlciBzdGF0cyAodGhpcyB0YWJsZSBleGlzdHMpXG4gIGlmIChldmFsdWF0aW9uLnNjb3JlICYmIGV2YWx1YXRpb24uc2NvcmUgPj0gNzApIHtcbiAgICBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICB0b3RhbExlc3NvbnNDb21wbGV0ZWQ6IHsgaW5jcmVtZW50OiAxIH0sXG4gICAgICAgIGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFVzZXJQcm9ncmVzc1VwZGF0ZSh1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgIHNlbGVjdDoge1xuICAgICAgdG90YWxMZXNzb25zQ29tcGxldGVkOiB0cnVlLFxuICAgICAgY3VycmVudFN0cmVhazogdHJ1ZSxcbiAgICAgIGxhc3RBY3RpdmVBdDogdHJ1ZVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHVzZXI7XG59XG5cbi8vIEhhbmRsZXIgZm9yIGV4ZXJjaXNlIGV2YWx1YXRpb24gIFxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlRXhlcmNpc2VFdmFsdWF0aW9uKFxuICB1c2VyOiBhbnksIFxuICBtZXNzYWdlOiBzdHJpbmcsIFxuICBjb250ZXh0OiBhbnksIFxuICBlbW90aW9uYWxTdGF0ZTogYW55XG4pIHtcbiAgaWYgKCFjb250ZXh0Py5leGVyY2lzZUlkKSB7XG4gICAgLy8gSWYgbm8gc3BlY2lmaWMgZXhlcmNpc2UsIHRyZWF0IGFzIGdlbmVyYWwgY29kZSBldmFsdWF0aW9uXG4gIGNvbnN0IGV2YWx1YXRpb24gPSBhd2FpdCBnZW1pbmlTZXJ2aWNlLmdlbmVyYXRlQ29udGVudChcbiAgICBgRXZhbHVhdGUgdGhpcyBzdHVkZW50J3Mgd29yazogXCIke21lc3NhZ2V9XCIuIFByb3ZpZGUgY29uc3RydWN0aXZlIGZlZWRiYWNrLmAsXG4gICAgYnVpbGRTeXN0ZW1Qcm9tcHQoZW1vdGlvbmFsU3RhdGUsIGNvbnRleHQpXG4gICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2NvZGVfZXZhbHVhdGlvbicsXG4gICAgICBmZWVkYmFjazogZXZhbHVhdGlvbixcbiAgICAgIHNjb3JlOiBudWxsLFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgJ8K/UXVpZXJlcyBpbnRlbnRhciBvdHJvIGVqZXJjaWNpbz8nLFxuICAgICAgICAnwr9OZWNlc2l0YXMgbcOhcyBleHBsaWNhY2nDs24gc29icmUgYWxnw7puIGNvbmNlcHRvPycsXG4gICAgICAgICfCv1RlIGd1c3RhcsOtYSB2ZXIgdW4gZWplbXBsbyBtZWpvcmFkbz8nXG4gICAgICBdXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBoYW5kbGVFeGVyY2lzZVN1Ym1pc3Npb24odXNlciwgbWVzc2FnZSwgY29udGV4dCk7XG59XG5cbiAgICAvLyBTYXZlIGFzc2lzdGFudCByZXNwb25zZVxuICAgIGF3YWl0IHByaXNtYS5tZXNzYWdlLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBjb252ZXJzYXRpb24uaWQsXG4gICAgICAgIGNvbnRlbnQ6IHR5cGVvZiByZXNwb25zZSA9PT0gJ3N0cmluZycgPyByZXNwb25zZSA6IEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSxcbiAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCdcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGNvbnZlcnNhdGlvbi5pZCxcbiAgICAgIGRhdGE6IHJlc3BvbnNlLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGFjdGlvbixcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDaGF0IEFQSSBFcnJvcjonLCBlcnJvcik7XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAge1xuICAgICAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICBmYWxsYmFja1Jlc3BvbnNlOiB7XG4gICAgICAgICAgdHlwZTogJ2Vycm9yX2ZhbGxiYWNrJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRGlzY3VscGEsIGVzdG95IHRlbmllbmRvIHByb2JsZW1hcyB0w6ljbmljb3MuIMK/UHVlZGVzIGludGVudGFyIHJlZm9ybXVsYXIgdHUgcHJlZ3VudGE/JyxcbiAgICAgICAgICBzdWdnZXN0aW9uczogW1xuICAgICAgICAgICAgJ8K/UXXDqSBlcyBtYWNoaW5lIGxlYXJuaW5nPycsXG4gICAgICAgICAgICAnRXhwbMOtY2FtZSBsYXMgcmVkZXMgbmV1cm9uYWxlcycsXG4gICAgICAgICAgICAnQXnDumRhbWUgY29uIHByb21wdCBlbmdpbmVlcmluZycsXG4gICAgICAgICAgICAnUXVpZXJvIGFwcmVuZGVyIHNvYnJlIElBJ1xuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZW1pbmlTZXJ2aWNlIiwiZW5oYW5jZWRHZW1pbmlTZXJ2aWNlIiwiTWVzc2FnZVNlbmRlciIsInByaXNtYSIsImlzRGVtb1VzZXIiLCJkeW5hbWljIiwiUE9TVCIsInJlcXVlc3QiLCJzZXNzaW9uIiwidXNlciIsImlkIiwiZW1haWwiLCJuYW1lIiwiYm9keSIsImpzb24iLCJtZXNzYWdlIiwiY29udGV4dCIsImFjdGlvbiIsImNvbnZlcnNhdGlvbklkIiwiZW1vdGlvbmFsU3RhdGUiLCJ0cmltIiwibGVuZ3RoIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZUhpc3RvcnkiLCJwcmV2aW91c01lc3NhZ2VzIiwibWFwIiwibXNnIiwiaW5kZXgiLCJ0ZXh0IiwiY29udGVudCIsInNlbmRlciIsInJvbGUiLCJVU0VSIiwiQUkiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibWV0YWRhdGEiLCJjaGF0UmVzcG9uc2UiLCJhbmFseXplQW5kUmVzcG9uZCIsImN1cnJlbnRUb3BpYyIsInVzZXJQcm9maWxlIiwibGVhcm5pbmdMZXZlbCIsInByaW1hcnlfZW1vdGlvbiIsInVzZXJOYW1lIiwic3VjY2VzcyIsIm5vdyIsImRhdGEiLCJ0eXBlIiwidmlkZW8iLCJzdWdnZXN0aW9ucyIsImF1ZGlvIiwiZW5oYW5jZWRGZWF0dXJlcyIsImVtb3Rpb25hbEFkYXB0YXRpb24iLCJ2aWRlb1N1cHBvcnQiLCJhdWRpb1N1cHBvcnQiLCJlbmFibGVkIiwiaXNEZW1vTW9kZSIsInVzZXJJZCIsImVuaGFuY2VkQUkiLCJ0b0lTT1N0cmluZyIsIm1vY2tSZXNwb25zZSIsImdlbmVyYXRlTW9ja0NoYXRSZXNwb25zZSIsImZhbGxiYWNrIiwiUHJvbWlzZSIsInJhY2UiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsIkVycm9yIiwiZGJFcnJvciIsIndhcm5pbmciLCJjb252ZXJzYXRpb24iLCJmaW5kRmlyc3QiLCJjcmVhdGUiLCJ0aXRsZSIsInN1YnN0cmluZyIsImVtb3Rpb25hbF9zdGF0ZSIsImFkYXB0YXRpb25fY291bnQiLCJ0b3BpYyIsInJlc3BvbnNlIiwiaGFuZGxlRW5oYW5jZWRDaGF0SW50ZXJhY3Rpb24iLCJoYW5kbGVDaGF0SW50ZXJhY3Rpb24iLCJoYW5kbGVIZWxwUmVxdWVzdCIsImhhbmRsZUV4ZXJjaXNlRXZhbHVhdGlvbiIsImVuaGFuY2VkQ29udGV4dCIsImZpcnN0TmFtZSIsImxlc3NvblByb21wdCIsImxlc3NvbklkIiwiY291cnNlSWQiLCJpc0xlc3Nvbk1vZGUiLCJlbW90aW9uYWxGZWVkYmFjayIsImRldGVjdGVkRW1vdGlvbiIsImVtb3Rpb24iLCJjb25maWRlbmNlIiwiYWRhcHRlZFJlc3BvbnNlIiwiZmFsbGJhY2tSZXNwb25zZSIsImdlbmVyYXRlQ2hhdFJlc3BvbnNlIiwiZm9sbG93VXBRdWVzdGlvbnMiLCJyZWxhdGVkVG9waWNzIiwiZmFsbGJhY2tNb2RlIiwiZmFsbGJhY2tFcnJvciIsInN0YXRpY0ZhbGxiYWNrIiwibG93ZXJNZXNzYWdlIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImxlc3NvbiIsIm9iamVjdGl2ZXMiLCJuZXh0U3RlcHMiLCJyZWNvbW1lbmRhdGlvbnMiLCJleHRyYWN0VG9waWNGcm9tTWVzc2FnZSIsImRpZmZpY3VsdHkiLCJkZXRlcm1pbmVVc2VyRGlmZmljdWx0eSIsImdlbmVyYXRlTGVzc29uIiwiaW5jbHVkZUV4ZXJjaXNlcyIsInNob3VsZEluY2x1ZGVFeGVyY2lzZXMiLCJleGVyY2lzZSIsImdlbmVyYXRlRXhlcmNpc2UiLCJnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyIsImdlbmVyYXRlTmV4dFN0ZXBzIiwiY3VycmVudENvbnRlbnQiLCJnZXRMZXNzb25Db250ZW50IiwicmVmb3JtdWxhdGVkQ29udGVudCIsInRvU3RyaW5nIiwic3VwcG9ydE1lc3NhZ2UiLCJnZW5lcmF0ZVN1cHBvcnRNZXNzYWdlIiwiaGVscFJlc3BvbnNlIiwiZ2VuZXJhdGVDb250ZW50IiwiYnVpbGRTeXN0ZW1Qcm9tcHQiLCJoYW5kbGVFeGVyY2lzZVN1Ym1pc3Npb24iLCJzdWJtaXNzaW9uIiwiZXhlcmNpc2VJZCIsImdldEV4ZXJjaXNlRGV0YWlscyIsImV2YWx1YXRpb24iLCJldmFsdWF0ZVN1Ym1pc3Npb24iLCJjb2RlIiwidXBkYXRlVXNlclByb2dyZXNzIiwicHJvZ3Jlc3NVcGRhdGUiLCJnZXRVc2VyUHJvZ3Jlc3NVcGRhdGUiLCJnZW5lcmF0ZVBvc3RFdmFsdWF0aW9uU3RlcHMiLCJoYW5kbGVSZWZvcm11bGF0aW9uUmVxdWVzdCIsImZlZWRiYWNrIiwib3JpZ2luYWxFbW90aW9uIiwibmV3RXhwbGFuYXRpb24iLCJlbmNvdXJhZ2VtZW50IiwiZ2VuZXJhdGVFbmNvdXJhZ2VtZW50TWVzc2FnZSIsImFpVG9waWNzIiwic2tpbGxMZXZlbCIsImxldmVscyIsInRoZW9yeSIsInRvb2xpbmciLCJwcm9tcHRpbmciLCJmaWx0ZXIiLCJCb29sZWFuIiwiYXZnTGV2ZWwiLCJyZWR1Y2UiLCJzdW0iLCJsZXZlbCIsInNjb3JlIiwiZGV0ZXJtaW5lTGVhcm5pbmdTdHlsZSIsInByZWZlcmVuY2VzIiwicHJlZmVycmVkX2Zvcm1hdCIsImdldFVzZXJCYWNrZ3JvdW5kIiwicHVzaCIsImpvaW4iLCJwcmFjdGljZUtleXdvcmRzIiwic29tZSIsImtleXdvcmQiLCJpc0NvbmZ1c2VkIiwiZGV0ZWN0ZWRfY29uZnVzaW9uIiwiYmFzZVByb21wdCIsInN0ZXBzIiwic3VwcG9ydE1lc3NhZ2VzIiwiZnJ1c3RyYXRlZCIsImNvbmZ1c2VkIiwiYm9yZWQiLCJuZXV0cmFsIiwiZW5nYWdlZCIsIm1lc3NhZ2VzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZGVzY3JpcHRpb24iLCJpbnN0cnVjdGlvbnMiLCJldmFsdWF0aW9uQ3JpdGVyaWEiLCJ1cGRhdGUiLCJ0b3RhbExlc3NvbnNDb21wbGV0ZWQiLCJpbmNyZW1lbnQiLCJsYXN0QWN0aXZlQXQiLCJzZWxlY3QiLCJjdXJyZW50U3RyZWFrIiwiSlNPTiIsInN0cmluZ2lmeSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/audio-service.ts":
/*!******************************!*\
  !*** ./lib/audio-service.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AudioService: () => (/* binding */ AudioService),\n/* harmony export */   audioService: () => (/* binding */ audioService)\n/* harmony export */ });\n/**\n * Audio Service for ProfAI\n * Handles text-to-speech functionality using Web Speech API and optional external services\n */ class AudioService {\n    constructor(){\n        this.synthesis = null;\n        this.voices = [];\n        this.currentUtterance = null;\n        this.isInitialized = false;\n        if (false) {}\n    }\n    async initializeVoices() {\n        if (!this.synthesis) return;\n        // Load available voices\n        const loadVoices = ()=>{\n            this.voices = this.synthesis.getVoices();\n            this.isInitialized = true;\n        };\n        if (this.synthesis.getVoices().length > 0) {\n            loadVoices();\n        } else {\n            this.synthesis.onvoiceschanged = loadVoices;\n        }\n    }\n    /**\n   * Get available voices for the specified language\n   */ getAvailableVoices(language = \"en-US\") {\n        return this.voices.filter((voice)=>voice.lang.startsWith(language.substring(0, 2)));\n    }\n    /**\n   * Get the best voice for English (ProfAI's default language)\n   */ getBestEnglishVoice() {\n        // Prefer specific English voices\n        const englishVoices = this.getAvailableVoices(\"en\");\n        // Priority order for English voices\n        const preferredNames = [\n            \"Google US English\",\n            \"Microsoft Zira - English (United States)\",\n            \"Microsoft David - English (United States)\",\n            \"Alex\",\n            \"Samantha\",\n            \"Victoria\"\n        ];\n        for (const preferred of preferredNames){\n            const voice = englishVoices.find((v)=>v.name.includes(preferred));\n            if (voice) return voice;\n        }\n        // Fallback to any English voice\n        return englishVoices[0] || null;\n    }\n    /**\n   * Convert text to speech using Web Speech API\n   */ async speakText(text, options = {}) {\n        if (!this.synthesis) {\n            return {\n                success: false,\n                error: \"Speech synthesis not supported\"\n            };\n        }\n        // Clean text for better speech\n        const cleanText = this.cleanTextForSpeech(text);\n        return new Promise((resolve)=>{\n            try {\n                // Stop any current speech\n                this.stopSpeaking();\n                const utterance = new SpeechSynthesisUtterance(cleanText);\n                // Set voice options\n                const voice = options.voiceName ? this.voices.find((v)=>v.name === options.voiceName) : this.getBestEnglishVoice();\n                if (voice) utterance.voice = voice;\n                utterance.rate = options.rate || 0.9; // Slightly slower for education\n                utterance.pitch = options.pitch || 1.0;\n                utterance.volume = options.volume || 0.8;\n                utterance.lang = options.language || \"en-US\";\n                // Event handlers\n                utterance.onstart = ()=>{\n                    this.currentUtterance = utterance;\n                };\n                utterance.onend = ()=>{\n                    this.currentUtterance = null;\n                    resolve({\n                        success: true,\n                        duration: this.estimateDuration(cleanText)\n                    });\n                };\n                utterance.onerror = (event)=>{\n                    this.currentUtterance = null;\n                    resolve({\n                        success: false,\n                        error: `Speech error: ${event.error}`\n                    });\n                };\n                // Start speaking\n                this.synthesis.speak(utterance);\n            } catch (error) {\n                resolve({\n                    success: false,\n                    error: error instanceof Error ? error.message : \"Unknown error\"\n                });\n            }\n        });\n    }\n    /**\n   * Stop current speech\n   */ stopSpeaking() {\n        if (this.synthesis) {\n            this.synthesis.cancel();\n            this.currentUtterance = null;\n        }\n    }\n    /**\n   * Check if currently speaking\n   */ isSpeaking() {\n        return this.synthesis ? this.synthesis.speaking : false;\n    }\n    /**\n   * Pause current speech\n   */ pauseSpeaking() {\n        if (this.synthesis && this.synthesis.speaking) {\n            this.synthesis.pause();\n        }\n    }\n    /**\n   * Resume paused speech\n   */ resumeSpeaking() {\n        if (this.synthesis && this.synthesis.paused) {\n            this.synthesis.resume();\n        }\n    }\n    /**\n   * Clean text for better speech synthesis\n   */ cleanTextForSpeech(text) {\n        return text// Remove markdown formatting\n        .replace(/\\*\\*(.*?)\\*\\*/g, \"$1\") // Bold\n        .replace(/\\*(.*?)\\*/g, \"$1\") // Italic\n        .replace(/`(.*?)`/g, \"$1\") // Code\n        .replace(/#{1,6}\\s*(.*)/g, \"$1\") // Headers\n        .replace(/\\[(.*?)\\]\\(.*?\\)/g, \"$1\") // Links\n        // Remove emojis (basic)\n        .replace(/[\\u{1F600}-\\u{1F64F}]|[\\u{1F300}-\\u{1F5FF}]|[\\u{1F680}-\\u{1F6FF}]|[\\u{1F1E0}-\\u{1F1FF}]|[\\u{2600}-\\u{26FF}]|[\\u{2700}-\\u{27BF}]/gu, \"\")// Clean up extra spaces and breaks\n        .replace(/\\n\\s*\\n/g, \". \").replace(/\\n/g, \" \").replace(/\\s+/g, \" \").trim();\n    }\n    /**\n   * Estimate speech duration in seconds\n   */ estimateDuration(text) {\n        // Average speaking rate: ~150 words per minute for educational content\n        const wordsPerMinute = 130; // Slower for AI education\n        const wordCount = text.split(/\\s+/).length;\n        return Math.ceil(wordCount / wordsPerMinute * 60);\n    }\n    /**\n   * Generate audio using external TTS service (fallback/enhancement)\n   */ async generateAudioWithExternalService(text, voice = \"es-ES-Standard-A\") {\n        // This would integrate with services like Google Cloud TTS, Azure Cognitive Services, etc.\n        // For now, we'll return a placeholder\n        try {\n            // Placeholder for external TTS integration\n            // Could integrate with Google Cloud TTS, Azure, AWS Polly, etc.\n            return {\n                success: false,\n                error: \"External TTS service not configured\"\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"External TTS error\"\n            };\n        }\n    }\n    /**\n   * Check if audio features are supported\n   */ isSupported() {\n        return this.synthesis !== null;\n    }\n    /**\n   * Get debug information about audio capabilities\n   */ getDebugInfo() {\n        return {\n            isSupported: this.isSupported(),\n            isInitialized: this.isInitialized,\n            voicesCount: this.voices.length,\n            currentlySpeaking: this.isSpeaking(),\n            availableEnglishVoices: this.getAvailableVoices(\"en\").map((v)=>({\n                    name: v.name,\n                    lang: v.lang,\n                    default: v.default\n                }))\n        };\n    }\n}\n// Create singleton instance\nconst audioService = new AudioService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM3QmhFLGVBQWUsSUFBSSxDQUFDQSxhQUFhO1lBQ2pDa0UsYUFBYSxJQUFJLENBQUNwRSxNQUFNLENBQUNRLE1BQU07WUFDL0I2RCxtQkFBbUIsSUFBSSxDQUFDbEIsVUFBVTtZQUNsQ21CLHdCQUF3QixJQUFJLENBQUM1RCxrQkFBa0IsQ0FBQyxNQUFNNkQsR0FBRyxDQUFDakQsQ0FBQUEsSUFBTTtvQkFDOURDLE1BQU1ELEVBQUVDLElBQUk7b0JBQ1pULE1BQU1RLEVBQUVSLElBQUk7b0JBQ1owRCxTQUFTbEQsRUFBRWtELE9BQU87Z0JBQ3BCO1FBQ0Y7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLE1BQU1DLGVBQWUsSUFBSTVFLGVBQWUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcHAvLi9saWIvYXVkaW8tc2VydmljZS50cz84ZDFkIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXVkaW8gU2VydmljZSBmb3IgUHJvZkFJXG4gKiBIYW5kbGVzIHRleHQtdG8tc3BlZWNoIGZ1bmN0aW9uYWxpdHkgdXNpbmcgV2ViIFNwZWVjaCBBUEkgYW5kIG9wdGlvbmFsIGV4dGVybmFsIHNlcnZpY2VzXG4gKi9cblxuaW50ZXJmYWNlIFZvaWNlT3B0aW9ucyB7XG4gIHJhdGU/OiBudW1iZXI7XG4gIHBpdGNoPzogbnVtYmVyO1xuICB2b2x1bWU/OiBudW1iZXI7XG4gIGxhbmd1YWdlPzogc3RyaW5nO1xuICB2b2ljZU5hbWU/OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBBdWRpb1Jlc3BvbnNlIHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgYXVkaW9Vcmw/OiBzdHJpbmc7XG4gIGR1cmF0aW9uPzogbnVtYmVyO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEF1ZGlvU2VydmljZSB7XG4gIHByaXZhdGUgc3ludGhlc2lzOiBTcGVlY2hTeW50aGVzaXMgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB2b2ljZXM6IFNwZWVjaFN5bnRoZXNpc1ZvaWNlW10gPSBbXTtcbiAgcHJpdmF0ZSBjdXJyZW50VXR0ZXJhbmNlOiBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBpc0luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICdzcGVlY2hTeW50aGVzaXMnIGluIHdpbmRvdykge1xuICAgICAgdGhpcy5zeW50aGVzaXMgPSB3aW5kb3cuc3BlZWNoU3ludGhlc2lzO1xuICAgICAgdGhpcy5pbml0aWFsaXplVm9pY2VzKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplVm9pY2VzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5zeW50aGVzaXMpIHJldHVybjtcblxuICAgIC8vIExvYWQgYXZhaWxhYmxlIHZvaWNlc1xuICAgIGNvbnN0IGxvYWRWb2ljZXMgPSAoKSA9PiB7XG4gICAgICB0aGlzLnZvaWNlcyA9IHRoaXMuc3ludGhlc2lzIS5nZXRWb2ljZXMoKTtcbiAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgfTtcblxuICAgIGlmICh0aGlzLnN5bnRoZXNpcy5nZXRWb2ljZXMoKS5sZW5ndGggPiAwKSB7XG4gICAgICBsb2FkVm9pY2VzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3ludGhlc2lzLm9udm9pY2VzY2hhbmdlZCA9IGxvYWRWb2ljZXM7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhdmFpbGFibGUgdm9pY2VzIGZvciB0aGUgc3BlY2lmaWVkIGxhbmd1YWdlXG4gICAqL1xuICBnZXRBdmFpbGFibGVWb2ljZXMobGFuZ3VhZ2U6IHN0cmluZyA9ICdlbi1VUycpOiBTcGVlY2hTeW50aGVzaXNWb2ljZVtdIHtcbiAgICByZXR1cm4gdGhpcy52b2ljZXMuZmlsdGVyKHZvaWNlID0+IFxuICAgICAgdm9pY2UubGFuZy5zdGFydHNXaXRoKGxhbmd1YWdlLnN1YnN0cmluZygwLCAyKSlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgYmVzdCB2b2ljZSBmb3IgRW5nbGlzaCAoUHJvZkFJJ3MgZGVmYXVsdCBsYW5ndWFnZSlcbiAgICovXG4gIGdldEJlc3RFbmdsaXNoVm9pY2UoKTogU3BlZWNoU3ludGhlc2lzVm9pY2UgfCBudWxsIHtcbiAgICAvLyBQcmVmZXIgc3BlY2lmaWMgRW5nbGlzaCB2b2ljZXNcbiAgICBjb25zdCBlbmdsaXNoVm9pY2VzID0gdGhpcy5nZXRBdmFpbGFibGVWb2ljZXMoJ2VuJyk7XG4gICAgXG4gICAgLy8gUHJpb3JpdHkgb3JkZXIgZm9yIEVuZ2xpc2ggdm9pY2VzXG4gICAgY29uc3QgcHJlZmVycmVkTmFtZXMgPSBbXG4gICAgICAnR29vZ2xlIFVTIEVuZ2xpc2gnLFxuICAgICAgJ01pY3Jvc29mdCBaaXJhIC0gRW5nbGlzaCAoVW5pdGVkIFN0YXRlcyknLFxuICAgICAgJ01pY3Jvc29mdCBEYXZpZCAtIEVuZ2xpc2ggKFVuaXRlZCBTdGF0ZXMpJyxcbiAgICAgICdBbGV4JyxcbiAgICAgICdTYW1hbnRoYScsXG4gICAgICAnVmljdG9yaWEnXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgcHJlZmVycmVkIG9mIHByZWZlcnJlZE5hbWVzKSB7XG4gICAgICBjb25zdCB2b2ljZSA9IGVuZ2xpc2hWb2ljZXMuZmluZCh2ID0+IHYubmFtZS5pbmNsdWRlcyhwcmVmZXJyZWQpKTtcbiAgICAgIGlmICh2b2ljZSkgcmV0dXJuIHZvaWNlO1xuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrIHRvIGFueSBFbmdsaXNoIHZvaWNlXG4gICAgcmV0dXJuIGVuZ2xpc2hWb2ljZXNbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IHRleHQgdG8gc3BlZWNoIHVzaW5nIFdlYiBTcGVlY2ggQVBJXG4gICAqL1xuICBhc3luYyBzcGVha1RleHQoXG4gICAgdGV4dDogc3RyaW5nLCBcbiAgICBvcHRpb25zOiBWb2ljZU9wdGlvbnMgPSB7fVxuICApOiBQcm9taXNlPEF1ZGlvUmVzcG9uc2U+IHtcbiAgICBpZiAoIXRoaXMuc3ludGhlc2lzKSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdTcGVlY2ggc3ludGhlc2lzIG5vdCBzdXBwb3J0ZWQnIH07XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdGV4dCBmb3IgYmV0dGVyIHNwZWVjaFxuICAgIGNvbnN0IGNsZWFuVGV4dCA9IHRoaXMuY2xlYW5UZXh0Rm9yU3BlZWNoKHRleHQpO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBTdG9wIGFueSBjdXJyZW50IHNwZWVjaFxuICAgICAgICB0aGlzLnN0b3BTcGVha2luZygpO1xuXG4gICAgICAgIGNvbnN0IHV0dGVyYW5jZSA9IG5ldyBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UoY2xlYW5UZXh0KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB2b2ljZSBvcHRpb25zXG4gICAgICAgIGNvbnN0IHZvaWNlID0gb3B0aW9ucy52b2ljZU5hbWUgXG4gICAgICAgICAgPyB0aGlzLnZvaWNlcy5maW5kKHYgPT4gdi5uYW1lID09PSBvcHRpb25zLnZvaWNlTmFtZSlcbiAgICAgICAgICA6IHRoaXMuZ2V0QmVzdEVuZ2xpc2hWb2ljZSgpO1xuXG4gICAgICAgIGlmICh2b2ljZSkgdXR0ZXJhbmNlLnZvaWNlID0gdm9pY2U7XG4gICAgICAgIFxuICAgICAgICB1dHRlcmFuY2UucmF0ZSA9IG9wdGlvbnMucmF0ZSB8fCAwLjk7IC8vIFNsaWdodGx5IHNsb3dlciBmb3IgZWR1Y2F0aW9uXG4gICAgICAgIHV0dGVyYW5jZS5waXRjaCA9IG9wdGlvbnMucGl0Y2ggfHwgMS4wO1xuICAgICAgICB1dHRlcmFuY2Uudm9sdW1lID0gb3B0aW9ucy52b2x1bWUgfHwgMC44O1xuICAgICAgICB1dHRlcmFuY2UubGFuZyA9IG9wdGlvbnMubGFuZ3VhZ2UgfHwgJ2VuLVVTJztcblxuICAgICAgICAvLyBFdmVudCBoYW5kbGVyc1xuICAgICAgICB1dHRlcmFuY2Uub25zdGFydCA9ICgpID0+IHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRVdHRlcmFuY2UgPSB1dHRlcmFuY2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdXR0ZXJhbmNlLm9uZW5kID0gKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudFV0dGVyYW5jZSA9IG51bGw7XG4gICAgICAgICAgcmVzb2x2ZSh7IFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSwgXG4gICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5lc3RpbWF0ZUR1cmF0aW9uKGNsZWFuVGV4dCkgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdXR0ZXJhbmNlLm9uZXJyb3IgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRVdHRlcmFuY2UgPSBudWxsO1xuICAgICAgICAgIHJlc29sdmUoeyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICAgIGVycm9yOiBgU3BlZWNoIGVycm9yOiAke2V2ZW50LmVycm9yfWAgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gU3RhcnQgc3BlYWtpbmdcbiAgICAgICAgdGhpcy5zeW50aGVzaXMuc3BlYWsodXR0ZXJhbmNlKTtcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVzb2x2ZSh7IFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgY3VycmVudCBzcGVlY2hcbiAgICovXG4gIHN0b3BTcGVha2luZygpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zeW50aGVzaXMpIHtcbiAgICAgIHRoaXMuc3ludGhlc2lzLmNhbmNlbCgpO1xuICAgICAgdGhpcy5jdXJyZW50VXR0ZXJhbmNlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgY3VycmVudGx5IHNwZWFraW5nXG4gICAqL1xuICBpc1NwZWFraW5nKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnN5bnRoZXNpcyA/IHRoaXMuc3ludGhlc2lzLnNwZWFraW5nIDogZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogUGF1c2UgY3VycmVudCBzcGVlY2hcbiAgICovXG4gIHBhdXNlU3BlYWtpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc3ludGhlc2lzICYmIHRoaXMuc3ludGhlc2lzLnNwZWFraW5nKSB7XG4gICAgICB0aGlzLnN5bnRoZXNpcy5wYXVzZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXN1bWUgcGF1c2VkIHNwZWVjaFxuICAgKi9cbiAgcmVzdW1lU3BlYWtpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc3ludGhlc2lzICYmIHRoaXMuc3ludGhlc2lzLnBhdXNlZCkge1xuICAgICAgdGhpcy5zeW50aGVzaXMucmVzdW1lKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHRleHQgZm9yIGJldHRlciBzcGVlY2ggc3ludGhlc2lzXG4gICAqL1xuICBwcml2YXRlIGNsZWFuVGV4dEZvclNwZWVjaCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB0ZXh0XG4gICAgICAvLyBSZW1vdmUgbWFya2Rvd24gZm9ybWF0dGluZ1xuICAgICAgLnJlcGxhY2UoL1xcKlxcKiguKj8pXFwqXFwqL2csICckMScpIC8vIEJvbGRcbiAgICAgIC5yZXBsYWNlKC9cXCooLio/KVxcKi9nLCAnJDEnKSAgICAgLy8gSXRhbGljXG4gICAgICAucmVwbGFjZSgvYCguKj8pYC9nLCAnJDEnKSAgICAgICAvLyBDb2RlXG4gICAgICAucmVwbGFjZSgvI3sxLDZ9XFxzKiguKikvZywgJyQxJykgLy8gSGVhZGVyc1xuICAgICAgLnJlcGxhY2UoL1xcWyguKj8pXFxdXFwoLio/XFwpL2csICckMScpIC8vIExpbmtzXG4gICAgICAvLyBSZW1vdmUgZW1vamlzIChiYXNpYylcbiAgICAgIC5yZXBsYWNlKC9bXFx1ezFGNjAwfS1cXHV7MUY2NEZ9XXxbXFx1ezFGMzAwfS1cXHV7MUY1RkZ9XXxbXFx1ezFGNjgwfS1cXHV7MUY2RkZ9XXxbXFx1ezFGMUUwfS1cXHV7MUYxRkZ9XXxbXFx1ezI2MDB9LVxcdXsyNkZGfV18W1xcdXsyNzAwfS1cXHV7MjdCRn1dL2d1LCAnJylcbiAgICAgIC8vIENsZWFuIHVwIGV4dHJhIHNwYWNlcyBhbmQgYnJlYWtzXG4gICAgICAucmVwbGFjZSgvXFxuXFxzKlxcbi9nLCAnLiAnKVxuICAgICAgLnJlcGxhY2UoL1xcbi9nLCAnICcpXG4gICAgICAucmVwbGFjZSgvXFxzKy9nLCAnICcpXG4gICAgICAudHJpbSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVzdGltYXRlIHNwZWVjaCBkdXJhdGlvbiBpbiBzZWNvbmRzXG4gICAqL1xuICBwcml2YXRlIGVzdGltYXRlRHVyYXRpb24odGV4dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAvLyBBdmVyYWdlIHNwZWFraW5nIHJhdGU6IH4xNTAgd29yZHMgcGVyIG1pbnV0ZSBmb3IgZWR1Y2F0aW9uYWwgY29udGVudFxuICAgIGNvbnN0IHdvcmRzUGVyTWludXRlID0gMTMwOyAvLyBTbG93ZXIgZm9yIEFJIGVkdWNhdGlvblxuICAgIGNvbnN0IHdvcmRDb3VudCA9IHRleHQuc3BsaXQoL1xccysvKS5sZW5ndGg7XG4gICAgcmV0dXJuIE1hdGguY2VpbCgod29yZENvdW50IC8gd29yZHNQZXJNaW51dGUpICogNjApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGF1ZGlvIHVzaW5nIGV4dGVybmFsIFRUUyBzZXJ2aWNlIChmYWxsYmFjay9lbmhhbmNlbWVudClcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlQXVkaW9XaXRoRXh0ZXJuYWxTZXJ2aWNlKFxuICAgIHRleHQ6IHN0cmluZyxcbiAgICB2b2ljZTogc3RyaW5nID0gJ2VzLUVTLVN0YW5kYXJkLUEnXG4gICk6IFByb21pc2U8QXVkaW9SZXNwb25zZT4ge1xuICAgIC8vIFRoaXMgd291bGQgaW50ZWdyYXRlIHdpdGggc2VydmljZXMgbGlrZSBHb29nbGUgQ2xvdWQgVFRTLCBBenVyZSBDb2duaXRpdmUgU2VydmljZXMsIGV0Yy5cbiAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gYSBwbGFjZWhvbGRlclxuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBQbGFjZWhvbGRlciBmb3IgZXh0ZXJuYWwgVFRTIGludGVncmF0aW9uXG4gICAgICAvLyBDb3VsZCBpbnRlZ3JhdGUgd2l0aCBHb29nbGUgQ2xvdWQgVFRTLCBBenVyZSwgQVdTIFBvbGx5LCBldGMuXG4gICAgICBcbiAgICAgIHJldHVybiB7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgIGVycm9yOiAnRXh0ZXJuYWwgVFRTIHNlcnZpY2Ugbm90IGNvbmZpZ3VyZWQnIFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0V4dGVybmFsIFRUUyBlcnJvcicgXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBhdWRpbyBmZWF0dXJlcyBhcmUgc3VwcG9ydGVkXG4gICAqL1xuICBpc1N1cHBvcnRlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zeW50aGVzaXMgIT09IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRlYnVnIGluZm9ybWF0aW9uIGFib3V0IGF1ZGlvIGNhcGFiaWxpdGllc1xuICAgKi9cbiAgZ2V0RGVidWdJbmZvKCk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzU3VwcG9ydGVkOiB0aGlzLmlzU3VwcG9ydGVkKCksXG4gICAgICBpc0luaXRpYWxpemVkOiB0aGlzLmlzSW5pdGlhbGl6ZWQsXG4gICAgICB2b2ljZXNDb3VudDogdGhpcy52b2ljZXMubGVuZ3RoLFxuICAgICAgY3VycmVudGx5U3BlYWtpbmc6IHRoaXMuaXNTcGVha2luZygpLFxuICAgICAgYXZhaWxhYmxlRW5nbGlzaFZvaWNlczogdGhpcy5nZXRBdmFpbGFibGVWb2ljZXMoJ2VuJykubWFwKHYgPT4gKHtcbiAgICAgICAgbmFtZTogdi5uYW1lLFxuICAgICAgICBsYW5nOiB2LmxhbmcsXG4gICAgICAgIGRlZmF1bHQ6IHYuZGVmYXVsdFxuICAgICAgfSkpXG4gICAgfTtcbiAgfVxufVxuXG4vLyBDcmVhdGUgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgYXVkaW9TZXJ2aWNlID0gbmV3IEF1ZGlvU2VydmljZSgpO1xuXG4vLyBBdWRpby1lbmhhbmNlZCByZXNwb25zZSBpbnRlcmZhY2VcbmV4cG9ydCBpbnRlcmZhY2UgQXVkaW9FbmhhbmNlZFJlc3BvbnNlIHtcbiAgdGV4dDogc3RyaW5nO1xuICBhdWRpbz86IHtcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgIHZvaWNlPzogc3RyaW5nO1xuICAgIGlzUGxheWluZz86IGJvb2xlYW47XG4gIH07XG4gIHN1Z2dlc3Rpb25zPzogc3RyaW5nW107XG4gIG1ldGFkYXRhPzogYW55O1xufVxuIl0sIm5hbWVzIjpbIkF1ZGlvU2VydmljZSIsImNvbnN0cnVjdG9yIiwic3ludGhlc2lzIiwidm9pY2VzIiwiY3VycmVudFV0dGVyYW5jZSIsImlzSW5pdGlhbGl6ZWQiLCJ3aW5kb3ciLCJzcGVlY2hTeW50aGVzaXMiLCJpbml0aWFsaXplVm9pY2VzIiwibG9hZFZvaWNlcyIsImdldFZvaWNlcyIsImxlbmd0aCIsIm9udm9pY2VzY2hhbmdlZCIsImdldEF2YWlsYWJsZVZvaWNlcyIsImxhbmd1YWdlIiwiZmlsdGVyIiwidm9pY2UiLCJsYW5nIiwic3RhcnRzV2l0aCIsInN1YnN0cmluZyIsImdldEJlc3RFbmdsaXNoVm9pY2UiLCJlbmdsaXNoVm9pY2VzIiwicHJlZmVycmVkTmFtZXMiLCJwcmVmZXJyZWQiLCJmaW5kIiwidiIsIm5hbWUiLCJpbmNsdWRlcyIsInNwZWFrVGV4dCIsInRleHQiLCJvcHRpb25zIiwic3VjY2VzcyIsImVycm9yIiwiY2xlYW5UZXh0IiwiY2xlYW5UZXh0Rm9yU3BlZWNoIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzdG9wU3BlYWtpbmciLCJ1dHRlcmFuY2UiLCJTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UiLCJ2b2ljZU5hbWUiLCJyYXRlIiwicGl0Y2giLCJ2b2x1bWUiLCJvbnN0YXJ0Iiwib25lbmQiLCJkdXJhdGlvbiIsImVzdGltYXRlRHVyYXRpb24iLCJvbmVycm9yIiwiZXZlbnQiLCJzcGVhayIsIkVycm9yIiwibWVzc2FnZSIsImNhbmNlbCIsImlzU3BlYWtpbmciLCJzcGVha2luZyIsInBhdXNlU3BlYWtpbmciLCJwYXVzZSIsInJlc3VtZVNwZWFraW5nIiwicGF1c2VkIiwicmVzdW1lIiwicmVwbGFjZSIsInRyaW0iLCJ3b3Jkc1Blck1pbnV0ZSIsIndvcmRDb3VudCIsInNwbGl0IiwiTWF0aCIsImNlaWwiLCJnZW5lcmF0ZUF1ZGlvV2l0aEV4dGVybmFsU2VydmljZSIsImlzU3VwcG9ydGVkIiwiZ2V0RGVidWdJbmZvIiwidm9pY2VzQ291bnQiLCJjdXJyZW50bHlTcGVha2luZyIsImF2YWlsYWJsZUVuZ2xpc2hWb2ljZXMiLCJtYXAiLCJkZWZhdWx0IiwiYXVkaW9TZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/audio-service.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0,\n    datasources: {\n        db: {\n            url: process.env.DATABASE_URL\n        }\n    }\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTZDO0FBRTdDLE1BQU1DLGtCQUFrQkM7QUFJakIsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUksSUFBSUgsd0RBQVlBLENBQUM7SUFDL0RJLEtBQUtDLEtBQXlCLEdBQWdCO1FBQUM7UUFBUztRQUFTO0tBQU8sR0FBRyxDQUFTO0lBQ3BGQyxhQUFhO1FBQ1hDLElBQUk7WUFDRkMsS0FBS0gsUUFBUUksR0FBRyxDQUFDQyxZQUFZO1FBQy9CO0lBQ0Y7QUFDRixHQUFFO0FBRUYsSUFBSUwsSUFBeUIsRUFBY0osZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoe1xuICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gWydxdWVyeScsICdlcnJvcicsICd3YXJuJ10gOiBbJ2Vycm9yJ10sXG4gIGRhdGFzb3VyY2VzOiB7XG4gICAgZGI6IHtcbiAgICAgIHVybDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMXG4gICAgfVxuICB9XG59KVxuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJsb2ciLCJwcm9jZXNzIiwiZGF0YXNvdXJjZXMiLCJkYiIsInVybCIsImVudiIsIkRBVEFCQVNFX1VSTCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/enhanced-gemini.ts":
/*!********************************!*\
  !*** ./lib/enhanced-gemini.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EnhancedGeminiService: () => (/* binding */ EnhancedGeminiService),\n/* harmony export */   MessageSender: () => (/* binding */ MessageSender),\n/* harmony export */   enhancedGeminiService: () => (/* binding */ enhancedGeminiService),\n/* harmony export */   geminiService: () => (/* binding */ enhancedGeminiService)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _video_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./video-service */ \"(rsc)/./lib/video-service.ts\");\n/* harmony import */ var _audio_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./audio-service */ \"(rsc)/./lib/audio-service.ts\");\n/**\n * Enhanced ProfAI Gemini Service with Chat Integration\n * Integrates with existing ProfAI infrastructure while adding advanced chat capabilities\n */ \n\n\nvar MessageSender;\n(function(MessageSender) {\n    MessageSender[\"USER\"] = \"user\";\n    MessageSender[\"AI\"] = \"ai\";\n})(MessageSender || (MessageSender = {}));\nclass EnhancedGeminiService {\n    constructor(){\n        const apiKey = process.env.GEMINI_API_KEY || process.env.API_KEY;\n        if (!apiKey) {\n            console.error(\"GEMINI_API_KEY or API_KEY environment variable not set.\");\n            throw new Error(\"API key is required\");\n        }\n        this.genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(apiKey);\n        this.model = this.genAI.getGenerativeModel({\n            model: \"gemini-2.0-flash-exp\"\n        });\n    }\n    /**\n   * Generate initial lesson content based on onboarding data and selected topic\n   */ async generateInitialLesson(onboardingData, lessonTopic) {\n        let prompt;\n        if (lessonTopic) {\n            prompt = `You are ProfAI, an MIT-style AI professor. The student has selected a topic from their personalized roadmap: \"${lessonTopic}\".\n\n      Start a conversation about this specific topic. Ask them what they'd like to know about it, or if they'd prefer a general overview. \n      \n      Keep it welcoming, concise, and use markdown for formatting. Your response should be 2-3 sentences max.`;\n        } else if (onboardingData?.themeId) {\n            const selectedTheme = onboardingData.themeId;\n            prompt = `You are ProfAI, an MIT-style AI professor. You are greeting a student who has just completed their detailed onboarding.\n      \n      - Their primary goal is: ${onboardingData.learningGoals[0]}\n      - They are starting with the theme: ${selectedTheme}\n      - Their experience level: ${onboardingData.elearningExperience}\n      - Preferred learning methods: ${onboardingData.learningMethods.join(\", \")}\n      \n      Welcome them back to the chat interface. Let them know their personalized plan is ready on the home page and that here, they can ask any question to start their first lesson. \n      \n      Keep it short (2-3 sentences), welcoming, and encouraging. Use markdown for formatting.`;\n        } else {\n            prompt = \"Welcome back! Let's continue our lesson. What would you like to discuss today?\";\n        }\n        try {\n            const result = await this.model.generateContent(prompt);\n            const response = await result.response;\n            return response.text();\n        } catch (error) {\n            console.error(\"Error generating initial lesson:\", error);\n            return \"Hello! I'm ProfAI, your personal AI tutor. I'm here to help you learn. Where would you like to start today?\";\n        }\n    }\n    /**\n   * Generate video playlist based on roadmap items\n   */ async generateVideoPlaylist(roadmap) {\n        const roadmapTitles = roadmap.map((item)=>item.title).join(\", \");\n        const prompt = `Based on the following AI learning topics, find one highly relevant, educational YouTube video for each topic from a reputable source. \n    \n    **IMPORTANT**: The videos must be publicly available and allow embedding on other websites.\n\n    Topics: \"${roadmapTitles}\"\n\n    Prioritize videos from channels that usually allow embedding, like:\n    - Tech educators (3Blue1Brown, Fireship, TwoMinutePapers)\n    - Official company channels (Google AI, OpenAI, DeepMind)\n    - Educational channels (Crash Course, Khan Academy)\n    \n    Avoid university lectures which often restrict embedding.\n\n    Return ONLY a valid JSON array of objects. Each object must have \"videoId\" and \"title\" properties. \n    Do not include the full YouTube URL, only the video ID from the URL.\n    \n    Format:\n    [\n        { \"videoId\": \"G2fqAlgmoPo\", \"title\": \"What is Generative AI?\" },\n        { \"videoId\": \"iR2O2GPbB0E\", \"title\": \"What are Large Language Models?\" }\n    ]`;\n        try {\n            const config = {\n                temperature: 0.3,\n                maxOutputTokens: 2048\n            };\n            const result = await this.model.generateContent({\n                contents: [\n                    {\n                        role: \"user\",\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: config\n            });\n            const response = await result.response;\n            let jsonString = response.text();\n            // Clean up the response to extract pure JSON\n            jsonString = this.cleanJsonResponse(jsonString);\n            const parsedVideos = JSON.parse(jsonString);\n            return parsedVideos.map((video)=>({\n                    ...video,\n                    thumbnailUrl: `https://i.ytimg.com/vi/${video.videoId}/hqdefault.jpg`\n                }));\n        } catch (error) {\n            console.error(\"Error generating video playlist:\", error);\n            return this.getFallbackVideos(roadmap);\n        }\n    }\n    /**\n   * Generate personalized learning roadmap\n   */ async generateRoadmap(onboardingData, themeName) {\n        const prompt = `You are an expert curriculum designer for AI education. Create a personalized 5-step learning roadmap for the topic \"${themeName}\".\n\n    Student Profile:\n    - Learning Goals: ${onboardingData.learningGoals.join(\", \")}\n    - Experience Level: ${onboardingData.elearningExperience}\n    - Preferred Learning Methods: ${onboardingData.learningMethods.join(\", \")}\n    - Current AI Usage: ${onboardingData.aiUsage}\n    - AI Understanding: \"${onboardingData.aiUnderstanding}\"\n\n    Requirements:\n    - Create exactly 5 learning modules\n    - Tailor complexity to their experience level\n    - Match their preferred learning methods\n    - Align with their stated goals\n    - Progress logically from basics to advanced\n\n    Return ONLY a valid JSON array of objects with \"title\" and \"description\" properties.\n    \n    Example format:\n    [\n      {\n        \"title\": \"AI Fundamentals\",\n        \"description\": \"Start with core concepts and terminology you'll use throughout your AI journey.\"\n      }\n    ]`;\n        try {\n            const config = {\n                temperature: 0.7,\n                maxOutputTokens: 1500\n            };\n            const result = await this.model.generateContent({\n                contents: [\n                    {\n                        role: \"user\",\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: config\n            });\n            const response = await result.response;\n            let jsonString = this.cleanJsonResponse(response.text());\n            const roadmapItems = JSON.parse(jsonString);\n            return Array.isArray(roadmapItems) ? roadmapItems : this.getFallbackRoadmap(themeName);\n        } catch (error) {\n            console.error(\"Error generating roadmap:\", error);\n            return this.getFallbackRoadmap(themeName);\n        }\n    }\n    /**\n   * Enhanced chat analysis and response with video and audio integration\n   */ async analyzeAndRespond(history, userInput, context) {\n        try {\n            const conversationHistory = this.formatHistory(history);\n            const detectedEmotion = this.detectEmotionalState(userInput, history);\n            const currentEmotion = context?.emotionalState || detectedEmotion;\n            const detectedTopic = this.detectTopicFromInput(userInput);\n            let basePrompt = `You are ProfAI, an MIT-style AI professor specializing in AI education. Your teaching style is adaptive, encouraging, and visual.\n\n      **Context:**`;\n            if (context?.currentTopic) {\n                basePrompt += `\\nCurrent Topic: ${context.currentTopic}`;\n            }\n            if (context?.userName) {\n                basePrompt += `\\nStudent Name: ${context.userName}`;\n            }\n            if (currentEmotion) {\n                basePrompt += `\\nStudent Emotional State: ${currentEmotion}`;\n            }\n            if (context?.userProfile) {\n                basePrompt += `\\nUser Profile: ${JSON.stringify(context.userProfile)}`;\n            }\n            // Add lesson-specific context if available\n            if (context?.isLessonMode && context?.lessonPrompt) {\n                basePrompt += `\n      \n      **LESSON CONTEXT - VERY IMPORTANT:**\n      You are now operating in LESSON MODE for Course: ${context.courseId}, Lesson: ${context.lessonId}\n      \n      SPECIFIC LESSON PROMPT TO FOLLOW:\n      ${context.lessonPrompt}\n      \n      **CRITICAL INSTRUCTIONS:**\n      - Follow the specific lesson prompt above carefully\n      - Use the lesson context, examples, and guidelines provided\n      - Adapt your teaching style to the lesson's objectives\n      - Reference lesson-specific content when appropriate\n      - If the lesson mentions video/code/quiz resources, reference them naturally`;\n            }\n            const prompt = `${basePrompt}\n\n      **Conversation History:**\n      ${conversationHistory}\n\n      **Student's Latest Message:** \"${userInput}\"\n\n      **Your Tasks:**\n      1. ${context?.isLessonMode ? \"FIRST: Apply the specific lesson prompt and context above\" : \"Analyze the student's comprehension and emotional state\"}\n      2. Detect the main AI/ML topic being discussed (${detectedTopic || \"general AI\"})\n      3. Determine if a YouTube video would help explain the concept\n      4. Create an audio-friendly response (avoid complex formatting)\n      5. Craft an adaptive response (2-4 sentences):\n         - If struggling: be encouraging and simplify\n         - If confident: provide challenges\n         - If confused: break down concepts\n         - If engaged: maintain momentum\n\n      6. **Video Format**: If you recommend a video, append this EXACT format at the end:\n         @@VIDEO_INFO@@{\"videoId\": \"VIDEO_ID\", \"title\": \"VIDEO_TITLE\"}\n\n      **Examples:**\n\n      *With Video:*\n      Great question about neural networks! The learning process is called backpropagation. This video explains it visually, which should help clarify the concept.\n      @@VIDEO_INFO@@{\"videoId\": \"Ilg3gGewQ5U\", \"title\": \"What is backpropagation?\"}\n\n      *Without Video:*\n      Perfect understanding! You've grasped the core concept of machine learning. Ready for the next challenge?\n\n      **Audio Guidelines:**\n      - Keep responses conversational and natural for text-to-speech\n      - Avoid complex markdown formatting in speech portions\n      - Use clear, educational language\n      - Include emotional support when needed\n\n      Generate your response now:`;\n            const config = {\n                temperature: 0.8,\n                maxOutputTokens: 1000\n            };\n            const result = await this.model.generateContent({\n                contents: [\n                    {\n                        role: \"user\",\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: config\n            });\n            const response = await result.response;\n            const parsedResponse = this.parseVideoResponse(response.text(), {\n                emotionalState: currentEmotion,\n                confidence: this.calculateConfidence(userInput, history),\n                userName: context?.userName,\n                currentTopic: context?.currentTopic,\n                detectedTopic\n            });\n            // Add intelligent suggestions based on context\n            parsedResponse.suggestions = this.generateContextualSuggestions(userInput, parsedResponse.text, currentEmotion, context?.currentTopic || detectedTopic || undefined);\n            // Enhanced audio integration\n            parsedResponse.audio = {\n                enabled: _audio_service__WEBPACK_IMPORTED_MODULE_2__.audioService.isSupported(),\n                autoplay: currentEmotion === \"frustrated\" || currentEmotion === \"confused\",\n                voice: \"spanish-educational\"\n            };\n            // Enhanced metadata\n            parsedResponse.metadata = {\n                ...parsedResponse.metadata,\n                audioEnabled: parsedResponse.audio.enabled,\n                audioSupported: _audio_service__WEBPACK_IMPORTED_MODULE_2__.audioService.isSupported(),\n                hasVideo: !!parsedResponse.video,\n                topicDetected: detectedTopic || undefined,\n                enhancedFeatures: true\n            };\n            return parsedResponse;\n        } catch (error) {\n            console.error(\"Error in AI response generation:\", error);\n            return this.getFallbackResponse(userInput, context?.emotionalState);\n        }\n    }\n    /**\n   * Generate theme description for dashboard\n   */ async generateThemeDescription(themeName) {\n        const prompt = `Generate a concise, engaging description for the AI learning theme \"${themeName}\". \n    \n    Requirements:\n    - 2-3 sentences maximum\n    - Highlight what students will learn\n    - Use encouraging, professional tone\n    - Focus on practical outcomes\n    \n    Example: \"Master the fundamentals of machine learning through hands-on projects and real-world examples. You'll learn to build, train, and deploy your first ML models while understanding the theory that makes them work.\"`;\n        try {\n            const result = await this.model.generateContent(prompt);\n            const response = await result.response;\n            return response.text().trim();\n        } catch (error) {\n            console.error(\"Error generating theme description:\", error);\n            return `Explore the exciting world of ${themeName} with hands-on learning and practical applications.`;\n        }\n    }\n    /**\n   * Generate lesson content for specific topics\n   */ async generateLessonContent(themeName, lessonTitle) {\n        const prompt = `You are ProfAI, an expert AI tutor. Generate content for a micro-learning lesson.\n    \n    Theme: \"${themeName}\"\n    Lesson: \"${lessonTitle}\"\n\n    Requirements:\n    - Clear, beginner-friendly explanations\n    - Use practical examples and analogies\n    - Include 3-4 paragraphs of content\n    - End with a thought-provoking question\n    - Use markdown formatting for readability\n    - Keep it conversational and engaging\n\n    Structure:\n    1. Brief introduction to the concept\n    2. Core explanation with examples\n    3. Real-world applications\n    4. Understanding check question`;\n        try {\n            const config = {\n                temperature: 0.7,\n                maxOutputTokens: 1500\n            };\n            const result = await this.model.generateContent({\n                contents: [\n                    {\n                        role: \"user\",\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: config\n            });\n            const response = await result.response;\n            return response.text();\n        } catch (error) {\n            console.error(\"Error generating lesson content:\", error);\n            return `# ${lessonTitle}\\n\\nLo siento, no pude generar el contenido de esta lección en este momento. Por favor, intenta de nuevo más tarde.`;\n        }\n    }\n    // Helper methods\n    formatHistory(messages) {\n        return messages.slice(-10) // Keep last 10 messages for context\n        .map((m)=>`${m.sender === \"user\" ? \"Estudiante\" : \"ProfAI\"}: ${m.text}`).join(\"\\n\");\n    }\n    detectEmotionalState(userInput, history) {\n        const input = userInput.toLowerCase();\n        // Frustrated indicators\n        if (input.includes(\"no entiendo\") || input.includes(\"confundido\") || input.includes(\"dif\\xedcil\") || input.includes(\"no comprendo\") || input.includes(\"frustrado\") || input.includes(\"no funciona\")) {\n            return \"frustrated\";\n        }\n        // Confused indicators\n        if (input.includes(\"\\xbfqu\\xe9 es\") || input.includes(\"explica\") || input.includes(\"c\\xf3mo\") || input.includes(\"por qu\\xe9\") || input.includes(\"no s\\xe9\") || input.includes(\"ayuda\")) {\n            return \"confused\";\n        }\n        // Engaged indicators\n        if (input.includes(\"genial\") || input.includes(\"interesante\") || input.includes(\"m\\xe1s\") || input.includes(\"avanzado\") || input.includes(\"siguiente\") || input.includes(\"profundizar\")) {\n            return \"engaged\";\n        }\n        // Excited indicators\n        if (input.includes(\"wow\") || input.includes(\"incre\\xedble\") || input.includes(\"fascinante\") || input.includes(\"!\")) {\n            return \"excited\";\n        }\n        return \"neutral\";\n    }\n    calculateConfidence(userInput, history) {\n        let confidence = 0.5; // Base confidence\n        // Increase confidence based on conversation length\n        confidence += Math.min(history.length * 0.05, 0.3);\n        // Increase confidence for specific questions\n        if (userInput.includes(\"?\") || userInput.includes(\"qu\\xe9\") || userInput.includes(\"c\\xf3mo\")) {\n            confidence += 0.2;\n        }\n        // Decrease confidence for vague inputs\n        if (userInput.length < 10) {\n            confidence -= 0.2;\n        }\n        return Math.max(0.1, Math.min(1.0, confidence));\n    }\n    detectTopicFromInput(userInput) {\n        const input = userInput.toLowerCase();\n        // Define topic detection patterns\n        const topicPatterns = {\n            \"machine-learning\": [\n                \"machine learning\",\n                \"aprendizaje autom\\xe1tico\",\n                \"ml\",\n                \"algoritmos\",\n                \"predicci\\xf3n\"\n            ],\n            \"neural-networks\": [\n                \"redes neuronales\",\n                \"neural network\",\n                \"perceptr\\xf3n\",\n                \"neuronas\",\n                \"backpropagation\"\n            ],\n            \"deep-learning\": [\n                \"deep learning\",\n                \"aprendizaje profundo\",\n                \"rnn\",\n                \"cnn\",\n                \"lstm\",\n                \"transformer\"\n            ],\n            \"transformers\": [\n                \"transformer\",\n                \"attention\",\n                \"bert\",\n                \"gpt\",\n                \"llm\"\n            ],\n            \"prompt-engineering\": [\n                \"prompt\",\n                \"prompting\",\n                \"few-shot\",\n                \"zero-shot\",\n                \"chain of thought\"\n            ],\n            \"computer-vision\": [\n                \"visi\\xf3n\",\n                \"computer vision\",\n                \"imagen\",\n                \"opencv\",\n                \"cnn\",\n                \"clasificaci\\xf3n\"\n            ],\n            \"nlp\": [\n                \"nlp\",\n                \"procesamiento de lenguaje\",\n                \"texto\",\n                \"tokenizaci\\xf3n\",\n                \"embeddings\"\n            ]\n        };\n        // Find matching topic\n        for (const [topic, patterns] of Object.entries(topicPatterns)){\n            if (patterns.some((pattern)=>input.includes(pattern))) {\n                return topic;\n            }\n        }\n        return null;\n    }\n    generateContextualSuggestions(userInput, response, emotion, currentTopic) {\n        const suggestions = [];\n        // Base suggestions based on emotion\n        switch(emotion){\n            case \"confused\":\n                suggestions.push(\"\\xbfPuedes explicar eso m\\xe1s simple?\");\n                suggestions.push(\"Dame un ejemplo pr\\xe1ctico\");\n                suggestions.push(\"\\xbfQu\\xe9 conceptos necesito saber primero?\");\n                break;\n            case \"frustrated\":\n                suggestions.push(\"Empecemos con lo b\\xe1sico\");\n                suggestions.push(\"D\\xe9jame intentar un enfoque diferente\");\n                suggestions.push(\"\\xbfQu\\xe9 parte espec\\xedfica es la m\\xe1s dif\\xedcil?\");\n                break;\n            case \"engaged\":\n                suggestions.push(\"\\xbfQu\\xe9 m\\xe1s puedo aprender sobre esto?\");\n                suggestions.push(\"Dame un ejemplo m\\xe1s avanzado\");\n                suggestions.push(\"\\xbfC\\xf3mo se aplica esto en la pr\\xe1ctica?\");\n                break;\n            default:\n                suggestions.push(\"\\xbfPuedes dar m\\xe1s detalles?\");\n                suggestions.push(\"Mu\\xe9strame un ejemplo\");\n                suggestions.push(\"\\xbfCu\\xe1l es el siguiente paso?\");\n        }\n        // Topic-specific suggestions\n        if (currentTopic) {\n            if (currentTopic.includes(\"machine learning\")) {\n                suggestions.push(\"\\xbfC\\xf3mo entreno un modelo?\");\n                suggestions.push(\"\\xbfQu\\xe9 algoritmos debo usar?\");\n            } else if (currentTopic.includes(\"neural network\")) {\n                suggestions.push(\"\\xbfC\\xf3mo funciona backpropagation?\");\n                suggestions.push(\"\\xbfQu\\xe9 es una funci\\xf3n de activaci\\xf3n?\");\n            } else if (currentTopic.includes(\"prompt engineering\")) {\n                suggestions.push(\"Dame ejemplos de prompts efectivos\");\n                suggestions.push(\"\\xbfC\\xf3mo mejoro mis prompts?\");\n            }\n        }\n        return suggestions.slice(0, 3); // Return max 3 suggestions\n    }\n    getFallbackResponse(userInput, emotionalState) {\n        const fallbackMessages = {\n            frustrated: \"Entiendo que esto puede ser frustrante. Vamos paso a paso - \\xbfqu\\xe9 parte espec\\xedfica te est\\xe1 costando m\\xe1s?\",\n            confused: \"No hay problema, la IA puede ser compleja. \\xbfPodr\\xedas decirme qu\\xe9 concepto te gustar\\xeda que explique m\\xe1s claramente?\",\n            engaged: \"\\xa1Me encanta tu entusiasmo! Aunque tuve un problema t\\xe9cnico, sigamos aprendiendo - \\xbfqu\\xe9 tema te interesa m\\xe1s?\",\n            default: \"Disculpa, tuve un problema procesando eso. \\xbfPodr\\xedas reformular tu pregunta de otra manera?\"\n        };\n        const message = fallbackMessages[emotionalState] || fallbackMessages.default;\n        return {\n            text: message,\n            video: null,\n            suggestions: [\n                \"\\xbfQu\\xe9 es machine learning?\",\n                \"Explica las redes neuronales\",\n                \"Dame un ejemplo pr\\xe1ctico\"\n            ],\n            metadata: {\n                emotion: emotionalState || \"neutral\",\n                confidence: 0.3,\n                nextSteps: [\n                    \"Reformula tu pregunta\",\n                    \"Intenta con un tema espec\\xedfico\"\n                ]\n            }\n        };\n    }\n    cleanJsonResponse(jsonString) {\n        // Remove markdown code blocks\n        if (jsonString.startsWith(\"```json\")) {\n            jsonString = jsonString.substring(7);\n        }\n        if (jsonString.startsWith(\"```\")) {\n            jsonString = jsonString.substring(3);\n        }\n        if (jsonString.endsWith(\"```\")) {\n            jsonString = jsonString.substring(0, jsonString.length - 3);\n        }\n        jsonString = jsonString.trim();\n        // Find JSON array boundaries\n        const startIndex = jsonString.indexOf(\"[\");\n        const endIndex = jsonString.lastIndexOf(\"]\");\n        if (startIndex === -1 || endIndex === -1) {\n            throw new Error(\"No JSON array found in response\");\n        }\n        return jsonString.substring(startIndex, endIndex + 1);\n    }\n    parseVideoResponse(rawText, context) {\n        const videoMarker = \"@@VIDEO_INFO@@\";\n        let video = null;\n        let text = rawText;\n        if (rawText.includes(videoMarker)) {\n            const parts = rawText.split(videoMarker);\n            text = parts[0].trim();\n            try {\n                const videoData = JSON.parse(parts[1]);\n                // Try to get better video from our service if we have topic context\n                const detectedTopic = context?.detectedTopic;\n                if (detectedTopic) {\n                    const betterVideo = _video_service__WEBPACK_IMPORTED_MODULE_1__.videoService.findBestVideoForTopic(detectedTopic, context?.userProfile?.learningLevel || \"beginner\", \"en\");\n                    if (betterVideo) {\n                        video = {\n                            videoId: betterVideo.videoId,\n                            title: betterVideo.title,\n                            thumbnailUrl: betterVideo.thumbnailUrl,\n                            duration: betterVideo.duration,\n                            description: betterVideo.description || `Video educativo sobre ${detectedTopic}`\n                        };\n                    }\n                }\n                // Fallback to Gemini's recommendation if no better video found\n                if (!video) {\n                    video = {\n                        videoId: videoData.videoId,\n                        title: videoData.title,\n                        thumbnailUrl: `https://i.ytimg.com/vi/${videoData.videoId}/hqdefault.jpg`,\n                        description: `Video recomendado sobre ${context?.currentTopic || \"el tema\"}`\n                    };\n                }\n            } catch (e) {\n                console.error(\"Failed to parse video JSON:\", e);\n                // Try to find a relevant video based on context anyway\n                const detectedTopic = context?.detectedTopic || context?.currentTopic;\n                if (detectedTopic) {\n                    const fallbackVideo = _video_service__WEBPACK_IMPORTED_MODULE_1__.videoService.findBestVideoForTopic(detectedTopic);\n                    if (fallbackVideo) {\n                        video = {\n                            videoId: fallbackVideo.videoId,\n                            title: fallbackVideo.title,\n                            thumbnailUrl: fallbackVideo.thumbnailUrl,\n                            duration: fallbackVideo.duration,\n                            description: fallbackVideo.description\n                        };\n                    }\n                }\n            }\n        } else {\n            // No video marker found, but check if we should recommend one based on topic\n            const detectedTopic = context?.detectedTopic;\n            if (detectedTopic && (context?.emotionalState === \"confused\" || context?.emotionalState === \"frustrated\" || text.toLowerCase().includes(\"no entiendo\") || text.toLowerCase().includes(\"visual\"))) {\n                const recommendedVideo = _video_service__WEBPACK_IMPORTED_MODULE_1__.videoService.findBestVideoForTopic(detectedTopic);\n                if (recommendedVideo) {\n                    video = {\n                        videoId: recommendedVideo.videoId,\n                        title: recommendedVideo.title,\n                        thumbnailUrl: recommendedVideo.thumbnailUrl,\n                        duration: recommendedVideo.duration,\n                        description: recommendedVideo.description\n                    };\n                    // Add a note about the video recommendation\n                    text += `\\n\\nTe recomiendo este video que puede ayudarte a entender mejor el concepto:`;\n                }\n            }\n        }\n        // Clean up the text response for better audio synthesis\n        const audioFriendlyText = this.prepareTextForAudio(text);\n        return {\n            text: audioFriendlyText,\n            video,\n            metadata: {\n                emotion: context?.emotionalState || \"neutral\",\n                confidence: context?.confidence || (video ? 0.8 : 0.6),\n                nextSteps: video ? [\n                    \"Ve el video recomendado\",\n                    \"Haz preguntas de seguimiento\",\n                    \"Prueba con un ejercicio\"\n                ] : [\n                    \"Contin\\xfaa la discusi\\xf3n\",\n                    \"Pide m\\xe1s ejemplos\",\n                    \"Solicita ejercicios pr\\xe1cticos\"\n                ],\n                userName: context?.userName\n            }\n        };\n    }\n    prepareTextForAudio(text) {\n        return text// Clean up for better audio synthesis\n        .replace(/\\*\\*(.*?)\\*\\*/g, \"$1\") // Remove bold formatting\n        .replace(/\\*(.*?)\\*/g, \"$1\") // Remove italic formatting\n        .replace(/`(.*?)`/g, \"$1\") // Remove code formatting\n        .replace(/#{1,6}\\s*(.*)/g, \"$1\") // Remove headers\n        .replace(/\\[(.*?)\\]\\(.*?\\)/g, \"$1\") // Remove links\n        // Keep the original text intact but add pauses for readability\n        .replace(/\\. /g, \". \").replace(/\\? /g, \"? \").replace(/! /g, \"! \").trim();\n    }\n    getFallbackVideos(roadmap) {\n        const fallbacks = [\n            {\n                videoId: \"ukzFI9rgwfU\",\n                title: \"Machine Learning Explained\"\n            },\n            {\n                videoId: \"aircAruvnKk\",\n                title: \"Neural Networks Introduction\"\n            },\n            {\n                videoId: \"IHZwWFHWa-w\",\n                title: \"AI vs Machine Learning\"\n            },\n            {\n                videoId: \"R9OHn5ZF4Uo\",\n                title: \"Deep Learning Basics\"\n            },\n            {\n                videoId: \"TJldO5M5tbo\",\n                title: \"AI Ethics Overview\"\n            }\n        ];\n        return fallbacks.slice(0, Math.min(roadmap.length, 5)).map((video)=>({\n                ...video,\n                thumbnailUrl: `https://i.ytimg.com/vi/${video.videoId}/hqdefault.jpg`\n            }));\n    }\n    getFallbackRoadmap(themeName) {\n        return [\n            {\n                title: \"Introducci\\xf3n a la IA\",\n                description: \"Aprende los conceptos b\\xe1sicos y terminolog\\xeda de la inteligencia artificial.\"\n            },\n            {\n                title: \"Tipos de IA\",\n                description: \"Explora las diferentes categor\\xedas como IA estrecha y IA general.\"\n            },\n            {\n                title: \"Machine Learning B\\xe1sico\",\n                description: \"Entiende c\\xf3mo las m\\xe1quinas aprenden de los datos.\"\n            },\n            {\n                title: \"Redes Neuronales\",\n                description: \"Un vistazo a la estructura del 'cerebro' de la IA.\"\n            },\n            {\n                title: \"\\xc9tica en IA\",\n                description: \"Discute las importantes implicaciones sociales de la IA.\"\n            }\n        ];\n    }\n}\n// Create singleton instance\nconst enhancedGeminiService = new EnhancedGeminiService();\n// Export for compatibility with existing code\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUNqRixRQUFRa0YsTUFBTSxFQUFFLElBQ2xDaEYsR0FBRyxDQUFDZSxDQUFBQSxRQUFVO2dCQUNiLEdBQUdBLEtBQUs7Z0JBQ1JDLGNBQWMsQ0FBQyx1QkFBdUIsRUFBRUQsTUFBTUUsT0FBTyxDQUFDLGNBQWMsQ0FBQztZQUN2RTtJQUNKO0lBRVFTLG1CQUFtQk4sU0FBaUIsRUFBaUI7UUFDM0QsT0FBTztZQUNMO2dCQUNFbEIsT0FBTztnQkFDUCtHLGFBQWE7WUFDZjtZQUNBO2dCQUNFL0csT0FBTztnQkFDUCtHLGFBQWE7WUFDZjtZQUNBO2dCQUNFL0csT0FBTztnQkFDUCtHLGFBQWE7WUFDZjtZQUNBO2dCQUNFL0csT0FBTztnQkFDUCtHLGFBQWE7WUFDZjtZQUNBO2dCQUNFL0csT0FBTztnQkFDUCtHLGFBQWE7WUFDZjtTQUNEO0lBQ0g7QUFDRjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNUSx3QkFBd0IsSUFBSXZKLHdCQUF3QjtBQUVqRSw4Q0FBOEM7QUFJNUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcHAvLi9saWIvZW5oYW5jZWQtZ2VtaW5pLnRzP2EyNjMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmhhbmNlZCBQcm9mQUkgR2VtaW5pIFNlcnZpY2Ugd2l0aCBDaGF0IEludGVncmF0aW9uXG4gKiBJbnRlZ3JhdGVzIHdpdGggZXhpc3RpbmcgUHJvZkFJIGluZnJhc3RydWN0dXJlIHdoaWxlIGFkZGluZyBhZHZhbmNlZCBjaGF0IGNhcGFiaWxpdGllc1xuICovXG5cbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSwgR2VuZXJhdGlvbkNvbmZpZyB9IGZyb20gXCJAZ29vZ2xlL2dlbmVyYXRpdmUtYWlcIjtcbmltcG9ydCB7IHZpZGVvU2VydmljZSwgdHlwZSBWaWRlb1JlY29tbWVuZGF0aW9uIH0gZnJvbSAnLi92aWRlby1zZXJ2aWNlJztcbmltcG9ydCB7IGF1ZGlvU2VydmljZSB9IGZyb20gJy4vYXVkaW8tc2VydmljZSc7XG5cbi8vIFR5cGVzIGZvciB0aGUgZW5oYW5jZWQgc3lzdGVtXG5leHBvcnQgaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICBpZD86IHN0cmluZztcbiAgdGV4dDogc3RyaW5nO1xuICBzZW5kZXI6IE1lc3NhZ2VTZW5kZXI7XG4gIHRpbWVzdGFtcD86IERhdGU7XG4gIG1ldGFkYXRhPzogYW55O1xufVxuXG5leHBvcnQgZW51bSBNZXNzYWdlU2VuZGVyIHtcbiAgVVNFUiA9ICd1c2VyJyxcbiAgQUkgPSAnYWknXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT25ib2FyZGluZ0RhdGEge1xuICBsZWFybmluZ0dvYWxzOiBzdHJpbmdbXTtcbiAgZWxlYXJuaW5nRXhwZXJpZW5jZTogJ2JlZ2lubmVyJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJztcbiAgbGVhcm5pbmdNZXRob2RzOiBzdHJpbmdbXTtcbiAgYWlVc2FnZTogc3RyaW5nO1xuICBhaVVuZGVyc3RhbmRpbmc6IHN0cmluZztcbiAgdGhlbWVJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSb2FkbWFwSXRlbSB7XG4gIGlkPzogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBjb21wbGV0ZWQ/OiBib29sZWFuO1xuICBvcmRlcj86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWaWRlbyB7XG4gIHZpZGVvSWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgdGh1bWJuYWlsVXJsOiBzdHJpbmc7XG4gIGR1cmF0aW9uPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGF0UmVzcG9uc2Uge1xuICB0ZXh0OiBzdHJpbmc7XG4gIHZpZGVvOiBWaWRlbyB8IG51bGw7XG4gIHN1Z2dlc3Rpb25zPzogc3RyaW5nW107XG4gIG1ldGFkYXRhPzoge1xuICAgIGVtb3Rpb24/OiBzdHJpbmc7XG4gICAgY29uZmlkZW5jZT86IG51bWJlcjtcbiAgICBuZXh0U3RlcHM/OiBzdHJpbmdbXTtcbiAgICB1c2VyTmFtZT86IHN0cmluZztcbiAgICBhdWRpb0VuYWJsZWQ/OiBib29sZWFuO1xuICAgIGF1ZGlvU3VwcG9ydGVkPzogYm9vbGVhbjtcbiAgICBoYXNWaWRlbz86IGJvb2xlYW47XG4gICAgdG9waWNEZXRlY3RlZD86IHN0cmluZztcbiAgICBlbmhhbmNlZEZlYXR1cmVzPzogYm9vbGVhbjtcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7IC8vIEFsbG93IGFkZGl0aW9uYWwgcHJvcGVydGllc1xuICB9O1xuICBhdWRpbz86IHtcbiAgICBlbmFibGVkOiBib29sZWFuO1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgIHZvaWNlPzogc3RyaW5nO1xuICAgIGF1dG9wbGF5PzogYm9vbGVhbjtcbiAgfTtcbn1cblxuY2xhc3MgRW5oYW5jZWRHZW1pbmlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBnZW5BSTogR29vZ2xlR2VuZXJhdGl2ZUFJO1xuICBwcml2YXRlIHJlYWRvbmx5IG1vZGVsOiBhbnk7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkgfHwgcHJvY2Vzcy5lbnYuQVBJX0tFWTtcbiAgICBcbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkdFTUlOSV9BUElfS0VZIG9yIEFQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgbm90IHNldC5cIik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBUEkga2V5IGlzIHJlcXVpcmVkXCIpO1xuICAgIH1cblxuICAgIHRoaXMuZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKGFwaUtleSk7XG4gICAgdGhpcy5tb2RlbCA9IHRoaXMuZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgXG4gICAgICBtb2RlbDogXCJnZW1pbmktMi4wLWZsYXNoLWV4cFwiXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgaW5pdGlhbCBsZXNzb24gY29udGVudCBiYXNlZCBvbiBvbmJvYXJkaW5nIGRhdGEgYW5kIHNlbGVjdGVkIHRvcGljXG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZUluaXRpYWxMZXNzb24oXG4gICAgb25ib2FyZGluZ0RhdGE6IE9uYm9hcmRpbmdEYXRhIHwgbnVsbCwgXG4gICAgbGVzc29uVG9waWM6IHN0cmluZyB8IG51bGxcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBsZXQgcHJvbXB0OiBzdHJpbmc7XG5cbiAgICBpZiAobGVzc29uVG9waWMpIHtcbiAgICAgIHByb21wdCA9IGBZb3UgYXJlIFByb2ZBSSwgYW4gTUlULXN0eWxlIEFJIHByb2Zlc3Nvci4gVGhlIHN0dWRlbnQgaGFzIHNlbGVjdGVkIGEgdG9waWMgZnJvbSB0aGVpciBwZXJzb25hbGl6ZWQgcm9hZG1hcDogXCIke2xlc3NvblRvcGljfVwiLlxuXG4gICAgICBTdGFydCBhIGNvbnZlcnNhdGlvbiBhYm91dCB0aGlzIHNwZWNpZmljIHRvcGljLiBBc2sgdGhlbSB3aGF0IHRoZXknZCBsaWtlIHRvIGtub3cgYWJvdXQgaXQsIG9yIGlmIHRoZXknZCBwcmVmZXIgYSBnZW5lcmFsIG92ZXJ2aWV3LiBcbiAgICAgIFxuICAgICAgS2VlcCBpdCB3ZWxjb21pbmcsIGNvbmNpc2UsIGFuZCB1c2UgbWFya2Rvd24gZm9yIGZvcm1hdHRpbmcuIFlvdXIgcmVzcG9uc2Ugc2hvdWxkIGJlIDItMyBzZW50ZW5jZXMgbWF4LmA7XG4gICAgfSBlbHNlIGlmIChvbmJvYXJkaW5nRGF0YT8udGhlbWVJZCkge1xuICAgICAgY29uc3Qgc2VsZWN0ZWRUaGVtZSA9IG9uYm9hcmRpbmdEYXRhLnRoZW1lSWQ7XG4gICAgICBwcm9tcHQgPSBgWW91IGFyZSBQcm9mQUksIGFuIE1JVC1zdHlsZSBBSSBwcm9mZXNzb3IuIFlvdSBhcmUgZ3JlZXRpbmcgYSBzdHVkZW50IHdobyBoYXMganVzdCBjb21wbGV0ZWQgdGhlaXIgZGV0YWlsZWQgb25ib2FyZGluZy5cbiAgICAgIFxuICAgICAgLSBUaGVpciBwcmltYXJ5IGdvYWwgaXM6ICR7b25ib2FyZGluZ0RhdGEubGVhcm5pbmdHb2Fsc1swXX1cbiAgICAgIC0gVGhleSBhcmUgc3RhcnRpbmcgd2l0aCB0aGUgdGhlbWU6ICR7c2VsZWN0ZWRUaGVtZX1cbiAgICAgIC0gVGhlaXIgZXhwZXJpZW5jZSBsZXZlbDogJHtvbmJvYXJkaW5nRGF0YS5lbGVhcm5pbmdFeHBlcmllbmNlfVxuICAgICAgLSBQcmVmZXJyZWQgbGVhcm5pbmcgbWV0aG9kczogJHtvbmJvYXJkaW5nRGF0YS5sZWFybmluZ01ldGhvZHMuam9pbignLCAnKX1cbiAgICAgIFxuICAgICAgV2VsY29tZSB0aGVtIGJhY2sgdG8gdGhlIGNoYXQgaW50ZXJmYWNlLiBMZXQgdGhlbSBrbm93IHRoZWlyIHBlcnNvbmFsaXplZCBwbGFuIGlzIHJlYWR5IG9uIHRoZSBob21lIHBhZ2UgYW5kIHRoYXQgaGVyZSwgdGhleSBjYW4gYXNrIGFueSBxdWVzdGlvbiB0byBzdGFydCB0aGVpciBmaXJzdCBsZXNzb24uIFxuICAgICAgXG4gICAgICBLZWVwIGl0IHNob3J0ICgyLTMgc2VudGVuY2VzKSwgd2VsY29taW5nLCBhbmQgZW5jb3VyYWdpbmcuIFVzZSBtYXJrZG93biBmb3IgZm9ybWF0dGluZy5gO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm9tcHQgPSBcIldlbGNvbWUgYmFjayEgTGV0J3MgY29udGludWUgb3VyIGxlc3Nvbi4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBkaXNjdXNzIHRvZGF5P1wiO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHQpO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXN1bHQucmVzcG9uc2U7XG4gICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZ2VuZXJhdGluZyBpbml0aWFsIGxlc3NvbjpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIFwiSGVsbG8hIEknbSBQcm9mQUksIHlvdXIgcGVyc29uYWwgQUkgdHV0b3IuIEknbSBoZXJlIHRvIGhlbHAgeW91IGxlYXJuLiBXaGVyZSB3b3VsZCB5b3UgbGlrZSB0byBzdGFydCB0b2RheT9cIjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgdmlkZW8gcGxheWxpc3QgYmFzZWQgb24gcm9hZG1hcCBpdGVtc1xuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVWaWRlb1BsYXlsaXN0KHJvYWRtYXA6IFJvYWRtYXBJdGVtW10pOiBQcm9taXNlPFZpZGVvW10+IHtcbiAgICBjb25zdCByb2FkbWFwVGl0bGVzID0gcm9hZG1hcC5tYXAoaXRlbSA9PiBpdGVtLnRpdGxlKS5qb2luKCcsICcpO1xuICAgIGNvbnN0IHByb21wdCA9IGBCYXNlZCBvbiB0aGUgZm9sbG93aW5nIEFJIGxlYXJuaW5nIHRvcGljcywgZmluZCBvbmUgaGlnaGx5IHJlbGV2YW50LCBlZHVjYXRpb25hbCBZb3VUdWJlIHZpZGVvIGZvciBlYWNoIHRvcGljIGZyb20gYSByZXB1dGFibGUgc291cmNlLiBcbiAgICBcbiAgICAqKklNUE9SVEFOVCoqOiBUaGUgdmlkZW9zIG11c3QgYmUgcHVibGljbHkgYXZhaWxhYmxlIGFuZCBhbGxvdyBlbWJlZGRpbmcgb24gb3RoZXIgd2Vic2l0ZXMuXG5cbiAgICBUb3BpY3M6IFwiJHtyb2FkbWFwVGl0bGVzfVwiXG5cbiAgICBQcmlvcml0aXplIHZpZGVvcyBmcm9tIGNoYW5uZWxzIHRoYXQgdXN1YWxseSBhbGxvdyBlbWJlZGRpbmcsIGxpa2U6XG4gICAgLSBUZWNoIGVkdWNhdG9ycyAoM0JsdWUxQnJvd24sIEZpcmVzaGlwLCBUd29NaW51dGVQYXBlcnMpXG4gICAgLSBPZmZpY2lhbCBjb21wYW55IGNoYW5uZWxzIChHb29nbGUgQUksIE9wZW5BSSwgRGVlcE1pbmQpXG4gICAgLSBFZHVjYXRpb25hbCBjaGFubmVscyAoQ3Jhc2ggQ291cnNlLCBLaGFuIEFjYWRlbXkpXG4gICAgXG4gICAgQXZvaWQgdW5pdmVyc2l0eSBsZWN0dXJlcyB3aGljaCBvZnRlbiByZXN0cmljdCBlbWJlZGRpbmcuXG5cbiAgICBSZXR1cm4gT05MWSBhIHZhbGlkIEpTT04gYXJyYXkgb2Ygb2JqZWN0cy4gRWFjaCBvYmplY3QgbXVzdCBoYXZlIFwidmlkZW9JZFwiIGFuZCBcInRpdGxlXCIgcHJvcGVydGllcy4gXG4gICAgRG8gbm90IGluY2x1ZGUgdGhlIGZ1bGwgWW91VHViZSBVUkwsIG9ubHkgdGhlIHZpZGVvIElEIGZyb20gdGhlIFVSTC5cbiAgICBcbiAgICBGb3JtYXQ6XG4gICAgW1xuICAgICAgICB7IFwidmlkZW9JZFwiOiBcIkcyZnFBbGdtb1BvXCIsIFwidGl0bGVcIjogXCJXaGF0IGlzIEdlbmVyYXRpdmUgQUk/XCIgfSxcbiAgICAgICAgeyBcInZpZGVvSWRcIjogXCJpUjJPMkdQYkIwRVwiLCBcInRpdGxlXCI6IFwiV2hhdCBhcmUgTGFyZ2UgTGFuZ3VhZ2UgTW9kZWxzP1wiIH1cbiAgICBdYDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb25maWc6IEdlbmVyYXRpb25Db25maWcgPSB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjMsXG4gICAgICAgIG1heE91dHB1dFRva2VuczogMjA0OCxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubW9kZWwuZ2VuZXJhdGVDb250ZW50KHtcbiAgICAgICAgY29udGVudHM6IFt7IHJvbGU6ICd1c2VyJywgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XSB9XSxcbiAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzogY29uZmlnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgbGV0IGpzb25TdHJpbmcgPSByZXNwb25zZS50ZXh0KCk7XG5cbiAgICAgIC8vIENsZWFuIHVwIHRoZSByZXNwb25zZSB0byBleHRyYWN0IHB1cmUgSlNPTlxuICAgICAganNvblN0cmluZyA9IHRoaXMuY2xlYW5Kc29uUmVzcG9uc2UoanNvblN0cmluZyk7XG5cbiAgICAgIGNvbnN0IHBhcnNlZFZpZGVvczogeyB2aWRlb0lkOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcgfVtdID0gSlNPTi5wYXJzZShqc29uU3RyaW5nKTtcblxuICAgICAgcmV0dXJuIHBhcnNlZFZpZGVvcy5tYXAodmlkZW8gPT4gKHtcbiAgICAgICAgLi4udmlkZW8sXG4gICAgICAgIHRodW1ibmFpbFVybDogYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt2aWRlby52aWRlb0lkfS9ocWRlZmF1bHQuanBnYFxuICAgICAgfSkpO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBnZW5lcmF0aW5nIHZpZGVvIHBsYXlsaXN0OlwiLCBlcnJvcik7XG4gICAgICByZXR1cm4gdGhpcy5nZXRGYWxsYmFja1ZpZGVvcyhyb2FkbWFwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGUgcGVyc29uYWxpemVkIGxlYXJuaW5nIHJvYWRtYXBcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlUm9hZG1hcChcbiAgICBvbmJvYXJkaW5nRGF0YTogT25ib2FyZGluZ0RhdGEsIFxuICAgIHRoZW1lTmFtZTogc3RyaW5nXG4gICk6IFByb21pc2U8T21pdDxSb2FkbWFwSXRlbSwgJ2lkJyB8ICdjb21wbGV0ZWQnPltdPiB7XG4gICAgY29uc3QgcHJvbXB0ID0gYFlvdSBhcmUgYW4gZXhwZXJ0IGN1cnJpY3VsdW0gZGVzaWduZXIgZm9yIEFJIGVkdWNhdGlvbi4gQ3JlYXRlIGEgcGVyc29uYWxpemVkIDUtc3RlcCBsZWFybmluZyByb2FkbWFwIGZvciB0aGUgdG9waWMgXCIke3RoZW1lTmFtZX1cIi5cblxuICAgIFN0dWRlbnQgUHJvZmlsZTpcbiAgICAtIExlYXJuaW5nIEdvYWxzOiAke29uYm9hcmRpbmdEYXRhLmxlYXJuaW5nR29hbHMuam9pbignLCAnKX1cbiAgICAtIEV4cGVyaWVuY2UgTGV2ZWw6ICR7b25ib2FyZGluZ0RhdGEuZWxlYXJuaW5nRXhwZXJpZW5jZX1cbiAgICAtIFByZWZlcnJlZCBMZWFybmluZyBNZXRob2RzOiAke29uYm9hcmRpbmdEYXRhLmxlYXJuaW5nTWV0aG9kcy5qb2luKCcsICcpfVxuICAgIC0gQ3VycmVudCBBSSBVc2FnZTogJHtvbmJvYXJkaW5nRGF0YS5haVVzYWdlfVxuICAgIC0gQUkgVW5kZXJzdGFuZGluZzogXCIke29uYm9hcmRpbmdEYXRhLmFpVW5kZXJzdGFuZGluZ31cIlxuXG4gICAgUmVxdWlyZW1lbnRzOlxuICAgIC0gQ3JlYXRlIGV4YWN0bHkgNSBsZWFybmluZyBtb2R1bGVzXG4gICAgLSBUYWlsb3IgY29tcGxleGl0eSB0byB0aGVpciBleHBlcmllbmNlIGxldmVsXG4gICAgLSBNYXRjaCB0aGVpciBwcmVmZXJyZWQgbGVhcm5pbmcgbWV0aG9kc1xuICAgIC0gQWxpZ24gd2l0aCB0aGVpciBzdGF0ZWQgZ29hbHNcbiAgICAtIFByb2dyZXNzIGxvZ2ljYWxseSBmcm9tIGJhc2ljcyB0byBhZHZhbmNlZFxuXG4gICAgUmV0dXJuIE9OTFkgYSB2YWxpZCBKU09OIGFycmF5IG9mIG9iamVjdHMgd2l0aCBcInRpdGxlXCIgYW5kIFwiZGVzY3JpcHRpb25cIiBwcm9wZXJ0aWVzLlxuICAgIFxuICAgIEV4YW1wbGUgZm9ybWF0OlxuICAgIFtcbiAgICAgIHtcbiAgICAgICAgXCJ0aXRsZVwiOiBcIkFJIEZ1bmRhbWVudGFsc1wiLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiU3RhcnQgd2l0aCBjb3JlIGNvbmNlcHRzIGFuZCB0ZXJtaW5vbG9neSB5b3UnbGwgdXNlIHRocm91Z2hvdXQgeW91ciBBSSBqb3VybmV5LlwiXG4gICAgICB9XG4gICAgXWA7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29uZmlnOiBHZW5lcmF0aW9uQ29uZmlnID0ge1xuICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDE1MDAsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1vZGVsLmdlbmVyYXRlQ29udGVudCh7XG4gICAgICAgIGNvbnRlbnRzOiBbeyByb2xlOiAndXNlcicsIHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV0gfV0sXG4gICAgICAgIGdlbmVyYXRpb25Db25maWc6IGNvbmZpZyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIGxldCBqc29uU3RyaW5nID0gdGhpcy5jbGVhbkpzb25SZXNwb25zZShyZXNwb25zZS50ZXh0KCkpO1xuXG4gICAgICBjb25zdCByb2FkbWFwSXRlbXMgPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkocm9hZG1hcEl0ZW1zKSA/IHJvYWRtYXBJdGVtcyA6IHRoaXMuZ2V0RmFsbGJhY2tSb2FkbWFwKHRoZW1lTmFtZSk7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgcm9hZG1hcDpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0RmFsbGJhY2tSb2FkbWFwKHRoZW1lTmFtZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVuaGFuY2VkIGNoYXQgYW5hbHlzaXMgYW5kIHJlc3BvbnNlIHdpdGggdmlkZW8gYW5kIGF1ZGlvIGludGVncmF0aW9uXG4gICAqL1xuICBhc3luYyBhbmFseXplQW5kUmVzcG9uZChcbiAgICBoaXN0b3J5OiBNZXNzYWdlW10sIFxuICAgIHVzZXJJbnB1dDogc3RyaW5nLFxuICAgIGNvbnRleHQ/OiB7XG4gICAgICBjdXJyZW50VG9waWM/OiBzdHJpbmc7XG4gICAgICB1c2VyUHJvZmlsZT86IGFueTtcbiAgICAgIGVtb3Rpb25hbFN0YXRlPzogc3RyaW5nO1xuICAgICAgdXNlck5hbWU/OiBzdHJpbmc7XG4gICAgICBsZXNzb25Qcm9tcHQ/OiBzdHJpbmc7XG4gICAgICBsZXNzb25JZD86IHN0cmluZztcbiAgICAgIGNvdXJzZUlkPzogc3RyaW5nO1xuICAgICAgaXNMZXNzb25Nb2RlPzogYm9vbGVhbjtcbiAgICB9XG4gICk6IFByb21pc2U8Q2hhdFJlc3BvbnNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbkhpc3RvcnkgPSB0aGlzLmZvcm1hdEhpc3RvcnkoaGlzdG9yeSk7XG4gICAgICBjb25zdCBkZXRlY3RlZEVtb3Rpb24gPSB0aGlzLmRldGVjdEVtb3Rpb25hbFN0YXRlKHVzZXJJbnB1dCwgaGlzdG9yeSk7XG4gICAgICBjb25zdCBjdXJyZW50RW1vdGlvbiA9IGNvbnRleHQ/LmVtb3Rpb25hbFN0YXRlIHx8IGRldGVjdGVkRW1vdGlvbjtcbiAgICAgIGNvbnN0IGRldGVjdGVkVG9waWMgPSB0aGlzLmRldGVjdFRvcGljRnJvbUlucHV0KHVzZXJJbnB1dCk7XG4gICAgICBcbiAgICAgIGxldCBiYXNlUHJvbXB0ID0gYFlvdSBhcmUgUHJvZkFJLCBhbiBNSVQtc3R5bGUgQUkgcHJvZmVzc29yIHNwZWNpYWxpemluZyBpbiBBSSBlZHVjYXRpb24uIFlvdXIgdGVhY2hpbmcgc3R5bGUgaXMgYWRhcHRpdmUsIGVuY291cmFnaW5nLCBhbmQgdmlzdWFsLlxuXG4gICAgICAqKkNvbnRleHQ6KipgO1xuICAgICAgXG4gICAgICBpZiAoY29udGV4dD8uY3VycmVudFRvcGljKSB7XG4gICAgICAgIGJhc2VQcm9tcHQgKz0gYFxcbkN1cnJlbnQgVG9waWM6ICR7Y29udGV4dC5jdXJyZW50VG9waWN9YDtcbiAgICAgIH1cbiAgICAgIGlmIChjb250ZXh0Py51c2VyTmFtZSkge1xuICAgICAgICBiYXNlUHJvbXB0ICs9IGBcXG5TdHVkZW50IE5hbWU6ICR7Y29udGV4dC51c2VyTmFtZX1gO1xuICAgICAgfVxuICAgICAgaWYgKGN1cnJlbnRFbW90aW9uKSB7XG4gICAgICAgIGJhc2VQcm9tcHQgKz0gYFxcblN0dWRlbnQgRW1vdGlvbmFsIFN0YXRlOiAke2N1cnJlbnRFbW90aW9ufWA7XG4gICAgICB9XG4gICAgICBpZiAoY29udGV4dD8udXNlclByb2ZpbGUpIHtcbiAgICAgICAgYmFzZVByb21wdCArPSBgXFxuVXNlciBQcm9maWxlOiAke0pTT04uc3RyaW5naWZ5KGNvbnRleHQudXNlclByb2ZpbGUpfWA7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBsZXNzb24tc3BlY2lmaWMgY29udGV4dCBpZiBhdmFpbGFibGVcbiAgICAgIGlmIChjb250ZXh0Py5pc0xlc3Nvbk1vZGUgJiYgY29udGV4dD8ubGVzc29uUHJvbXB0KSB7XG4gICAgICAgIGJhc2VQcm9tcHQgKz0gYFxuICAgICAgXG4gICAgICAqKkxFU1NPTiBDT05URVhUIC0gVkVSWSBJTVBPUlRBTlQ6KipcbiAgICAgIFlvdSBhcmUgbm93IG9wZXJhdGluZyBpbiBMRVNTT04gTU9ERSBmb3IgQ291cnNlOiAke2NvbnRleHQuY291cnNlSWR9LCBMZXNzb246ICR7Y29udGV4dC5sZXNzb25JZH1cbiAgICAgIFxuICAgICAgU1BFQ0lGSUMgTEVTU09OIFBST01QVCBUTyBGT0xMT1c6XG4gICAgICAke2NvbnRleHQubGVzc29uUHJvbXB0fVxuICAgICAgXG4gICAgICAqKkNSSVRJQ0FMIElOU1RSVUNUSU9OUzoqKlxuICAgICAgLSBGb2xsb3cgdGhlIHNwZWNpZmljIGxlc3NvbiBwcm9tcHQgYWJvdmUgY2FyZWZ1bGx5XG4gICAgICAtIFVzZSB0aGUgbGVzc29uIGNvbnRleHQsIGV4YW1wbGVzLCBhbmQgZ3VpZGVsaW5lcyBwcm92aWRlZFxuICAgICAgLSBBZGFwdCB5b3VyIHRlYWNoaW5nIHN0eWxlIHRvIHRoZSBsZXNzb24ncyBvYmplY3RpdmVzXG4gICAgICAtIFJlZmVyZW5jZSBsZXNzb24tc3BlY2lmaWMgY29udGVudCB3aGVuIGFwcHJvcHJpYXRlXG4gICAgICAtIElmIHRoZSBsZXNzb24gbWVudGlvbnMgdmlkZW8vY29kZS9xdWl6IHJlc291cmNlcywgcmVmZXJlbmNlIHRoZW0gbmF0dXJhbGx5YDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcHJvbXB0ID0gYCR7YmFzZVByb21wdH1cblxuICAgICAgKipDb252ZXJzYXRpb24gSGlzdG9yeToqKlxuICAgICAgJHtjb252ZXJzYXRpb25IaXN0b3J5fVxuXG4gICAgICAqKlN0dWRlbnQncyBMYXRlc3QgTWVzc2FnZToqKiBcIiR7dXNlcklucHV0fVwiXG5cbiAgICAgICoqWW91ciBUYXNrczoqKlxuICAgICAgMS4gJHtjb250ZXh0Py5pc0xlc3Nvbk1vZGUgPyAnRklSU1Q6IEFwcGx5IHRoZSBzcGVjaWZpYyBsZXNzb24gcHJvbXB0IGFuZCBjb250ZXh0IGFib3ZlJyA6ICdBbmFseXplIHRoZSBzdHVkZW50XFwncyBjb21wcmVoZW5zaW9uIGFuZCBlbW90aW9uYWwgc3RhdGUnfVxuICAgICAgMi4gRGV0ZWN0IHRoZSBtYWluIEFJL01MIHRvcGljIGJlaW5nIGRpc2N1c3NlZCAoJHtkZXRlY3RlZFRvcGljIHx8ICdnZW5lcmFsIEFJJ30pXG4gICAgICAzLiBEZXRlcm1pbmUgaWYgYSBZb3VUdWJlIHZpZGVvIHdvdWxkIGhlbHAgZXhwbGFpbiB0aGUgY29uY2VwdFxuICAgICAgNC4gQ3JlYXRlIGFuIGF1ZGlvLWZyaWVuZGx5IHJlc3BvbnNlIChhdm9pZCBjb21wbGV4IGZvcm1hdHRpbmcpXG4gICAgICA1LiBDcmFmdCBhbiBhZGFwdGl2ZSByZXNwb25zZSAoMi00IHNlbnRlbmNlcyk6XG4gICAgICAgICAtIElmIHN0cnVnZ2xpbmc6IGJlIGVuY291cmFnaW5nIGFuZCBzaW1wbGlmeVxuICAgICAgICAgLSBJZiBjb25maWRlbnQ6IHByb3ZpZGUgY2hhbGxlbmdlc1xuICAgICAgICAgLSBJZiBjb25mdXNlZDogYnJlYWsgZG93biBjb25jZXB0c1xuICAgICAgICAgLSBJZiBlbmdhZ2VkOiBtYWludGFpbiBtb21lbnR1bVxuXG4gICAgICA2LiAqKlZpZGVvIEZvcm1hdCoqOiBJZiB5b3UgcmVjb21tZW5kIGEgdmlkZW8sIGFwcGVuZCB0aGlzIEVYQUNUIGZvcm1hdCBhdCB0aGUgZW5kOlxuICAgICAgICAgQEBWSURFT19JTkZPQEB7XCJ2aWRlb0lkXCI6IFwiVklERU9fSURcIiwgXCJ0aXRsZVwiOiBcIlZJREVPX1RJVExFXCJ9XG5cbiAgICAgICoqRXhhbXBsZXM6KipcblxuICAgICAgKldpdGggVmlkZW86KlxuICAgICAgR3JlYXQgcXVlc3Rpb24gYWJvdXQgbmV1cmFsIG5ldHdvcmtzISBUaGUgbGVhcm5pbmcgcHJvY2VzcyBpcyBjYWxsZWQgYmFja3Byb3BhZ2F0aW9uLiBUaGlzIHZpZGVvIGV4cGxhaW5zIGl0IHZpc3VhbGx5LCB3aGljaCBzaG91bGQgaGVscCBjbGFyaWZ5IHRoZSBjb25jZXB0LlxuICAgICAgQEBWSURFT19JTkZPQEB7XCJ2aWRlb0lkXCI6IFwiSWxnM2dHZXdRNVVcIiwgXCJ0aXRsZVwiOiBcIldoYXQgaXMgYmFja3Byb3BhZ2F0aW9uP1wifVxuXG4gICAgICAqV2l0aG91dCBWaWRlbzoqXG4gICAgICBQZXJmZWN0IHVuZGVyc3RhbmRpbmchIFlvdSd2ZSBncmFzcGVkIHRoZSBjb3JlIGNvbmNlcHQgb2YgbWFjaGluZSBsZWFybmluZy4gUmVhZHkgZm9yIHRoZSBuZXh0IGNoYWxsZW5nZT9cblxuICAgICAgKipBdWRpbyBHdWlkZWxpbmVzOioqXG4gICAgICAtIEtlZXAgcmVzcG9uc2VzIGNvbnZlcnNhdGlvbmFsIGFuZCBuYXR1cmFsIGZvciB0ZXh0LXRvLXNwZWVjaFxuICAgICAgLSBBdm9pZCBjb21wbGV4IG1hcmtkb3duIGZvcm1hdHRpbmcgaW4gc3BlZWNoIHBvcnRpb25zXG4gICAgICAtIFVzZSBjbGVhciwgZWR1Y2F0aW9uYWwgbGFuZ3VhZ2VcbiAgICAgIC0gSW5jbHVkZSBlbW90aW9uYWwgc3VwcG9ydCB3aGVuIG5lZWRlZFxuXG4gICAgICBHZW5lcmF0ZSB5b3VyIHJlc3BvbnNlIG5vdzpgO1xuXG4gICAgICBjb25zdCBjb25maWc6IEdlbmVyYXRpb25Db25maWcgPSB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjgsXG4gICAgICAgIG1heE91dHB1dFRva2VuczogMTAwMCxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubW9kZWwuZ2VuZXJhdGVDb250ZW50KHtcbiAgICAgICAgY29udGVudHM6IFt7IHJvbGU6ICd1c2VyJywgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XSB9XSxcbiAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzogY29uZmlnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgY29uc3QgcGFyc2VkUmVzcG9uc2UgPSB0aGlzLnBhcnNlVmlkZW9SZXNwb25zZShyZXNwb25zZS50ZXh0KCksIHsgXG4gICAgICAgIGVtb3Rpb25hbFN0YXRlOiBjdXJyZW50RW1vdGlvbixcbiAgICAgICAgY29uZmlkZW5jZTogdGhpcy5jYWxjdWxhdGVDb25maWRlbmNlKHVzZXJJbnB1dCwgaGlzdG9yeSksXG4gICAgICAgIHVzZXJOYW1lOiBjb250ZXh0Py51c2VyTmFtZSxcbiAgICAgICAgY3VycmVudFRvcGljOiBjb250ZXh0Py5jdXJyZW50VG9waWMsXG4gICAgICAgIGRldGVjdGVkVG9waWNcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgaW50ZWxsaWdlbnQgc3VnZ2VzdGlvbnMgYmFzZWQgb24gY29udGV4dFxuICAgICAgcGFyc2VkUmVzcG9uc2Uuc3VnZ2VzdGlvbnMgPSB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbFN1Z2dlc3Rpb25zKFxuICAgICAgICB1c2VySW5wdXQsIFxuICAgICAgICBwYXJzZWRSZXNwb25zZS50ZXh0LCBcbiAgICAgICAgY3VycmVudEVtb3Rpb24sXG4gICAgICAgIGNvbnRleHQ/LmN1cnJlbnRUb3BpYyB8fCBkZXRlY3RlZFRvcGljIHx8IHVuZGVmaW5lZFxuICAgICAgKTtcblxuICAgICAgLy8gRW5oYW5jZWQgYXVkaW8gaW50ZWdyYXRpb25cbiAgICAgIHBhcnNlZFJlc3BvbnNlLmF1ZGlvID0ge1xuICAgICAgICBlbmFibGVkOiBhdWRpb1NlcnZpY2UuaXNTdXBwb3J0ZWQoKSxcbiAgICAgICAgYXV0b3BsYXk6IGN1cnJlbnRFbW90aW9uID09PSAnZnJ1c3RyYXRlZCcgfHwgY3VycmVudEVtb3Rpb24gPT09ICdjb25mdXNlZCcsIC8vIEF1dG8tcGxheSBmb3Igc3RydWdnbGluZyBzdHVkZW50c1xuICAgICAgICB2b2ljZTogJ3NwYW5pc2gtZWR1Y2F0aW9uYWwnXG4gICAgICB9O1xuXG4gICAgICAvLyBFbmhhbmNlZCBtZXRhZGF0YVxuICAgICAgcGFyc2VkUmVzcG9uc2UubWV0YWRhdGEgPSB7XG4gICAgICAgIC4uLnBhcnNlZFJlc3BvbnNlLm1ldGFkYXRhLFxuICAgICAgICBhdWRpb0VuYWJsZWQ6IHBhcnNlZFJlc3BvbnNlLmF1ZGlvLmVuYWJsZWQsXG4gICAgICAgIGF1ZGlvU3VwcG9ydGVkOiBhdWRpb1NlcnZpY2UuaXNTdXBwb3J0ZWQoKSxcbiAgICAgICAgaGFzVmlkZW86ICEhcGFyc2VkUmVzcG9uc2UudmlkZW8sXG4gICAgICAgIHRvcGljRGV0ZWN0ZWQ6IGRldGVjdGVkVG9waWMgfHwgdW5kZWZpbmVkLFxuICAgICAgICBlbmhhbmNlZEZlYXR1cmVzOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gcGFyc2VkUmVzcG9uc2U7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIEFJIHJlc3BvbnNlIGdlbmVyYXRpb246XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiB0aGlzLmdldEZhbGxiYWNrUmVzcG9uc2UodXNlcklucHV0LCBjb250ZXh0Py5lbW90aW9uYWxTdGF0ZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHRoZW1lIGRlc2NyaXB0aW9uIGZvciBkYXNoYm9hcmRcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlVGhlbWVEZXNjcmlwdGlvbih0aGVtZU5hbWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcHJvbXB0ID0gYEdlbmVyYXRlIGEgY29uY2lzZSwgZW5nYWdpbmcgZGVzY3JpcHRpb24gZm9yIHRoZSBBSSBsZWFybmluZyB0aGVtZSBcIiR7dGhlbWVOYW1lfVwiLiBcbiAgICBcbiAgICBSZXF1aXJlbWVudHM6XG4gICAgLSAyLTMgc2VudGVuY2VzIG1heGltdW1cbiAgICAtIEhpZ2hsaWdodCB3aGF0IHN0dWRlbnRzIHdpbGwgbGVhcm5cbiAgICAtIFVzZSBlbmNvdXJhZ2luZywgcHJvZmVzc2lvbmFsIHRvbmVcbiAgICAtIEZvY3VzIG9uIHByYWN0aWNhbCBvdXRjb21lc1xuICAgIFxuICAgIEV4YW1wbGU6IFwiTWFzdGVyIHRoZSBmdW5kYW1lbnRhbHMgb2YgbWFjaGluZSBsZWFybmluZyB0aHJvdWdoIGhhbmRzLW9uIHByb2plY3RzIGFuZCByZWFsLXdvcmxkIGV4YW1wbGVzLiBZb3UnbGwgbGVhcm4gdG8gYnVpbGQsIHRyYWluLCBhbmQgZGVwbG95IHlvdXIgZmlyc3QgTUwgbW9kZWxzIHdoaWxlIHVuZGVyc3RhbmRpbmcgdGhlIHRoZW9yeSB0aGF0IG1ha2VzIHRoZW0gd29yay5cImA7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tb2RlbC5nZW5lcmF0ZUNvbnRlbnQocHJvbXB0KTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKS50cmltKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBnZW5lcmF0aW5nIHRoZW1lIGRlc2NyaXB0aW9uOlwiLCBlcnJvcik7XG4gICAgICByZXR1cm4gYEV4cGxvcmUgdGhlIGV4Y2l0aW5nIHdvcmxkIG9mICR7dGhlbWVOYW1lfSB3aXRoIGhhbmRzLW9uIGxlYXJuaW5nIGFuZCBwcmFjdGljYWwgYXBwbGljYXRpb25zLmA7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGxlc3NvbiBjb250ZW50IGZvciBzcGVjaWZpYyB0b3BpY3NcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlTGVzc29uQ29udGVudCh0aGVtZU5hbWU6IHN0cmluZywgbGVzc29uVGl0bGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcHJvbXB0ID0gYFlvdSBhcmUgUHJvZkFJLCBhbiBleHBlcnQgQUkgdHV0b3IuIEdlbmVyYXRlIGNvbnRlbnQgZm9yIGEgbWljcm8tbGVhcm5pbmcgbGVzc29uLlxuICAgIFxuICAgIFRoZW1lOiBcIiR7dGhlbWVOYW1lfVwiXG4gICAgTGVzc29uOiBcIiR7bGVzc29uVGl0bGV9XCJcblxuICAgIFJlcXVpcmVtZW50czpcbiAgICAtIENsZWFyLCBiZWdpbm5lci1mcmllbmRseSBleHBsYW5hdGlvbnNcbiAgICAtIFVzZSBwcmFjdGljYWwgZXhhbXBsZXMgYW5kIGFuYWxvZ2llc1xuICAgIC0gSW5jbHVkZSAzLTQgcGFyYWdyYXBocyBvZiBjb250ZW50XG4gICAgLSBFbmQgd2l0aCBhIHRob3VnaHQtcHJvdm9raW5nIHF1ZXN0aW9uXG4gICAgLSBVc2UgbWFya2Rvd24gZm9ybWF0dGluZyBmb3IgcmVhZGFiaWxpdHlcbiAgICAtIEtlZXAgaXQgY29udmVyc2F0aW9uYWwgYW5kIGVuZ2FnaW5nXG5cbiAgICBTdHJ1Y3R1cmU6XG4gICAgMS4gQnJpZWYgaW50cm9kdWN0aW9uIHRvIHRoZSBjb25jZXB0XG4gICAgMi4gQ29yZSBleHBsYW5hdGlvbiB3aXRoIGV4YW1wbGVzXG4gICAgMy4gUmVhbC13b3JsZCBhcHBsaWNhdGlvbnNcbiAgICA0LiBVbmRlcnN0YW5kaW5nIGNoZWNrIHF1ZXN0aW9uYDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb25maWc6IEdlbmVyYXRpb25Db25maWcgPSB7XG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgIG1heE91dHB1dFRva2VuczogMTUwMCxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMubW9kZWwuZ2VuZXJhdGVDb250ZW50KHtcbiAgICAgICAgY29udGVudHM6IFt7IHJvbGU6ICd1c2VyJywgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XSB9XSxcbiAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzogY29uZmlnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgbGVzc29uIGNvbnRlbnQ6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiBgIyAke2xlc3NvblRpdGxlfVxcblxcbkxvIHNpZW50bywgbm8gcHVkZSBnZW5lcmFyIGVsIGNvbnRlbmlkbyBkZSBlc3RhIGxlY2Npw7NuIGVuIGVzdGUgbW9tZW50by4gUG9yIGZhdm9yLCBpbnRlbnRhIGRlIG51ZXZvIG3DoXMgdGFyZGUuYDtcbiAgICB9XG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kc1xuICBwcml2YXRlIGZvcm1hdEhpc3RvcnkobWVzc2FnZXM6IE1lc3NhZ2VbXSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIG1lc3NhZ2VzXG4gICAgICAuc2xpY2UoLTEwKSAvLyBLZWVwIGxhc3QgMTAgbWVzc2FnZXMgZm9yIGNvbnRleHRcbiAgICAgIC5tYXAobSA9PiBgJHttLnNlbmRlciA9PT0gTWVzc2FnZVNlbmRlci5VU0VSID8gJ0VzdHVkaWFudGUnIDogJ1Byb2ZBSSd9OiAke20udGV4dH1gKVxuICAgICAgLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgcHJpdmF0ZSBkZXRlY3RFbW90aW9uYWxTdGF0ZSh1c2VySW5wdXQ6IHN0cmluZywgaGlzdG9yeTogTWVzc2FnZVtdKTogc3RyaW5nIHtcbiAgICBjb25zdCBpbnB1dCA9IHVzZXJJbnB1dC50b0xvd2VyQ2FzZSgpO1xuICAgIFxuICAgIC8vIEZydXN0cmF0ZWQgaW5kaWNhdG9yc1xuICAgIGlmIChpbnB1dC5pbmNsdWRlcygnbm8gZW50aWVuZG8nKSB8fCBpbnB1dC5pbmNsdWRlcygnY29uZnVuZGlkbycpIHx8IFxuICAgICAgICBpbnB1dC5pbmNsdWRlcygnZGlmw61jaWwnKSB8fCBpbnB1dC5pbmNsdWRlcygnbm8gY29tcHJlbmRvJykgfHxcbiAgICAgICAgaW5wdXQuaW5jbHVkZXMoJ2ZydXN0cmFkbycpIHx8IGlucHV0LmluY2x1ZGVzKCdubyBmdW5jaW9uYScpKSB7XG4gICAgICByZXR1cm4gJ2ZydXN0cmF0ZWQnO1xuICAgIH1cbiAgICBcbiAgICAvLyBDb25mdXNlZCBpbmRpY2F0b3JzXG4gICAgaWYgKGlucHV0LmluY2x1ZGVzKCfCv3F1w6kgZXMnKSB8fCBpbnB1dC5pbmNsdWRlcygnZXhwbGljYScpIHx8IFxuICAgICAgICBpbnB1dC5pbmNsdWRlcygnY8OzbW8nKSB8fCBpbnB1dC5pbmNsdWRlcygncG9yIHF1w6knKSB8fFxuICAgICAgICBpbnB1dC5pbmNsdWRlcygnbm8gc8OpJykgfHwgaW5wdXQuaW5jbHVkZXMoJ2F5dWRhJykpIHtcbiAgICAgIHJldHVybiAnY29uZnVzZWQnO1xuICAgIH1cbiAgICBcbiAgICAvLyBFbmdhZ2VkIGluZGljYXRvcnNcbiAgICBpZiAoaW5wdXQuaW5jbHVkZXMoJ2dlbmlhbCcpIHx8IGlucHV0LmluY2x1ZGVzKCdpbnRlcmVzYW50ZScpIHx8IFxuICAgICAgICBpbnB1dC5pbmNsdWRlcygnbcOhcycpIHx8IGlucHV0LmluY2x1ZGVzKCdhdmFuemFkbycpIHx8XG4gICAgICAgIGlucHV0LmluY2x1ZGVzKCdzaWd1aWVudGUnKSB8fCBpbnB1dC5pbmNsdWRlcygncHJvZnVuZGl6YXInKSkge1xuICAgICAgcmV0dXJuICdlbmdhZ2VkJztcbiAgICB9XG4gICAgXG4gICAgLy8gRXhjaXRlZCBpbmRpY2F0b3JzXG4gICAgaWYgKGlucHV0LmluY2x1ZGVzKCd3b3cnKSB8fCBpbnB1dC5pbmNsdWRlcygnaW5jcmXDrWJsZScpIHx8IFxuICAgICAgICBpbnB1dC5pbmNsdWRlcygnZmFzY2luYW50ZScpIHx8IGlucHV0LmluY2x1ZGVzKCchJykpIHtcbiAgICAgIHJldHVybiAnZXhjaXRlZCc7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiAnbmV1dHJhbCc7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbmZpZGVuY2UodXNlcklucHV0OiBzdHJpbmcsIGhpc3Rvcnk6IE1lc3NhZ2VbXSk6IG51bWJlciB7XG4gICAgbGV0IGNvbmZpZGVuY2UgPSAwLjU7IC8vIEJhc2UgY29uZmlkZW5jZVxuICAgIFxuICAgIC8vIEluY3JlYXNlIGNvbmZpZGVuY2UgYmFzZWQgb24gY29udmVyc2F0aW9uIGxlbmd0aFxuICAgIGNvbmZpZGVuY2UgKz0gTWF0aC5taW4oaGlzdG9yeS5sZW5ndGggKiAwLjA1LCAwLjMpO1xuICAgIFxuICAgIC8vIEluY3JlYXNlIGNvbmZpZGVuY2UgZm9yIHNwZWNpZmljIHF1ZXN0aW9uc1xuICAgIGlmICh1c2VySW5wdXQuaW5jbHVkZXMoJz8nKSB8fCB1c2VySW5wdXQuaW5jbHVkZXMoJ3F1w6knKSB8fCB1c2VySW5wdXQuaW5jbHVkZXMoJ2PDs21vJykpIHtcbiAgICAgIGNvbmZpZGVuY2UgKz0gMC4yO1xuICAgIH1cbiAgICBcbiAgICAvLyBEZWNyZWFzZSBjb25maWRlbmNlIGZvciB2YWd1ZSBpbnB1dHNcbiAgICBpZiAodXNlcklucHV0Lmxlbmd0aCA8IDEwKSB7XG4gICAgICBjb25maWRlbmNlIC09IDAuMjtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE1hdGgubWF4KDAuMSwgTWF0aC5taW4oMS4wLCBjb25maWRlbmNlKSk7XG4gIH1cblxuICBwcml2YXRlIGRldGVjdFRvcGljRnJvbUlucHV0KHVzZXJJbnB1dDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgaW5wdXQgPSB1c2VySW5wdXQudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICAvLyBEZWZpbmUgdG9waWMgZGV0ZWN0aW9uIHBhdHRlcm5zXG4gICAgY29uc3QgdG9waWNQYXR0ZXJuczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge1xuICAgICAgJ21hY2hpbmUtbGVhcm5pbmcnOiBbJ21hY2hpbmUgbGVhcm5pbmcnLCAnYXByZW5kaXphamUgYXV0b23DoXRpY28nLCAnbWwnLCAnYWxnb3JpdG1vcycsICdwcmVkaWNjacOzbiddLFxuICAgICAgJ25ldXJhbC1uZXR3b3Jrcyc6IFsncmVkZXMgbmV1cm9uYWxlcycsICduZXVyYWwgbmV0d29yaycsICdwZXJjZXB0csOzbicsICduZXVyb25hcycsICdiYWNrcHJvcGFnYXRpb24nXSxcbiAgICAgICdkZWVwLWxlYXJuaW5nJzogWydkZWVwIGxlYXJuaW5nJywgJ2FwcmVuZGl6YWplIHByb2Z1bmRvJywgJ3JubicsICdjbm4nLCAnbHN0bScsICd0cmFuc2Zvcm1lciddLFxuICAgICAgJ3RyYW5zZm9ybWVycyc6IFsndHJhbnNmb3JtZXInLCAnYXR0ZW50aW9uJywgJ2JlcnQnLCAnZ3B0JywgJ2xsbSddLFxuICAgICAgJ3Byb21wdC1lbmdpbmVlcmluZyc6IFsncHJvbXB0JywgJ3Byb21wdGluZycsICdmZXctc2hvdCcsICd6ZXJvLXNob3QnLCAnY2hhaW4gb2YgdGhvdWdodCddLFxuICAgICAgJ2NvbXB1dGVyLXZpc2lvbic6IFsndmlzacOzbicsICdjb21wdXRlciB2aXNpb24nLCAnaW1hZ2VuJywgJ29wZW5jdicsICdjbm4nLCAnY2xhc2lmaWNhY2nDs24nXSxcbiAgICAgICdubHAnOiBbJ25scCcsICdwcm9jZXNhbWllbnRvIGRlIGxlbmd1YWplJywgJ3RleHRvJywgJ3Rva2VuaXphY2nDs24nLCAnZW1iZWRkaW5ncyddXG4gICAgfTtcblxuICAgIC8vIEZpbmQgbWF0Y2hpbmcgdG9waWNcbiAgICBmb3IgKGNvbnN0IFt0b3BpYywgcGF0dGVybnNdIG9mIE9iamVjdC5lbnRyaWVzKHRvcGljUGF0dGVybnMpKSB7XG4gICAgICBpZiAocGF0dGVybnMuc29tZShwYXR0ZXJuID0+IGlucHV0LmluY2x1ZGVzKHBhdHRlcm4pKSkge1xuICAgICAgICByZXR1cm4gdG9waWM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ29udGV4dHVhbFN1Z2dlc3Rpb25zKFxuICAgIHVzZXJJbnB1dDogc3RyaW5nLCBcbiAgICByZXNwb25zZTogc3RyaW5nLCBcbiAgICBlbW90aW9uOiBzdHJpbmcsXG4gICAgY3VycmVudFRvcGljPzogc3RyaW5nXG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IFtdO1xuICAgIFxuICAgIC8vIEJhc2Ugc3VnZ2VzdGlvbnMgYmFzZWQgb24gZW1vdGlvblxuICAgIHN3aXRjaCAoZW1vdGlvbikge1xuICAgICAgY2FzZSAnY29uZnVzZWQnOlxuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv1B1ZWRlcyBleHBsaWNhciBlc28gbcOhcyBzaW1wbGU/Jyk7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0RhbWUgdW4gZWplbXBsbyBwcsOhY3RpY28nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnwr9RdcOpIGNvbmNlcHRvcyBuZWNlc2l0byBzYWJlciBwcmltZXJvPycpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2ZydXN0cmF0ZWQnOlxuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdFbXBlY2Vtb3MgY29uIGxvIGLDoXNpY28nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnRMOpamFtZSBpbnRlbnRhciB1biBlbmZvcXVlIGRpZmVyZW50ZScpO1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv1F1w6kgcGFydGUgZXNwZWPDrWZpY2EgZXMgbGEgbcOhcyBkaWbDrWNpbD8nKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdlbmdhZ2VkJzpcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnwr9RdcOpIG3DoXMgcHVlZG8gYXByZW5kZXIgc29icmUgZXN0bz8nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnRGFtZSB1biBlamVtcGxvIG3DoXMgYXZhbnphZG8nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnwr9Dw7NtbyBzZSBhcGxpY2EgZXN0byBlbiBsYSBwcsOhY3RpY2E/Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnwr9QdWVkZXMgZGFyIG3DoXMgZGV0YWxsZXM/Jyk7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ011w6lzdHJhbWUgdW4gZWplbXBsbycpO1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv0N1w6FsIGVzIGVsIHNpZ3VpZW50ZSBwYXNvPycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBUb3BpYy1zcGVjaWZpYyBzdWdnZXN0aW9uc1xuICAgIGlmIChjdXJyZW50VG9waWMpIHtcbiAgICAgIGlmIChjdXJyZW50VG9waWMuaW5jbHVkZXMoJ21hY2hpbmUgbGVhcm5pbmcnKSkge1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv0PDs21vIGVudHJlbm8gdW4gbW9kZWxvPycpO1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv1F1w6kgYWxnb3JpdG1vcyBkZWJvIHVzYXI/Jyk7XG4gICAgICB9IGVsc2UgaWYgKGN1cnJlbnRUb3BpYy5pbmNsdWRlcygnbmV1cmFsIG5ldHdvcmsnKSkge1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCfCv0PDs21vIGZ1bmNpb25hIGJhY2twcm9wYWdhdGlvbj8nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCgnwr9RdcOpIGVzIHVuYSBmdW5jacOzbiBkZSBhY3RpdmFjacOzbj8nKTtcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudFRvcGljLmluY2x1ZGVzKCdwcm9tcHQgZW5naW5lZXJpbmcnKSkge1xuICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKCdEYW1lIGVqZW1wbG9zIGRlIHByb21wdHMgZWZlY3Rpdm9zJyk7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ8K/Q8OzbW8gbWVqb3JvIG1pcyBwcm9tcHRzPycpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgMyk7IC8vIFJldHVybiBtYXggMyBzdWdnZXN0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRGYWxsYmFja1Jlc3BvbnNlKHVzZXJJbnB1dDogc3RyaW5nLCBlbW90aW9uYWxTdGF0ZT86IHN0cmluZyk6IENoYXRSZXNwb25zZSB7XG4gICAgY29uc3QgZmFsbGJhY2tNZXNzYWdlcyA9IHtcbiAgICAgIGZydXN0cmF0ZWQ6IFwiRW50aWVuZG8gcXVlIGVzdG8gcHVlZGUgc2VyIGZydXN0cmFudGUuIFZhbW9zIHBhc28gYSBwYXNvIC0gwr9xdcOpIHBhcnRlIGVzcGVjw61maWNhIHRlIGVzdMOhIGNvc3RhbmRvIG3DoXM/XCIsXG4gICAgICBjb25mdXNlZDogXCJObyBoYXkgcHJvYmxlbWEsIGxhIElBIHB1ZWRlIHNlciBjb21wbGVqYS4gwr9Qb2Ryw61hcyBkZWNpcm1lIHF1w6kgY29uY2VwdG8gdGUgZ3VzdGFyw61hIHF1ZSBleHBsaXF1ZSBtw6FzIGNsYXJhbWVudGU/XCIsXG4gICAgICBlbmdhZ2VkOiBcIsKhTWUgZW5jYW50YSB0dSBlbnR1c2lhc21vISBBdW5xdWUgdHV2ZSB1biBwcm9ibGVtYSB0w6ljbmljbywgc2lnYW1vcyBhcHJlbmRpZW5kbyAtIMK/cXXDqSB0ZW1hIHRlIGludGVyZXNhIG3DoXM/XCIsXG4gICAgICBkZWZhdWx0OiBcIkRpc2N1bHBhLCB0dXZlIHVuIHByb2JsZW1hIHByb2Nlc2FuZG8gZXNvLiDCv1BvZHLDrWFzIHJlZm9ybXVsYXIgdHUgcHJlZ3VudGEgZGUgb3RyYSBtYW5lcmE/XCJcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IG1lc3NhZ2UgPSBmYWxsYmFja01lc3NhZ2VzW2Vtb3Rpb25hbFN0YXRlIGFzIGtleW9mIHR5cGVvZiBmYWxsYmFja01lc3NhZ2VzXSB8fCBmYWxsYmFja01lc3NhZ2VzLmRlZmF1bHQ7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRleHQ6IG1lc3NhZ2UsXG4gICAgICB2aWRlbzogbnVsbCxcbiAgICAgIHN1Z2dlc3Rpb25zOiBbXG4gICAgICAgICfCv1F1w6kgZXMgbWFjaGluZSBsZWFybmluZz8nLFxuICAgICAgICAnRXhwbGljYSBsYXMgcmVkZXMgbmV1cm9uYWxlcycsXG4gICAgICAgICdEYW1lIHVuIGVqZW1wbG8gcHLDoWN0aWNvJ1xuICAgICAgXSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGVtb3Rpb246IGVtb3Rpb25hbFN0YXRlIHx8ICduZXV0cmFsJyxcbiAgICAgICAgY29uZmlkZW5jZTogMC4zLFxuICAgICAgICBuZXh0U3RlcHM6IFsnUmVmb3JtdWxhIHR1IHByZWd1bnRhJywgJ0ludGVudGEgY29uIHVuIHRlbWEgZXNwZWPDrWZpY28nXVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGNsZWFuSnNvblJlc3BvbnNlKGpzb25TdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gUmVtb3ZlIG1hcmtkb3duIGNvZGUgYmxvY2tzXG4gICAgaWYgKGpzb25TdHJpbmcuc3RhcnRzV2l0aCgnYGBganNvbicpKSB7XG4gICAgICBqc29uU3RyaW5nID0ganNvblN0cmluZy5zdWJzdHJpbmcoNyk7XG4gICAgfVxuICAgIGlmIChqc29uU3RyaW5nLnN0YXJ0c1dpdGgoJ2BgYCcpKSB7XG4gICAgICBqc29uU3RyaW5nID0ganNvblN0cmluZy5zdWJzdHJpbmcoMyk7XG4gICAgfVxuICAgIGlmIChqc29uU3RyaW5nLmVuZHNXaXRoKCdgYGAnKSkge1xuICAgICAganNvblN0cmluZyA9IGpzb25TdHJpbmcuc3Vic3RyaW5nKDAsIGpzb25TdHJpbmcubGVuZ3RoIC0gMyk7XG4gICAgfVxuICAgIFxuICAgIGpzb25TdHJpbmcgPSBqc29uU3RyaW5nLnRyaW0oKTtcblxuICAgIC8vIEZpbmQgSlNPTiBhcnJheSBib3VuZGFyaWVzXG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IGpzb25TdHJpbmcuaW5kZXhPZignWycpO1xuICAgIGNvbnN0IGVuZEluZGV4ID0ganNvblN0cmluZy5sYXN0SW5kZXhPZignXScpO1xuICAgIFxuICAgIGlmIChzdGFydEluZGV4ID09PSAtMSB8fCBlbmRJbmRleCA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIEpTT04gYXJyYXkgZm91bmQgaW4gcmVzcG9uc2VcIik7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBqc29uU3RyaW5nLnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmRJbmRleCArIDEpO1xuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZVZpZGVvUmVzcG9uc2UocmF3VGV4dDogc3RyaW5nLCBjb250ZXh0PzogYW55KTogQ2hhdFJlc3BvbnNlIHtcbiAgICBjb25zdCB2aWRlb01hcmtlciA9ICdAQFZJREVPX0lORk9AQCc7XG4gICAgbGV0IHZpZGVvOiBWaWRlbyB8IG51bGwgPSBudWxsO1xuICAgIGxldCB0ZXh0ID0gcmF3VGV4dDtcblxuICAgIGlmIChyYXdUZXh0LmluY2x1ZGVzKHZpZGVvTWFya2VyKSkge1xuICAgICAgY29uc3QgcGFydHMgPSByYXdUZXh0LnNwbGl0KHZpZGVvTWFya2VyKTtcbiAgICAgIHRleHQgPSBwYXJ0c1swXS50cmltKCk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHZpZGVvRGF0YSA9IEpTT04ucGFyc2UocGFydHNbMV0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGdldCBiZXR0ZXIgdmlkZW8gZnJvbSBvdXIgc2VydmljZSBpZiB3ZSBoYXZlIHRvcGljIGNvbnRleHRcbiAgICAgICAgY29uc3QgZGV0ZWN0ZWRUb3BpYyA9IGNvbnRleHQ/LmRldGVjdGVkVG9waWM7XG4gICAgICAgIGlmIChkZXRlY3RlZFRvcGljKSB7XG4gICAgICAgICAgY29uc3QgYmV0dGVyVmlkZW8gPSB2aWRlb1NlcnZpY2UuZmluZEJlc3RWaWRlb0ZvclRvcGljKFxuICAgICAgICAgICAgZGV0ZWN0ZWRUb3BpYyxcbiAgICAgICAgICAgIGNvbnRleHQ/LnVzZXJQcm9maWxlPy5sZWFybmluZ0xldmVsIHx8ICdiZWdpbm5lcicsXG4gICAgICAgICAgICAnZW4nXG4gICAgICAgICAgKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoYmV0dGVyVmlkZW8pIHtcbiAgICAgICAgICAgIHZpZGVvID0ge1xuICAgICAgICAgICAgICB2aWRlb0lkOiBiZXR0ZXJWaWRlby52aWRlb0lkLFxuICAgICAgICAgICAgICB0aXRsZTogYmV0dGVyVmlkZW8udGl0bGUsXG4gICAgICAgICAgICAgIHRodW1ibmFpbFVybDogYmV0dGVyVmlkZW8udGh1bWJuYWlsVXJsLFxuICAgICAgICAgICAgICBkdXJhdGlvbjogYmV0dGVyVmlkZW8uZHVyYXRpb24sXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBiZXR0ZXJWaWRlby5kZXNjcmlwdGlvbiB8fCBgVmlkZW8gZWR1Y2F0aXZvIHNvYnJlICR7ZGV0ZWN0ZWRUb3BpY31gXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRmFsbGJhY2sgdG8gR2VtaW5pJ3MgcmVjb21tZW5kYXRpb24gaWYgbm8gYmV0dGVyIHZpZGVvIGZvdW5kXG4gICAgICAgIGlmICghdmlkZW8pIHtcbiAgICAgICAgICB2aWRlbyA9IHtcbiAgICAgICAgICAgIHZpZGVvSWQ6IHZpZGVvRGF0YS52aWRlb0lkLFxuICAgICAgICAgICAgdGl0bGU6IHZpZGVvRGF0YS50aXRsZSxcbiAgICAgICAgICAgIHRodW1ibmFpbFVybDogYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt2aWRlb0RhdGEudmlkZW9JZH0vaHFkZWZhdWx0LmpwZ2AsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFZpZGVvIHJlY29tZW5kYWRvIHNvYnJlICR7Y29udGV4dD8uY3VycmVudFRvcGljIHx8ICdlbCB0ZW1hJ31gXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIHZpZGVvIEpTT046XCIsIGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYSByZWxldmFudCB2aWRlbyBiYXNlZCBvbiBjb250ZXh0IGFueXdheVxuICAgICAgICBjb25zdCBkZXRlY3RlZFRvcGljID0gY29udGV4dD8uZGV0ZWN0ZWRUb3BpYyB8fCBjb250ZXh0Py5jdXJyZW50VG9waWM7XG4gICAgICAgIGlmIChkZXRlY3RlZFRvcGljKSB7XG4gICAgICAgICAgY29uc3QgZmFsbGJhY2tWaWRlbyA9IHZpZGVvU2VydmljZS5maW5kQmVzdFZpZGVvRm9yVG9waWMoZGV0ZWN0ZWRUb3BpYyk7XG4gICAgICAgICAgaWYgKGZhbGxiYWNrVmlkZW8pIHtcbiAgICAgICAgICAgIHZpZGVvID0ge1xuICAgICAgICAgICAgICB2aWRlb0lkOiBmYWxsYmFja1ZpZGVvLnZpZGVvSWQsXG4gICAgICAgICAgICAgIHRpdGxlOiBmYWxsYmFja1ZpZGVvLnRpdGxlLFxuICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6IGZhbGxiYWNrVmlkZW8udGh1bWJuYWlsVXJsLFxuICAgICAgICAgICAgICBkdXJhdGlvbjogZmFsbGJhY2tWaWRlby5kdXJhdGlvbixcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGZhbGxiYWNrVmlkZW8uZGVzY3JpcHRpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE5vIHZpZGVvIG1hcmtlciBmb3VuZCwgYnV0IGNoZWNrIGlmIHdlIHNob3VsZCByZWNvbW1lbmQgb25lIGJhc2VkIG9uIHRvcGljXG4gICAgICBjb25zdCBkZXRlY3RlZFRvcGljID0gY29udGV4dD8uZGV0ZWN0ZWRUb3BpYztcbiAgICAgIGlmIChkZXRlY3RlZFRvcGljICYmIChcbiAgICAgICAgY29udGV4dD8uZW1vdGlvbmFsU3RhdGUgPT09ICdjb25mdXNlZCcgfHwgXG4gICAgICAgIGNvbnRleHQ/LmVtb3Rpb25hbFN0YXRlID09PSAnZnJ1c3RyYXRlZCcgfHxcbiAgICAgICAgdGV4dC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdubyBlbnRpZW5kbycpIHx8XG4gICAgICAgIHRleHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndmlzdWFsJylcbiAgICAgICkpIHtcbiAgICAgICAgY29uc3QgcmVjb21tZW5kZWRWaWRlbyA9IHZpZGVvU2VydmljZS5maW5kQmVzdFZpZGVvRm9yVG9waWMoZGV0ZWN0ZWRUb3BpYyk7XG4gICAgICAgIGlmIChyZWNvbW1lbmRlZFZpZGVvKSB7XG4gICAgICAgICAgdmlkZW8gPSB7XG4gICAgICAgICAgICB2aWRlb0lkOiByZWNvbW1lbmRlZFZpZGVvLnZpZGVvSWQsXG4gICAgICAgICAgICB0aXRsZTogcmVjb21tZW5kZWRWaWRlby50aXRsZSxcbiAgICAgICAgICAgIHRodW1ibmFpbFVybDogcmVjb21tZW5kZWRWaWRlby50aHVtYm5haWxVcmwsXG4gICAgICAgICAgICBkdXJhdGlvbjogcmVjb21tZW5kZWRWaWRlby5kdXJhdGlvbixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZWNvbW1lbmRlZFZpZGVvLmRlc2NyaXB0aW9uXG4gICAgICAgICAgfTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBBZGQgYSBub3RlIGFib3V0IHRoZSB2aWRlbyByZWNvbW1lbmRhdGlvblxuICAgICAgICAgIHRleHQgKz0gYFxcblxcblRlIHJlY29taWVuZG8gZXN0ZSB2aWRlbyBxdWUgcHVlZGUgYXl1ZGFydGUgYSBlbnRlbmRlciBtZWpvciBlbCBjb25jZXB0bzpgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdXAgdGhlIHRleHQgcmVzcG9uc2UgZm9yIGJldHRlciBhdWRpbyBzeW50aGVzaXNcbiAgICBjb25zdCBhdWRpb0ZyaWVuZGx5VGV4dCA9IHRoaXMucHJlcGFyZVRleHRGb3JBdWRpbyh0ZXh0KTtcblxuICAgIHJldHVybiB7XG4gICAgICB0ZXh0OiBhdWRpb0ZyaWVuZGx5VGV4dCxcbiAgICAgIHZpZGVvLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgZW1vdGlvbjogY29udGV4dD8uZW1vdGlvbmFsU3RhdGUgfHwgJ25ldXRyYWwnLFxuICAgICAgICBjb25maWRlbmNlOiBjb250ZXh0Py5jb25maWRlbmNlIHx8ICh2aWRlbyA/IDAuOCA6IDAuNiksXG4gICAgICAgIG5leHRTdGVwczogdmlkZW8gPyBcbiAgICAgICAgICBbJ1ZlIGVsIHZpZGVvIHJlY29tZW5kYWRvJywgJ0hheiBwcmVndW50YXMgZGUgc2VndWltaWVudG8nLCAnUHJ1ZWJhIGNvbiB1biBlamVyY2ljaW8nXSA6IFxuICAgICAgICAgIFsnQ29udGluw7phIGxhIGRpc2N1c2nDs24nLCAnUGlkZSBtw6FzIGVqZW1wbG9zJywgJ1NvbGljaXRhIGVqZXJjaWNpb3MgcHLDoWN0aWNvcyddLFxuICAgICAgICB1c2VyTmFtZTogY29udGV4dD8udXNlck5hbWVcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBwcmVwYXJlVGV4dEZvckF1ZGlvKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC8vIENsZWFuIHVwIGZvciBiZXR0ZXIgYXVkaW8gc3ludGhlc2lzXG4gICAgICAucmVwbGFjZSgvXFwqXFwqKC4qPylcXCpcXCovZywgJyQxJykgLy8gUmVtb3ZlIGJvbGQgZm9ybWF0dGluZ1xuICAgICAgLnJlcGxhY2UoL1xcKiguKj8pXFwqL2csICckMScpICAgICAvLyBSZW1vdmUgaXRhbGljIGZvcm1hdHRpbmdcbiAgICAgIC5yZXBsYWNlKC9gKC4qPylgL2csICckMScpICAgICAgIC8vIFJlbW92ZSBjb2RlIGZvcm1hdHRpbmdcbiAgICAgIC5yZXBsYWNlKC8jezEsNn1cXHMqKC4qKS9nLCAnJDEnKSAvLyBSZW1vdmUgaGVhZGVyc1xuICAgICAgLnJlcGxhY2UoL1xcWyguKj8pXFxdXFwoLio/XFwpL2csICckMScpIC8vIFJlbW92ZSBsaW5rc1xuICAgICAgLy8gS2VlcCB0aGUgb3JpZ2luYWwgdGV4dCBpbnRhY3QgYnV0IGFkZCBwYXVzZXMgZm9yIHJlYWRhYmlsaXR5XG4gICAgICAucmVwbGFjZSgvXFwuIC9nLCAnLiAnKVxuICAgICAgLnJlcGxhY2UoL1xcPyAvZywgJz8gJylcbiAgICAgIC5yZXBsYWNlKC8hIC9nLCAnISAnKVxuICAgICAgLnRyaW0oKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RmFsbGJhY2tWaWRlb3Mocm9hZG1hcDogUm9hZG1hcEl0ZW1bXSk6IFZpZGVvW10ge1xuICAgIGNvbnN0IGZhbGxiYWNrcyA9IFtcbiAgICAgIHsgdmlkZW9JZDogXCJ1a3pGSTlyZ3dmVVwiLCB0aXRsZTogXCJNYWNoaW5lIExlYXJuaW5nIEV4cGxhaW5lZFwiIH0sXG4gICAgICB7IHZpZGVvSWQ6IFwiYWlyY0FydXZuS2tcIiwgdGl0bGU6IFwiTmV1cmFsIE5ldHdvcmtzIEludHJvZHVjdGlvblwiIH0sXG4gICAgICB7IHZpZGVvSWQ6IFwiSUhad1dGSFdhLXdcIiwgdGl0bGU6IFwiQUkgdnMgTWFjaGluZSBMZWFybmluZ1wiIH0sXG4gICAgICB7IHZpZGVvSWQ6IFwiUjlPSG41WkY0VW9cIiwgdGl0bGU6IFwiRGVlcCBMZWFybmluZyBCYXNpY3NcIiB9LFxuICAgICAgeyB2aWRlb0lkOiBcIlRKbGRPNU01dGJvXCIsIHRpdGxlOiBcIkFJIEV0aGljcyBPdmVydmlld1wiIH1cbiAgICBdO1xuXG4gICAgcmV0dXJuIGZhbGxiYWNrc1xuICAgICAgLnNsaWNlKDAsIE1hdGgubWluKHJvYWRtYXAubGVuZ3RoLCA1KSlcbiAgICAgIC5tYXAodmlkZW8gPT4gKHtcbiAgICAgICAgLi4udmlkZW8sXG4gICAgICAgIHRodW1ibmFpbFVybDogYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt2aWRlby52aWRlb0lkfS9ocWRlZmF1bHQuanBnYFxuICAgICAgfSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRGYWxsYmFja1JvYWRtYXAodGhlbWVOYW1lOiBzdHJpbmcpOiBSb2FkbWFwSXRlbVtdIHtcbiAgICByZXR1cm4gW1xuICAgICAgeyBcbiAgICAgICAgdGl0bGU6IFwiSW50cm9kdWNjacOzbiBhIGxhIElBXCIsIFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJBcHJlbmRlIGxvcyBjb25jZXB0b3MgYsOhc2ljb3MgeSB0ZXJtaW5vbG9nw61hIGRlIGxhIGludGVsaWdlbmNpYSBhcnRpZmljaWFsLlwiIFxuICAgICAgfSxcbiAgICAgIHsgXG4gICAgICAgIHRpdGxlOiBcIlRpcG9zIGRlIElBXCIsIFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJFeHBsb3JhIGxhcyBkaWZlcmVudGVzIGNhdGVnb3LDrWFzIGNvbW8gSUEgZXN0cmVjaGEgeSBJQSBnZW5lcmFsLlwiIFxuICAgICAgfSxcbiAgICAgIHsgXG4gICAgICAgIHRpdGxlOiBcIk1hY2hpbmUgTGVhcm5pbmcgQsOhc2ljb1wiLCBcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRW50aWVuZGUgY8OzbW8gbGFzIG3DoXF1aW5hcyBhcHJlbmRlbiBkZSBsb3MgZGF0b3MuXCIgXG4gICAgICB9LFxuICAgICAgeyBcbiAgICAgICAgdGl0bGU6IFwiUmVkZXMgTmV1cm9uYWxlc1wiLCBcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVW4gdmlzdGF6byBhIGxhIGVzdHJ1Y3R1cmEgZGVsICdjZXJlYnJvJyBkZSBsYSBJQS5cIiBcbiAgICAgIH0sXG4gICAgICB7IFxuICAgICAgICB0aXRsZTogXCLDiXRpY2EgZW4gSUFcIiwgXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2N1dGUgbGFzIGltcG9ydGFudGVzIGltcGxpY2FjaW9uZXMgc29jaWFsZXMgZGUgbGEgSUEuXCIgXG4gICAgICB9XG4gICAgXTtcbiAgfVxufVxuXG4vLyBDcmVhdGUgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgZW5oYW5jZWRHZW1pbmlTZXJ2aWNlID0gbmV3IEVuaGFuY2VkR2VtaW5pU2VydmljZSgpO1xuXG4vLyBFeHBvcnQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBleGlzdGluZyBjb2RlXG5leHBvcnQge1xuICBlbmhhbmNlZEdlbWluaVNlcnZpY2UgYXMgZ2VtaW5pU2VydmljZSxcbiAgRW5oYW5jZWRHZW1pbmlTZXJ2aWNlXG59O1xuIl0sIm5hbWVzIjpbIkdvb2dsZUdlbmVyYXRpdmVBSSIsInZpZGVvU2VydmljZSIsImF1ZGlvU2VydmljZSIsIk1lc3NhZ2VTZW5kZXIiLCJFbmhhbmNlZEdlbWluaVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsIkFQSV9LRVkiLCJjb25zb2xlIiwiZXJyb3IiLCJFcnJvciIsImdlbkFJIiwibW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJnZW5lcmF0ZUluaXRpYWxMZXNzb24iLCJvbmJvYXJkaW5nRGF0YSIsImxlc3NvblRvcGljIiwicHJvbXB0IiwidGhlbWVJZCIsInNlbGVjdGVkVGhlbWUiLCJsZWFybmluZ0dvYWxzIiwiZWxlYXJuaW5nRXhwZXJpZW5jZSIsImxlYXJuaW5nTWV0aG9kcyIsImpvaW4iLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJnZW5lcmF0ZVZpZGVvUGxheWxpc3QiLCJyb2FkbWFwIiwicm9hZG1hcFRpdGxlcyIsIm1hcCIsIml0ZW0iLCJ0aXRsZSIsImNvbmZpZyIsInRlbXBlcmF0dXJlIiwibWF4T3V0cHV0VG9rZW5zIiwiY29udGVudHMiLCJyb2xlIiwicGFydHMiLCJnZW5lcmF0aW9uQ29uZmlnIiwianNvblN0cmluZyIsImNsZWFuSnNvblJlc3BvbnNlIiwicGFyc2VkVmlkZW9zIiwiSlNPTiIsInBhcnNlIiwidmlkZW8iLCJ0aHVtYm5haWxVcmwiLCJ2aWRlb0lkIiwiZ2V0RmFsbGJhY2tWaWRlb3MiLCJnZW5lcmF0ZVJvYWRtYXAiLCJ0aGVtZU5hbWUiLCJhaVVzYWdlIiwiYWlVbmRlcnN0YW5kaW5nIiwicm9hZG1hcEl0ZW1zIiwiQXJyYXkiLCJpc0FycmF5IiwiZ2V0RmFsbGJhY2tSb2FkbWFwIiwiYW5hbHl6ZUFuZFJlc3BvbmQiLCJoaXN0b3J5IiwidXNlcklucHV0IiwiY29udGV4dCIsImNvbnZlcnNhdGlvbkhpc3RvcnkiLCJmb3JtYXRIaXN0b3J5IiwiZGV0ZWN0ZWRFbW90aW9uIiwiZGV0ZWN0RW1vdGlvbmFsU3RhdGUiLCJjdXJyZW50RW1vdGlvbiIsImVtb3Rpb25hbFN0YXRlIiwiZGV0ZWN0ZWRUb3BpYyIsImRldGVjdFRvcGljRnJvbUlucHV0IiwiYmFzZVByb21wdCIsImN1cnJlbnRUb3BpYyIsInVzZXJOYW1lIiwidXNlclByb2ZpbGUiLCJzdHJpbmdpZnkiLCJpc0xlc3Nvbk1vZGUiLCJsZXNzb25Qcm9tcHQiLCJjb3Vyc2VJZCIsImxlc3NvbklkIiwicGFyc2VkUmVzcG9uc2UiLCJwYXJzZVZpZGVvUmVzcG9uc2UiLCJjb25maWRlbmNlIiwiY2FsY3VsYXRlQ29uZmlkZW5jZSIsInN1Z2dlc3Rpb25zIiwiZ2VuZXJhdGVDb250ZXh0dWFsU3VnZ2VzdGlvbnMiLCJ1bmRlZmluZWQiLCJhdWRpbyIsImVuYWJsZWQiLCJpc1N1cHBvcnRlZCIsImF1dG9wbGF5Iiwidm9pY2UiLCJtZXRhZGF0YSIsImF1ZGlvRW5hYmxlZCIsImF1ZGlvU3VwcG9ydGVkIiwiaGFzVmlkZW8iLCJ0b3BpY0RldGVjdGVkIiwiZW5oYW5jZWRGZWF0dXJlcyIsImdldEZhbGxiYWNrUmVzcG9uc2UiLCJnZW5lcmF0ZVRoZW1lRGVzY3JpcHRpb24iLCJ0cmltIiwiZ2VuZXJhdGVMZXNzb25Db250ZW50IiwibGVzc29uVGl0bGUiLCJtZXNzYWdlcyIsInNsaWNlIiwibSIsInNlbmRlciIsImlucHV0IiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsIk1hdGgiLCJtaW4iLCJsZW5ndGgiLCJtYXgiLCJ0b3BpY1BhdHRlcm5zIiwidG9waWMiLCJwYXR0ZXJucyIsIk9iamVjdCIsImVudHJpZXMiLCJzb21lIiwicGF0dGVybiIsImVtb3Rpb24iLCJwdXNoIiwiZmFsbGJhY2tNZXNzYWdlcyIsImZydXN0cmF0ZWQiLCJjb25mdXNlZCIsImVuZ2FnZWQiLCJkZWZhdWx0IiwibWVzc2FnZSIsIm5leHRTdGVwcyIsInN0YXJ0c1dpdGgiLCJzdWJzdHJpbmciLCJlbmRzV2l0aCIsInN0YXJ0SW5kZXgiLCJpbmRleE9mIiwiZW5kSW5kZXgiLCJsYXN0SW5kZXhPZiIsInJhd1RleHQiLCJ2aWRlb01hcmtlciIsInNwbGl0IiwidmlkZW9EYXRhIiwiYmV0dGVyVmlkZW8iLCJmaW5kQmVzdFZpZGVvRm9yVG9waWMiLCJsZWFybmluZ0xldmVsIiwiZHVyYXRpb24iLCJkZXNjcmlwdGlvbiIsImUiLCJmYWxsYmFja1ZpZGVvIiwicmVjb21tZW5kZWRWaWRlbyIsImF1ZGlvRnJpZW5kbHlUZXh0IiwicHJlcGFyZVRleHRGb3JBdWRpbyIsInJlcGxhY2UiLCJmYWxsYmFja3MiLCJlbmhhbmNlZEdlbWluaVNlcnZpY2UiLCJnZW1pbmlTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/enhanced-gemini.ts\n");

/***/ }),

/***/ "(rsc)/./lib/gemini.ts":
/*!***********************!*\
  !*** ./lib/gemini.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   geminiService: () => (/* binding */ geminiService)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/**\n * Enhanced Gemini Service for ProfAI\n * Provides AI tutoring capabilities with Google's Gemini API\n */ \nclass GeminiService {\n    constructor(){\n        const apiKey = process.env.GEMINI_API_KEY;\n        if (!apiKey) {\n            console.warn(\"⚠️ GEMINI_API_KEY not found - using mock responses\");\n            this.genAI = null;\n            this.model = null;\n            this.isInitialized = false;\n            return;\n        }\n        try {\n            this.genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(apiKey);\n            this.model = this.genAI.getGenerativeModel({\n                model: process.env.GEMINI_MODEL || \"gemini-2.0-flash-exp\"\n            });\n            this.isInitialized = true;\n            console.log(\"✅ Gemini service initialized\");\n        } catch (error) {\n            console.error(\"❌ Gemini initialization failed:\", error);\n            this.genAI = null;\n            this.model = null;\n            this.isInitialized = false;\n        }\n    }\n    async generateContent(prompt, systemInstruction) {\n        if (!this.isInitialized || !this.model) {\n            return `Mock response to: \"${prompt}\"`;\n        }\n        try {\n            const fullPrompt = systemInstruction ? `${systemInstruction}\\n\\nUser: ${prompt}` : prompt;\n            const result = await this.model.generateContent(fullPrompt);\n            const response = await result.response;\n            return response.text();\n        } catch (error) {\n            console.error(\"❌ Gemini API error:\", error);\n            return `Error generating response: ${error instanceof Error ? error.message : \"Unknown error\"}`;\n        }\n    }\n    async generateChatResponse(userMessage, context) {\n        const systemInstruction = `You are ProfAI, an expert AI/ML professor. Provide educational, engaging responses adapted to the user's needs.`;\n        try {\n            const response = await this.generateContent(userMessage, systemInstruction);\n            return {\n                message: response,\n                followUpQuestions: [\n                    \"Would you like to explore this topic further?\",\n                    \"Do you have questions about any specific part?\",\n                    \"What would you like to learn next?\"\n                ],\n                relatedTopics: [\n                    \"Machine Learning\",\n                    \"Neural Networks\",\n                    \"Deep Learning\",\n                    \"AI Ethics\"\n                ],\n                needsClarification: false,\n                emotionalTone: \"neutral\"\n            };\n        } catch (error) {\n            return {\n                message: \"I'm having trouble connecting right now, but I'm here to help with AI/ML education. What topic interests you?\",\n                followUpQuestions: [\n                    \"What area of AI interests you most?\"\n                ],\n                emotionalTone: \"supportive\"\n            };\n        }\n    }\n    async generateLesson(topic, difficulty = \"intermediate\", learningStyle = \"hybrid\") {\n        const prompt = `Generate a comprehensive lesson on \"${topic}\" at ${difficulty} level with ${learningStyle} approach.`;\n        try {\n            const response = await this.generateContent(prompt);\n            return {\n                title: `Understanding ${topic}`,\n                objectives: [\n                    `Learn fundamentals of ${topic}`,\n                    `Understand practical applications`,\n                    `Apply concepts in real scenarios`\n                ],\n                content: response,\n                codeExample: learningStyle !== \"theory\" ? `# ${topic} example\\nprint(\"Learning ${topic}\")` : undefined,\n                quiz: {\n                    question: `What is the key concept in ${topic}?`,\n                    options: [\n                        \"Option A\",\n                        \"Option B\",\n                        \"Option C\",\n                        \"Option D\"\n                    ],\n                    correctAnswer: 0,\n                    explanation: \"This demonstrates understanding of core concepts.\"\n                },\n                nextSteps: [\n                    \"Practice with exercises\",\n                    \"Explore advanced topics\",\n                    \"Try real-world applications\"\n                ]\n            };\n        } catch (error) {\n            return {\n                title: `Introduction to ${topic}`,\n                objectives: [\n                    `Learn about ${topic}`\n                ],\n                content: `This lesson covers ${topic}. ${error}`,\n                quiz: {\n                    question: `What is ${topic}?`,\n                    options: [\n                        \"A\",\n                        \"B\",\n                        \"C\",\n                        \"D\"\n                    ],\n                    correctAnswer: 0,\n                    explanation: \"Basic understanding check.\"\n                },\n                nextSteps: [\n                    \"Continue learning\"\n                ]\n            };\n        }\n    }\n    async generateExercise(topic, difficulty = \"intermediate\") {\n        return {\n            title: `${topic} Exercise`,\n            description: `Practice exercise for ${topic} at ${difficulty} level`,\n            instructions: [\n                \"Read the problem carefully\",\n                \"Plan your approach\",\n                \"Implement your solution\",\n                \"Test your results\"\n            ],\n            starterCode: `# ${topic} exercise\\n# Your code here\\npass`,\n            expectedOutput: \"Successful completion of exercise requirements\",\n            evaluationCriteria: [\n                \"Correctness of solution\",\n                \"Code quality\",\n                \"Understanding demonstrated\"\n            ],\n            hints: [\n                \"Break the problem into steps\",\n                \"Test with simple examples\",\n                \"Ask for help if needed\"\n            ]\n        };\n    }\n    async evaluateSubmission(exercise, submission) {\n        return {\n            score: 75,\n            feedback: {\n                strengths: [\n                    \"Good understanding of concepts\"\n                ],\n                improvements: [\n                    \"Could add more detail\"\n                ],\n                specificComments: [\n                    \"Shows solid grasp of fundamentals\"\n                ]\n            },\n            suggestions: [\n                \"Practice more exercises\",\n                \"Try advanced challenges\",\n                \"Review key concepts\"\n            ],\n            nextLevel: false\n        };\n    }\n}\n// Create singleton instance\nconst geminiService = new GeminiService();\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7WUFDMURrQixnQkFBZ0I7WUFDaEJDLG9CQUFvQjtnQkFDbEI7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNEQyxPQUFPO2dCQUNMO2dCQUNBO2dCQUNBO2FBQ0Q7UUFDSDtJQUNGO0lBRUEsTUFBTUMsbUJBQW1CQyxRQUFhLEVBQUVDLFVBQWUsRUFBK0I7UUFDcEYsT0FBTztZQUNMQyxPQUFPO1lBQ1BDLFVBQVU7Z0JBQ1JDLFdBQVc7b0JBQUM7aUJBQWlDO2dCQUM3Q0MsY0FBYztvQkFBQztpQkFBd0I7Z0JBQ3ZDQyxrQkFBa0I7b0JBQUM7aUJBQW9DO1lBQ3pEO1lBQ0FDLGFBQWE7Z0JBQ1g7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNEQyxXQUFXO1FBQ2I7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQzVCLE1BQU1DLGdCQUFnQixJQUFJL0Q7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC8uL2xpYi9nZW1pbmkudHM/YjYzNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVuaGFuY2VkIEdlbWluaSBTZXJ2aWNlIGZvciBQcm9mQUlcbiAqIFByb3ZpZGVzIEFJIHR1dG9yaW5nIGNhcGFiaWxpdGllcyB3aXRoIEdvb2dsZSdzIEdlbWluaSBBUElcbiAqL1xuXG5pbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUkgfSBmcm9tICdAZ29vZ2xlL2dlbmVyYXRpdmUtYWknO1xuXG4vLyBSZXNwb25zZSBpbnRlcmZhY2VzXG5pbnRlcmZhY2UgQ2hhdFJlc3BvbnNlIHtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICBmb2xsb3dVcFF1ZXN0aW9ucz86IHN0cmluZ1tdO1xuICByZWxhdGVkVG9waWNzPzogc3RyaW5nW107XG4gIG5lZWRzQ2xhcmlmaWNhdGlvbj86IGJvb2xlYW47XG4gIGVtb3Rpb25hbFRvbmU/OiAnc3VwcG9ydGl2ZScgfCAnZW5jb3VyYWdpbmcnIHwgJ2NoYWxsZW5naW5nJyB8ICduZXV0cmFsJztcbn1cblxuaW50ZXJmYWNlIExlc3NvblJlc3BvbnNlIHtcbiAgdGl0bGU6IHN0cmluZztcbiAgb2JqZWN0aXZlczogc3RyaW5nW107XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgY29kZUV4YW1wbGU/OiBzdHJpbmc7XG4gIHF1aXo6IHtcbiAgICBxdWVzdGlvbjogc3RyaW5nO1xuICAgIG9wdGlvbnM6IHN0cmluZ1tdO1xuICAgIGNvcnJlY3RBbnN3ZXI6IG51bWJlcjtcbiAgICBleHBsYW5hdGlvbjogc3RyaW5nO1xuICB9O1xuICBuZXh0U3RlcHM6IHN0cmluZ1tdO1xufVxuXG5pbnRlcmZhY2UgRXhlcmNpc2VSZXNwb25zZSB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGluc3RydWN0aW9uczogc3RyaW5nW107XG4gIHN0YXJ0ZXJDb2RlPzogc3RyaW5nO1xuICBleHBlY3RlZE91dHB1dD86IHN0cmluZztcbiAgZXZhbHVhdGlvbkNyaXRlcmlhOiBzdHJpbmdbXTtcbiAgaGludHM6IHN0cmluZ1tdO1xufVxuXG5pbnRlcmZhY2UgRXZhbHVhdGlvblJlc3BvbnNlIHtcbiAgc2NvcmU6IG51bWJlcjtcbiAgZmVlZGJhY2s6IHtcbiAgICBzdHJlbmd0aHM6IHN0cmluZ1tdO1xuICAgIGltcHJvdmVtZW50czogc3RyaW5nW107XG4gICAgc3BlY2lmaWNDb21tZW50czogc3RyaW5nW107XG4gIH07XG4gIHN1Z2dlc3Rpb25zOiBzdHJpbmdbXTtcbiAgbmV4dExldmVsOiBib29sZWFuO1xufVxuXG50eXBlIEdlbWluaVJlc3BvbnNlID0gTGVzc29uUmVzcG9uc2UgfCBFeGVyY2lzZVJlc3BvbnNlIHwgRXZhbHVhdGlvblJlc3BvbnNlIHwgQ2hhdFJlc3BvbnNlIHwgc3RyaW5nO1xuXG5jbGFzcyBHZW1pbmlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBnZW5BSTogR29vZ2xlR2VuZXJhdGl2ZUFJIHwgbnVsbDtcbiAgcHJpdmF0ZSBtb2RlbDogYW55O1xuICBwcml2YXRlIGlzSW5pdGlhbGl6ZWQ6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVk7XG4gICAgXG4gICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBHRU1JTklfQVBJX0tFWSBub3QgZm91bmQgLSB1c2luZyBtb2NrIHJlc3BvbnNlc1wiKTtcbiAgICAgIHRoaXMuZ2VuQUkgPSBudWxsO1xuICAgICAgdGhpcy5tb2RlbCA9IG51bGw7XG4gICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5nZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkoYXBpS2V5KTtcbiAgICAgIHRoaXMubW9kZWwgPSB0aGlzLmdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7IFxuICAgICAgICBtb2RlbDogcHJvY2Vzcy5lbnYuR0VNSU5JX01PREVMIHx8IFwiZ2VtaW5pLTIuMC1mbGFzaC1leHBcIlxuICAgICAgfSk7XG4gICAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5sb2coXCLinIUgR2VtaW5pIHNlcnZpY2UgaW5pdGlhbGl6ZWRcIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgR2VtaW5pIGluaXRpYWxpemF0aW9uIGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgdGhpcy5nZW5BSSA9IG51bGw7XG4gICAgICB0aGlzLm1vZGVsID0gbnVsbDtcbiAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlQ29udGVudChwcm9tcHQ6IHN0cmluZywgc3lzdGVtSW5zdHJ1Y3Rpb24/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmICghdGhpcy5pc0luaXRpYWxpemVkIHx8ICF0aGlzLm1vZGVsKSB7XG4gICAgICByZXR1cm4gYE1vY2sgcmVzcG9uc2UgdG86IFwiJHtwcm9tcHR9XCJgO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmdWxsUHJvbXB0ID0gc3lzdGVtSW5zdHJ1Y3Rpb24gXG4gICAgICAgID8gYCR7c3lzdGVtSW5zdHJ1Y3Rpb259XFxuXFxuVXNlcjogJHtwcm9tcHR9YFxuICAgICAgICA6IHByb21wdDtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tb2RlbC5nZW5lcmF0ZUNvbnRlbnQoZnVsbFByb21wdCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBHZW1pbmkgQVBJIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBgRXJyb3IgZ2VuZXJhdGluZyByZXNwb25zZTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlQ2hhdFJlc3BvbnNlKHVzZXJNZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBhbnkpOiBQcm9taXNlPENoYXRSZXNwb25zZT4ge1xuICAgIGNvbnN0IHN5c3RlbUluc3RydWN0aW9uID0gYFlvdSBhcmUgUHJvZkFJLCBhbiBleHBlcnQgQUkvTUwgcHJvZmVzc29yLiBQcm92aWRlIGVkdWNhdGlvbmFsLCBlbmdhZ2luZyByZXNwb25zZXMgYWRhcHRlZCB0byB0aGUgdXNlcidzIG5lZWRzLmA7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ29udGVudCh1c2VyTWVzc2FnZSwgc3lzdGVtSW5zdHJ1Y3Rpb24pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiByZXNwb25zZSxcbiAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IFtcbiAgICAgICAgICBcIldvdWxkIHlvdSBsaWtlIHRvIGV4cGxvcmUgdGhpcyB0b3BpYyBmdXJ0aGVyP1wiLFxuICAgICAgICAgIFwiRG8geW91IGhhdmUgcXVlc3Rpb25zIGFib3V0IGFueSBzcGVjaWZpYyBwYXJ0P1wiLFxuICAgICAgICAgIFwiV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBuZXh0P1wiXG4gICAgICAgIF0sXG4gICAgICAgIHJlbGF0ZWRUb3BpY3M6IFtcIk1hY2hpbmUgTGVhcm5pbmdcIiwgXCJOZXVyYWwgTmV0d29ya3NcIiwgXCJEZWVwIExlYXJuaW5nXCIsIFwiQUkgRXRoaWNzXCJdLFxuICAgICAgICBuZWVkc0NsYXJpZmljYXRpb246IGZhbHNlLFxuICAgICAgICBlbW90aW9uYWxUb25lOiAnbmV1dHJhbCdcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6IFwiSSdtIGhhdmluZyB0cm91YmxlIGNvbm5lY3RpbmcgcmlnaHQgbm93LCBidXQgSSdtIGhlcmUgdG8gaGVscCB3aXRoIEFJL01MIGVkdWNhdGlvbi4gV2hhdCB0b3BpYyBpbnRlcmVzdHMgeW91P1wiLFxuICAgICAgICBmb2xsb3dVcFF1ZXN0aW9uczogW1wiV2hhdCBhcmVhIG9mIEFJIGludGVyZXN0cyB5b3UgbW9zdD9cIl0sXG4gICAgICAgIGVtb3Rpb25hbFRvbmU6ICdzdXBwb3J0aXZlJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUxlc3NvbihcbiAgICB0b3BpYzogc3RyaW5nLFxuICAgIGRpZmZpY3VsdHk6IHN0cmluZyA9ICdpbnRlcm1lZGlhdGUnLFxuICAgIGxlYXJuaW5nU3R5bGU6IHN0cmluZyA9ICdoeWJyaWQnXG4gICk6IFByb21pc2U8TGVzc29uUmVzcG9uc2U+IHtcbiAgICBjb25zdCBwcm9tcHQgPSBgR2VuZXJhdGUgYSBjb21wcmVoZW5zaXZlIGxlc3NvbiBvbiBcIiR7dG9waWN9XCIgYXQgJHtkaWZmaWN1bHR5fSBsZXZlbCB3aXRoICR7bGVhcm5pbmdTdHlsZX0gYXBwcm9hY2guYDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQ29udGVudChwcm9tcHQpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogYFVuZGVyc3RhbmRpbmcgJHt0b3BpY31gLFxuICAgICAgICBvYmplY3RpdmVzOiBbXG4gICAgICAgICAgYExlYXJuIGZ1bmRhbWVudGFscyBvZiAke3RvcGljfWAsXG4gICAgICAgICAgYFVuZGVyc3RhbmQgcHJhY3RpY2FsIGFwcGxpY2F0aW9uc2AsXG4gICAgICAgICAgYEFwcGx5IGNvbmNlcHRzIGluIHJlYWwgc2NlbmFyaW9zYFxuICAgICAgICBdLFxuICAgICAgICBjb250ZW50OiByZXNwb25zZSxcbiAgICAgICAgY29kZUV4YW1wbGU6IGxlYXJuaW5nU3R5bGUgIT09ICd0aGVvcnknID8gYCMgJHt0b3BpY30gZXhhbXBsZVxcbnByaW50KFwiTGVhcm5pbmcgJHt0b3BpY31cIilgIDogdW5kZWZpbmVkLFxuICAgICAgICBxdWl6OiB7XG4gICAgICAgICAgcXVlc3Rpb246IGBXaGF0IGlzIHRoZSBrZXkgY29uY2VwdCBpbiAke3RvcGljfT9gLFxuICAgICAgICAgIG9wdGlvbnM6IFtcIk9wdGlvbiBBXCIsIFwiT3B0aW9uIEJcIiwgXCJPcHRpb24gQ1wiLCBcIk9wdGlvbiBEXCJdLFxuICAgICAgICAgIGNvcnJlY3RBbnN3ZXI6IDAsXG4gICAgICAgICAgZXhwbGFuYXRpb246IFwiVGhpcyBkZW1vbnN0cmF0ZXMgdW5kZXJzdGFuZGluZyBvZiBjb3JlIGNvbmNlcHRzLlwiXG4gICAgICAgIH0sXG4gICAgICAgIG5leHRTdGVwczogW1xuICAgICAgICAgIFwiUHJhY3RpY2Ugd2l0aCBleGVyY2lzZXNcIixcbiAgICAgICAgICBcIkV4cGxvcmUgYWR2YW5jZWQgdG9waWNzXCIsXG4gICAgICAgICAgXCJUcnkgcmVhbC13b3JsZCBhcHBsaWNhdGlvbnNcIlxuICAgICAgICBdXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogYEludHJvZHVjdGlvbiB0byAke3RvcGljfWAsXG4gICAgICAgIG9iamVjdGl2ZXM6IFtgTGVhcm4gYWJvdXQgJHt0b3BpY31gXSxcbiAgICAgICAgY29udGVudDogYFRoaXMgbGVzc29uIGNvdmVycyAke3RvcGljfS4gJHtlcnJvcn1gLFxuICAgICAgICBxdWl6OiB7XG4gICAgICAgICAgcXVlc3Rpb246IGBXaGF0IGlzICR7dG9waWN9P2AsXG4gICAgICAgICAgb3B0aW9uczogW1wiQVwiLCBcIkJcIiwgXCJDXCIsIFwiRFwiXSxcbiAgICAgICAgICBjb3JyZWN0QW5zd2VyOiAwLFxuICAgICAgICAgIGV4cGxhbmF0aW9uOiBcIkJhc2ljIHVuZGVyc3RhbmRpbmcgY2hlY2suXCJcbiAgICAgICAgfSxcbiAgICAgICAgbmV4dFN0ZXBzOiBbXCJDb250aW51ZSBsZWFybmluZ1wiXVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUV4ZXJjaXNlKHRvcGljOiBzdHJpbmcsIGRpZmZpY3VsdHk6IHN0cmluZyA9ICdpbnRlcm1lZGlhdGUnKTogUHJvbWlzZTxFeGVyY2lzZVJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpdGxlOiBgJHt0b3BpY30gRXhlcmNpc2VgLFxuICAgICAgZGVzY3JpcHRpb246IGBQcmFjdGljZSBleGVyY2lzZSBmb3IgJHt0b3BpY30gYXQgJHtkaWZmaWN1bHR5fSBsZXZlbGAsXG4gICAgICBpbnN0cnVjdGlvbnM6IFtcbiAgICAgICAgXCJSZWFkIHRoZSBwcm9ibGVtIGNhcmVmdWxseVwiLFxuICAgICAgICBcIlBsYW4geW91ciBhcHByb2FjaFwiLFxuICAgICAgICBcIkltcGxlbWVudCB5b3VyIHNvbHV0aW9uXCIsXG4gICAgICAgIFwiVGVzdCB5b3VyIHJlc3VsdHNcIlxuICAgICAgXSxcbiAgICAgIHN0YXJ0ZXJDb2RlOiBgIyAke3RvcGljfSBleGVyY2lzZVxcbiMgWW91ciBjb2RlIGhlcmVcXG5wYXNzYCxcbiAgICAgIGV4cGVjdGVkT3V0cHV0OiBcIlN1Y2Nlc3NmdWwgY29tcGxldGlvbiBvZiBleGVyY2lzZSByZXF1aXJlbWVudHNcIixcbiAgICAgIGV2YWx1YXRpb25Dcml0ZXJpYTogW1xuICAgICAgICBcIkNvcnJlY3RuZXNzIG9mIHNvbHV0aW9uXCIsXG4gICAgICAgIFwiQ29kZSBxdWFsaXR5XCIsXG4gICAgICAgIFwiVW5kZXJzdGFuZGluZyBkZW1vbnN0cmF0ZWRcIlxuICAgICAgXSxcbiAgICAgIGhpbnRzOiBbXG4gICAgICAgIFwiQnJlYWsgdGhlIHByb2JsZW0gaW50byBzdGVwc1wiLFxuICAgICAgICBcIlRlc3Qgd2l0aCBzaW1wbGUgZXhhbXBsZXNcIixcbiAgICAgICAgXCJBc2sgZm9yIGhlbHAgaWYgbmVlZGVkXCJcbiAgICAgIF1cbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgZXZhbHVhdGVTdWJtaXNzaW9uKGV4ZXJjaXNlOiBhbnksIHN1Ym1pc3Npb246IGFueSk6IFByb21pc2U8RXZhbHVhdGlvblJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNjb3JlOiA3NSxcbiAgICAgIGZlZWRiYWNrOiB7XG4gICAgICAgIHN0cmVuZ3RoczogW1wiR29vZCB1bmRlcnN0YW5kaW5nIG9mIGNvbmNlcHRzXCJdLFxuICAgICAgICBpbXByb3ZlbWVudHM6IFtcIkNvdWxkIGFkZCBtb3JlIGRldGFpbFwiXSxcbiAgICAgICAgc3BlY2lmaWNDb21tZW50czogW1wiU2hvd3Mgc29saWQgZ3Jhc3Agb2YgZnVuZGFtZW50YWxzXCJdXG4gICAgICB9LFxuICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgXCJQcmFjdGljZSBtb3JlIGV4ZXJjaXNlc1wiLFxuICAgICAgICBcIlRyeSBhZHZhbmNlZCBjaGFsbGVuZ2VzXCIsXG4gICAgICAgIFwiUmV2aWV3IGtleSBjb25jZXB0c1wiXG4gICAgICBdLFxuICAgICAgbmV4dExldmVsOiBmYWxzZVxuICAgIH07XG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBpbnN0YW5jZVxuY29uc3QgZ2VtaW5pU2VydmljZSA9IG5ldyBHZW1pbmlTZXJ2aWNlKCk7XG5cbmV4cG9ydCB7IGdlbWluaVNlcnZpY2UgfTtcbmV4cG9ydCB0eXBlIHsgR2VtaW5pUmVzcG9uc2UsIENoYXRSZXNwb25zZSwgTGVzc29uUmVzcG9uc2UsIEV4ZXJjaXNlUmVzcG9uc2UsIEV2YWx1YXRpb25SZXNwb25zZSB9O1xuIl0sIm5hbWVzIjpbIkdvb2dsZUdlbmVyYXRpdmVBSSIsIkdlbWluaVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsImNvbnNvbGUiLCJ3YXJuIiwiZ2VuQUkiLCJtb2RlbCIsImlzSW5pdGlhbGl6ZWQiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJHRU1JTklfTU9ERUwiLCJsb2ciLCJlcnJvciIsImdlbmVyYXRlQ29udGVudCIsInByb21wdCIsInN5c3RlbUluc3RydWN0aW9uIiwiZnVsbFByb21wdCIsInJlc3VsdCIsInJlc3BvbnNlIiwidGV4dCIsIkVycm9yIiwibWVzc2FnZSIsImdlbmVyYXRlQ2hhdFJlc3BvbnNlIiwidXNlck1lc3NhZ2UiLCJjb250ZXh0IiwiZm9sbG93VXBRdWVzdGlvbnMiLCJyZWxhdGVkVG9waWNzIiwibmVlZHNDbGFyaWZpY2F0aW9uIiwiZW1vdGlvbmFsVG9uZSIsImdlbmVyYXRlTGVzc29uIiwidG9waWMiLCJkaWZmaWN1bHR5IiwibGVhcm5pbmdTdHlsZSIsInRpdGxlIiwib2JqZWN0aXZlcyIsImNvbnRlbnQiLCJjb2RlRXhhbXBsZSIsInVuZGVmaW5lZCIsInF1aXoiLCJxdWVzdGlvbiIsIm9wdGlvbnMiLCJjb3JyZWN0QW5zd2VyIiwiZXhwbGFuYXRpb24iLCJuZXh0U3RlcHMiLCJnZW5lcmF0ZUV4ZXJjaXNlIiwiZGVzY3JpcHRpb24iLCJpbnN0cnVjdGlvbnMiLCJzdGFydGVyQ29kZSIsImV4cGVjdGVkT3V0cHV0IiwiZXZhbHVhdGlvbkNyaXRlcmlhIiwiaGludHMiLCJldmFsdWF0ZVN1Ym1pc3Npb24iLCJleGVyY2lzZSIsInN1Ym1pc3Npb24iLCJzY29yZSIsImZlZWRiYWNrIiwic3RyZW5ndGhzIiwiaW1wcm92ZW1lbnRzIiwic3BlY2lmaWNDb21tZW50cyIsInN1Z2dlc3Rpb25zIiwibmV4dExldmVsIiwiZ2VtaW5pU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/gemini.ts\n");

/***/ }),

/***/ "(rsc)/./lib/image-fallbacks.ts":
/*!********************************!*\
  !*** ./lib/image-fallbacks.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FALLBACK_IMAGES: () => (/* binding */ FALLBACK_IMAGES),\n/* harmony export */   STABLE_UNSPLASH_IMAGES: () => (/* binding */ STABLE_UNSPLASH_IMAGES),\n/* harmony export */   createPlaceholderSVG: () => (/* binding */ createPlaceholderSVG),\n/* harmony export */   getImageWithFallback: () => (/* binding */ getImageWithFallback),\n/* harmony export */   handleImageError: () => (/* binding */ handleImageError)\n/* harmony export */ });\n// Image fallback utility for handling failed image loads\n// This provides stable placeholder images when Unsplash images fail\nconst FALLBACK_IMAGES = {\n    \"machine-learning\": \"/images/courses/ml-fallback.svg\",\n    \"prompt-engineering\": \"/images/courses/prompt-fallback.svg\",\n    \"deep-learning\": \"/images/courses/dl-fallback.svg\",\n    \"nlp\": \"/images/courses/nlp-fallback.svg\",\n    \"ai-ethics\": \"/images/courses/ethics-fallback.svg\",\n    \"default\": \"/images/courses/default-fallback.svg\"\n};\nconst STABLE_UNSPLASH_IMAGES = {\n    \"machine-learning\": \"https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=400&h=200&fit=crop&crop=center&auto=format&q=75\",\n    \"prompt-engineering\": \"https://images.unsplash.com/photo-1563207153-f403bf289096?w=400&h=200&fit=crop&crop=center&auto=format&q=75\",\n    \"deep-learning\": \"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=200&fit=crop&crop=center&auto=format&q=75\",\n    \"nlp\": \"https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=400&h=200&fit=crop&crop=center&auto=format&q=75\",\n    \"ai-ethics\": \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=200&fit=crop&crop=center&auto=format&q=75\",\n    \"default\": \"https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?w=400&h=200&fit=crop&crop=center&auto=format&q=75\"\n};\n// Create SVG placeholder\nfunction createPlaceholderSVG(text, width = 400, height = 200) {\n    return `data:image/svg+xml;charset=UTF-8,${encodeURIComponent(`\n    <svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">\n      <defs>\n        <linearGradient id=\"grad1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n          <stop offset=\"0%\" style=\"stop-color:#667eea;stop-opacity:1\" />\n          <stop offset=\"100%\" style=\"stop-color:#764ba2;stop-opacity:1\" />\n        </linearGradient>\n      </defs>\n      <rect width=\"100%\" height=\"100%\" fill=\"url(#grad1)\"/>\n      <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" dy=\"0.3em\" \n            font-family=\"system-ui, -apple-system, sans-serif\" \n            font-size=\"16\" font-weight=\"600\" fill=\"white\">\n        ${text}\n      </text>\n    </svg>\n  `)}`;\n}\n// Get image URL with fallback handling\nfunction getImageWithFallback(courseId, categoryHint) {\n    const categoryMap = {\n        \"course-ml-fundamentals\": \"machine-learning\",\n        \"course-prompt-engineering\": \"prompt-engineering\",\n        \"course-deep-learning\": \"deep-learning\",\n        \"course-nlp-basics\": \"nlp\",\n        \"course-ai-ethics\": \"ai-ethics\"\n    };\n    const category = categoryMap[courseId] || categoryHint || \"default\";\n    return STABLE_UNSPLASH_IMAGES[category] || STABLE_UNSPLASH_IMAGES.default;\n}\n// Image error handler\nfunction handleImageError(event, fallbackText) {\n    const img = event.currentTarget;\n    const placeholder = createPlaceholderSVG(fallbackText);\n    img.src = placeholder;\n    img.onerror = null; // Prevent infinite loop\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvaW1hZ2UtZmFsbGJhY2tzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEseURBQXlEO0FBQ3pELG9FQUFvRTtBQUU3RCxNQUFNQSxrQkFBa0I7SUFDN0Isb0JBQW9CO0lBQ3BCLHNCQUFzQjtJQUN0QixpQkFBaUI7SUFDakIsT0FBTztJQUNQLGFBQWE7SUFDYixXQUFXO0FBQ2IsRUFBRTtBQUVLLE1BQU1DLHlCQUF5QjtJQUNwQyxvQkFBb0I7SUFDcEIsc0JBQXNCO0lBQ3RCLGlCQUFpQjtJQUNqQixPQUFPO0lBQ1AsYUFBYTtJQUNiLFdBQVc7QUFDYixFQUFFO0FBRUYseUJBQXlCO0FBQ2xCLFNBQVNDLHFCQUFxQkMsSUFBWSxFQUFFQyxRQUFRLEdBQUcsRUFBRUMsU0FBUyxHQUFHO0lBQzFFLE9BQU8sQ0FBQyxpQ0FBaUMsRUFBRUMsbUJBQW1CLENBQUM7Z0JBQ2pELEVBQUVGLE1BQU0sVUFBVSxFQUFFQyxPQUFPOzs7Ozs7Ozs7OztRQVduQyxFQUFFRixLQUFLOzs7RUFHYixDQUFDLEVBQUUsQ0FBQztBQUNOO0FBRUEsdUNBQXVDO0FBQ2hDLFNBQVNJLHFCQUFxQkMsUUFBZ0IsRUFBRUMsWUFBcUI7SUFDMUUsTUFBTUMsY0FBc0U7UUFDMUUsMEJBQTBCO1FBQzFCLDZCQUE2QjtRQUM3Qix3QkFBd0I7UUFDeEIscUJBQXFCO1FBQ3JCLG9CQUFvQjtJQUN0QjtJQUVBLE1BQU1DLFdBQVdELFdBQVcsQ0FBQ0YsU0FBUyxJQUFJQyxnQkFBZ0I7SUFDMUQsT0FBT1Isc0JBQXNCLENBQUNVLFNBQVMsSUFBSVYsdUJBQXVCVyxPQUFPO0FBQzNFO0FBRUEsc0JBQXNCO0FBQ2YsU0FBU0MsaUJBQWlCQyxLQUE2QyxFQUFFQyxZQUFvQjtJQUNsRyxNQUFNQyxNQUFNRixNQUFNRyxhQUFhO0lBQy9CLE1BQU1DLGNBQWNoQixxQkFBcUJhO0lBQ3pDQyxJQUFJRyxHQUFHLEdBQUdEO0lBQ1ZGLElBQUlJLE9BQU8sR0FBRyxNQUFNLHdCQUF3QjtBQUM5QyIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC8uL2xpYi9pbWFnZS1mYWxsYmFja3MudHM/YmMzNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbWFnZSBmYWxsYmFjayB1dGlsaXR5IGZvciBoYW5kbGluZyBmYWlsZWQgaW1hZ2UgbG9hZHNcbi8vIFRoaXMgcHJvdmlkZXMgc3RhYmxlIHBsYWNlaG9sZGVyIGltYWdlcyB3aGVuIFVuc3BsYXNoIGltYWdlcyBmYWlsXG5cbmV4cG9ydCBjb25zdCBGQUxMQkFDS19JTUFHRVMgPSB7XG4gICdtYWNoaW5lLWxlYXJuaW5nJzogJy9pbWFnZXMvY291cnNlcy9tbC1mYWxsYmFjay5zdmcnLFxuICAncHJvbXB0LWVuZ2luZWVyaW5nJzogJy9pbWFnZXMvY291cnNlcy9wcm9tcHQtZmFsbGJhY2suc3ZnJyxcbiAgJ2RlZXAtbGVhcm5pbmcnOiAnL2ltYWdlcy9jb3Vyc2VzL2RsLWZhbGxiYWNrLnN2ZycsXG4gICdubHAnOiAnL2ltYWdlcy9jb3Vyc2VzL25scC1mYWxsYmFjay5zdmcnLFxuICAnYWktZXRoaWNzJzogJy9pbWFnZXMvY291cnNlcy9ldGhpY3MtZmFsbGJhY2suc3ZnJyxcbiAgJ2RlZmF1bHQnOiAnL2ltYWdlcy9jb3Vyc2VzL2RlZmF1bHQtZmFsbGJhY2suc3ZnJ1xufTtcblxuZXhwb3J0IGNvbnN0IFNUQUJMRV9VTlNQTEFTSF9JTUFHRVMgPSB7XG4gICdtYWNoaW5lLWxlYXJuaW5nJzogJ2h0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNDg1ODI3NDA0NzAzLTg5YjU1ZmNjNTk1ZT93PTQwMCZoPTIwMCZmaXQ9Y3JvcCZjcm9wPWNlbnRlciZhdXRvPWZvcm1hdCZxPTc1JyxcbiAgJ3Byb21wdC1lbmdpbmVlcmluZyc6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU2MzIwNzE1My1mNDAzYmYyODkwOTY/dz00MDAmaD0yMDAmZml0PWNyb3AmY3JvcD1jZW50ZXImYXV0bz1mb3JtYXQmcT03NScsXG4gICdkZWVwLWxlYXJuaW5nJzogJ2h0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTE4NzA5MjY4ODA1LTRlOTA0MmFmMjE3Nj93PTQwMCZoPTIwMCZmaXQ9Y3JvcCZjcm9wPWNlbnRlciZhdXRvPWZvcm1hdCZxPTc1JyxcbiAgJ25scCc6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUxNjMyMTMxODQyMy1mMDZmODVlNTA0YjM/dz00MDAmaD0yMDAmZml0PWNyb3AmY3JvcD1jZW50ZXImYXV0bz1mb3JtYXQmcT03NScsXG4gICdhaS1ldGhpY3MnOiAnaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE1MDcwMDMyMTExNjktMGExZGQ3MjI4ZjJkP3c9NDAwJmg9MjAwJmZpdD1jcm9wJmNyb3A9Y2VudGVyJmF1dG89Zm9ybWF0JnE9NzUnLFxuICAnZGVmYXVsdCc6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTUyNjM3NDk2NTMyOC03ZjYxZDRkYzE4YzU/dz00MDAmaD0yMDAmZml0PWNyb3AmY3JvcD1jZW50ZXImYXV0bz1mb3JtYXQmcT03NSdcbn07XG5cbi8vIENyZWF0ZSBTVkcgcGxhY2Vob2xkZXJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQbGFjZWhvbGRlclNWRyh0ZXh0OiBzdHJpbmcsIHdpZHRoID0gNDAwLCBoZWlnaHQgPSAyMDApOiBzdHJpbmcge1xuICByZXR1cm4gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04LCR7ZW5jb2RlVVJJQ29tcG9uZW50KGBcbiAgICA8c3ZnIHdpZHRoPVwiJHt3aWR0aH1cIiBoZWlnaHQ9XCIke2hlaWdodH1cIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+XG4gICAgICA8ZGVmcz5cbiAgICAgICAgPGxpbmVhckdyYWRpZW50IGlkPVwiZ3JhZDFcIiB4MT1cIjAlXCIgeTE9XCIwJVwiIHgyPVwiMTAwJVwiIHkyPVwiMTAwJVwiPlxuICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiM2NjdlZWE7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgICAgIDxzdG9wIG9mZnNldD1cIjEwMCVcIiBzdHlsZT1cInN0b3AtY29sb3I6Izc2NGJhMjtzdG9wLW9wYWNpdHk6MVwiIC8+XG4gICAgICAgIDwvbGluZWFyR3JhZGllbnQ+XG4gICAgICA8L2RlZnM+XG4gICAgICA8cmVjdCB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgZmlsbD1cInVybCgjZ3JhZDEpXCIvPlxuICAgICAgPHRleHQgeD1cIjUwJVwiIHk9XCI1MCVcIiB0ZXh0LWFuY2hvcj1cIm1pZGRsZVwiIGR5PVwiMC4zZW1cIiBcbiAgICAgICAgICAgIGZvbnQtZmFtaWx5PVwic3lzdGVtLXVpLCAtYXBwbGUtc3lzdGVtLCBzYW5zLXNlcmlmXCIgXG4gICAgICAgICAgICBmb250LXNpemU9XCIxNlwiIGZvbnQtd2VpZ2h0PVwiNjAwXCIgZmlsbD1cIndoaXRlXCI+XG4gICAgICAgICR7dGV4dH1cbiAgICAgIDwvdGV4dD5cbiAgICA8L3N2Zz5cbiAgYCl9YDtcbn1cblxuLy8gR2V0IGltYWdlIFVSTCB3aXRoIGZhbGxiYWNrIGhhbmRsaW5nXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW1hZ2VXaXRoRmFsbGJhY2soY291cnNlSWQ6IHN0cmluZywgY2F0ZWdvcnlIaW50Pzogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgY2F0ZWdvcnlNYXA6IHsgW2tleTogc3RyaW5nXToga2V5b2YgdHlwZW9mIFNUQUJMRV9VTlNQTEFTSF9JTUFHRVMgfSA9IHtcbiAgICAnY291cnNlLW1sLWZ1bmRhbWVudGFscyc6ICdtYWNoaW5lLWxlYXJuaW5nJyxcbiAgICAnY291cnNlLXByb21wdC1lbmdpbmVlcmluZyc6ICdwcm9tcHQtZW5naW5lZXJpbmcnLCBcbiAgICAnY291cnNlLWRlZXAtbGVhcm5pbmcnOiAnZGVlcC1sZWFybmluZycsXG4gICAgJ2NvdXJzZS1ubHAtYmFzaWNzJzogJ25scCcsXG4gICAgJ2NvdXJzZS1haS1ldGhpY3MnOiAnYWktZXRoaWNzJ1xuICB9O1xuXG4gIGNvbnN0IGNhdGVnb3J5ID0gY2F0ZWdvcnlNYXBbY291cnNlSWRdIHx8IGNhdGVnb3J5SGludCB8fCAnZGVmYXVsdCc7XG4gIHJldHVybiBTVEFCTEVfVU5TUExBU0hfSU1BR0VTW2NhdGVnb3J5XSB8fCBTVEFCTEVfVU5TUExBU0hfSU1BR0VTLmRlZmF1bHQ7XG59XG5cbi8vIEltYWdlIGVycm9yIGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVJbWFnZUVycm9yKGV2ZW50OiBSZWFjdC5TeW50aGV0aWNFdmVudDxIVE1MSW1hZ2VFbGVtZW50PiwgZmFsbGJhY2tUZXh0OiBzdHJpbmcpIHtcbiAgY29uc3QgaW1nID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgY29uc3QgcGxhY2Vob2xkZXIgPSBjcmVhdGVQbGFjZWhvbGRlclNWRyhmYWxsYmFja1RleHQpO1xuICBpbWcuc3JjID0gcGxhY2Vob2xkZXI7XG4gIGltZy5vbmVycm9yID0gbnVsbDsgLy8gUHJldmVudCBpbmZpbml0ZSBsb29wXG59XG4iXSwibmFtZXMiOlsiRkFMTEJBQ0tfSU1BR0VTIiwiU1RBQkxFX1VOU1BMQVNIX0lNQUdFUyIsImNyZWF0ZVBsYWNlaG9sZGVyU1ZHIiwidGV4dCIsIndpZHRoIiwiaGVpZ2h0IiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiZ2V0SW1hZ2VXaXRoRmFsbGJhY2siLCJjb3Vyc2VJZCIsImNhdGVnb3J5SGludCIsImNhdGVnb3J5TWFwIiwiY2F0ZWdvcnkiLCJkZWZhdWx0IiwiaGFuZGxlSW1hZ2VFcnJvciIsImV2ZW50IiwiZmFsbGJhY2tUZXh0IiwiaW1nIiwiY3VycmVudFRhcmdldCIsInBsYWNlaG9sZGVyIiwic3JjIiwib25lcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/image-fallbacks.ts\n");

/***/ }),

/***/ "(rsc)/./lib/mock-data.ts":
/*!**************************!*\
  !*** ./lib/mock-data.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getDemoUser: () => (/* binding */ getDemoUser),\n/* harmony export */   isDemoUser: () => (/* binding */ isDemoUser),\n/* harmony export */   mockData: () => (/* binding */ mockData)\n/* harmony export */ });\n/* harmony import */ var _image_fallbacks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./image-fallbacks */ \"(rsc)/./lib/image-fallbacks.ts\");\n// Mock data helper for ProfAI demo mode\n// This provides fallback data when database is unavailable\n\nconst mockData = {\n    // Demo users\n    demoUsers: {\n        \"demo_john_doe\": {\n            id: \"demo_john_doe\",\n            email: \"john@doe.com\",\n            name: \"John Doe\",\n            firstName: \"John\",\n            lastName: \"Doe\",\n            learningStyle: {\n                visual: 0.8,\n                auditory: 0.6,\n                kinesthetic: 0.7\n            },\n            skillLevel: {\n                theory: \"intermediate\",\n                tooling: \"beginner\",\n                prompting: \"intermediate\"\n            },\n            emotionBaseline: {\n                confusion_threshold: 0.7,\n                frustration_threshold: 0.6,\n                engagement_baseline: 0.5\n            },\n            preferences: {\n                preferred_format: \"hybrid\",\n                language: \"es\",\n                pace: \"normal\",\n                difficulty_preference: \"adaptive\"\n            },\n            totalLessonsCompleted: 12,\n            currentStreak: 5,\n            lastActiveAt: new Date().toISOString()\n        },\n        \"demo_profai\": {\n            id: \"demo_profai\",\n            email: \"demo@profai.com\",\n            name: \"Demo User\",\n            firstName: \"Demo\",\n            lastName: \"User\",\n            learningStyle: {\n                visual: 0.7,\n                auditory: 0.5,\n                kinesthetic: 0.6\n            },\n            skillLevel: {\n                theory: \"beginner\",\n                tooling: \"beginner\",\n                prompting: \"beginner\"\n            },\n            emotionBaseline: {\n                confusion_threshold: 0.7,\n                frustration_threshold: 0.6,\n                engagement_baseline: 0.5\n            },\n            preferences: {\n                preferred_format: \"hybrid\",\n                language: \"es\",\n                pace: \"normal\",\n                difficulty_preference: \"adaptive\"\n            },\n            totalLessonsCompleted: 3,\n            currentStreak: 1,\n            lastActiveAt: new Date().toISOString()\n        }\n    },\n    // Mock courses\n    courses: [\n        {\n            id: \"course-ml-fundamentals\",\n            title: \"Machine Learning Fundamentals\",\n            description: \"Aprende los conceptos b\\xe1sicos de Machine Learning con ejemplos pr\\xe1cticos y teor\\xeda aplicada\",\n            category: \"theory\",\n            difficulty: 2,\n            imageUrl: (0,_image_fallbacks__WEBPACK_IMPORTED_MODULE_0__.getImageWithFallback)(\"course-ml-fundamentals\", \"machine-learning\"),\n            progress: 45,\n            totalLessons: 8,\n            completedLessons: 3,\n            isActive: true,\n            sortOrder: 1\n        },\n        {\n            id: \"course-prompt-engineering\",\n            title: \"Prompt Engineering Avanzado\",\n            description: \"Domina el arte de crear prompts efectivos para maximizar el potencial de las IAs generativas\",\n            category: \"tooling\",\n            difficulty: 3,\n            imageUrl: (0,_image_fallbacks__WEBPACK_IMPORTED_MODULE_0__.getImageWithFallback)(\"course-prompt-engineering\", \"prompt-engineering\"),\n            progress: 20,\n            totalLessons: 6,\n            completedLessons: 1,\n            isActive: true,\n            sortOrder: 2\n        },\n        {\n            id: \"course-deep-learning\",\n            title: \"Deep Learning con PyTorch\",\n            description: \"Construye redes neuronales profundas y entiende los algoritmos que potencian la IA moderna\",\n            category: \"hybrid\",\n            difficulty: 4,\n            imageUrl: (0,_image_fallbacks__WEBPACK_IMPORTED_MODULE_0__.getImageWithFallback)(\"course-deep-learning\", \"deep-learning\"),\n            progress: 0,\n            totalLessons: 12,\n            completedLessons: 0,\n            isActive: true,\n            sortOrder: 3\n        },\n        {\n            id: \"course-nlp-basics\",\n            title: \"Procesamiento de Lenguaje Natural\",\n            description: \"Explora c\\xf3mo las m\\xe1quinas entienden y generan lenguaje humano\",\n            category: \"theory\",\n            difficulty: 3,\n            imageUrl: (0,_image_fallbacks__WEBPACK_IMPORTED_MODULE_0__.getImageWithFallback)(\"course-nlp-basics\", \"nlp\"),\n            progress: 75,\n            totalLessons: 5,\n            completedLessons: 4,\n            isActive: true,\n            sortOrder: 4\n        },\n        {\n            id: \"course-ai-ethics\",\n            title: \"\\xc9tica en Inteligencia Artificial\",\n            description: \"Comprende los aspectos \\xe9ticos y sociales del desarrollo de IA responsable\",\n            category: \"theory\",\n            difficulty: 2,\n            imageUrl: (0,_image_fallbacks__WEBPACK_IMPORTED_MODULE_0__.getImageWithFallback)(\"course-ai-ethics\", \"ai-ethics\"),\n            progress: 100,\n            totalLessons: 4,\n            completedLessons: 4,\n            isActive: true,\n            sortOrder: 5\n        }\n    ],\n    // Mock lessons for each course\n    lessons: {\n        \"course-ml-fundamentals\": [\n            {\n                id: \"lesson-ml-intro\",\n                title: \"\\xbfQu\\xe9 es Machine Learning?\",\n                description: \"Introducci\\xf3n conceptual al aprendizaje autom\\xe1tico con ejemplos pr\\xe1cticos\",\n                estimatedDuration: 600,\n                difficultyLevel: 1,\n                hasVideoContent: true,\n                hasCodeExamples: false,\n                hasQuiz: true,\n                isCompleted: true,\n                progress: 100\n            },\n            {\n                id: \"lesson-ml-types\",\n                title: \"Tipos de Aprendizaje Autom\\xe1tico\",\n                description: \"Supervisado, no supervisado y por refuerzo: cu\\xe1ndo usar cada uno\",\n                estimatedDuration: 900,\n                difficultyLevel: 2,\n                hasVideoContent: true,\n                hasCodeExamples: true,\n                hasQuiz: true,\n                isCompleted: true,\n                progress: 100\n            },\n            {\n                id: \"lesson-ml-algorithms\",\n                title: \"Algoritmos Fundamentales\",\n                description: \"Regresi\\xf3n lineal, \\xe1rboles de decisi\\xf3n y k-means explicados\",\n                estimatedDuration: 1200,\n                difficultyLevel: 2,\n                hasVideoContent: false,\n                hasCodeExamples: true,\n                hasQuiz: true,\n                isCompleted: true,\n                progress: 100\n            },\n            {\n                id: \"lesson-ml-evaluation\",\n                title: \"Evaluaci\\xf3n de Modelos\",\n                description: \"M\\xe9tricas y t\\xe9cnicas para medir el rendimiento de tus modelos\",\n                estimatedDuration: 800,\n                difficultyLevel: 3,\n                hasVideoContent: true,\n                hasCodeExamples: true,\n                hasQuiz: true,\n                isCompleted: false,\n                progress: 60\n            }\n        ],\n        \"course-prompt-engineering\": [\n            {\n                id: \"lesson-prompt-intro\",\n                title: \"Fundamentos de Prompt Engineering\",\n                description: \"Aprende los principios b\\xe1sicos para crear prompts efectivos\",\n                estimatedDuration: 600,\n                difficultyLevel: 1,\n                hasVideoContent: true,\n                hasCodeExamples: false,\n                hasQuiz: true,\n                isCompleted: true,\n                progress: 100\n            },\n            {\n                id: \"lesson-prompt-advanced\",\n                title: \"T\\xe9cnicas Avanzadas\",\n                description: \"Chain-of-thought, few-shot learning y m\\xe1s t\\xe9cnicas avanzadas\",\n                estimatedDuration: 900,\n                difficultyLevel: 3,\n                hasVideoContent: true,\n                hasCodeExamples: true,\n                hasQuiz: true,\n                isCompleted: false,\n                progress: 0\n            }\n        ]\n    },\n    // Mock exercises\n    exercises: [\n        {\n            id: \"exercise-regression-basic\",\n            title: \"Implementa Regresi\\xf3n Lineal Simple\",\n            description: \"Crea un modelo de regresi\\xf3n lineal desde cero usando Python\",\n            instructions: [\n                \"Importa las librer\\xedas necesarias (numpy, matplotlib)\",\n                \"Carga el dataset de precios de casas\",\n                \"Implementa la funci\\xf3n de costo\",\n                \"Usa gradiente descendente para optimizar\",\n                \"Visualiza los resultados\"\n            ],\n            starterCode: `import numpy as np\nimport matplotlib.pyplot as plt\n\n# TODO: Implementa aquí tu solución\ndef linear_regression(X, y, learning_rate=0.01, epochs=1000):\n    # Tu código aquí\n    pass\n\n# Datos de ejemplo\nX = np.array([1, 2, 3, 4, 5])\ny = np.array([2, 4, 6, 8, 10])`,\n            expectedOutput: \"Un modelo entrenado que prediga correctamente los valores de y\",\n            evaluationCriteria: [\n                \"Implementaci\\xf3n correcta del algoritmo\",\n                \"Uso apropiado de numpy\",\n                \"C\\xf3digo limpio y bien comentado\",\n                \"Visualizaci\\xf3n de resultados\"\n            ],\n            hints: [\n                \"Recuerda normalizar los datos antes de entrenar\",\n                \"La funci\\xf3n de costo deber\\xeda decrecer en cada \\xe9poca\"\n            ],\n            difficulty: 2,\n            exerciseType: \"coding\"\n        }\n    ],\n    // Mock conversations\n    conversations: [\n        {\n            id: \"conv-demo-1\",\n            userId: \"demo_john_doe\",\n            title: \"Consulta sobre redes neuronales\",\n            context: {\n                emotional_state: \"engaged\",\n                adaptation_count: 1,\n                topic: \"neural networks\"\n            },\n            isActive: true,\n            createdAt: new Date(Date.now() - 86400000).toISOString(),\n            messages: [\n                {\n                    id: \"msg-1\",\n                    content: \"\\xbfPuedes explicarme c\\xf3mo funcionan las redes neuronales?\",\n                    role: \"user\",\n                    createdAt: new Date(Date.now() - 86400000).toISOString()\n                },\n                {\n                    id: \"msg-2\",\n                    content: \"Las redes neuronales son sistemas computacionales inspirados en el funcionamiento del cerebro humano...\",\n                    role: \"assistant\",\n                    createdAt: new Date(Date.now() - 86340000).toISOString()\n                }\n            ]\n        }\n    ],\n    // Mock user progress\n    userProgress: {\n        \"demo_john_doe\": {\n            totalLessonsCompleted: 12,\n            currentStreak: 5,\n            coursesInProgress: 3,\n            avgSessionTime: 18,\n            recentActivity: [\n                {\n                    id: \"activity-1\",\n                    type: \"lesson_completed\",\n                    title: \"Algoritmos Fundamentales\",\n                    courseName: \"Machine Learning Fundamentals\",\n                    timestamp: new Date(Date.now() - 3600000).toISOString(),\n                    score: 85\n                },\n                {\n                    id: \"activity-2\",\n                    type: \"exercise_submitted\",\n                    title: \"Implementa Regresi\\xf3n Lineal\",\n                    courseName: \"Machine Learning Fundamentals\",\n                    timestamp: new Date(Date.now() - 7200000).toISOString(),\n                    score: 92\n                }\n            ]\n        }\n    }\n};\n// Helper function to check if user is demo user\nfunction isDemoUser(userId) {\n    return !!(userId && (userId.startsWith(\"demo_\") || userId.startsWith(\"temp_\")));\n}\n// Helper function to get demo user data\nfunction getDemoUser(userId) {\n    return mockData.demoUsers[userId] || null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNQd0MsWUFBWTtvQkFDWkMsV0FBVyxJQUFJNUMsS0FBS0EsS0FBS2tDLEdBQUcsS0FBSyxTQUFTakMsV0FBVztvQkFDckQ0QyxPQUFPO2dCQUNUO2FBQ0Q7UUFDSDtJQUNGO0FBQ0YsRUFBRTtBQUVGLGdEQUFnRDtBQUN6QyxTQUFTQyxXQUFXbEIsTUFBZTtJQUN4QyxPQUFPLENBQUMsQ0FBRUEsQ0FBQUEsVUFBV0EsQ0FBQUEsT0FBT21CLFVBQVUsQ0FBQyxZQUFZbkIsT0FBT21CLFVBQVUsQ0FBQyxRQUFPLENBQUM7QUFDL0U7QUFFQSx3Q0FBd0M7QUFDakMsU0FBU0MsWUFBWXBCLE1BQWM7SUFDeEMsT0FBTyxTQUFVdEQsU0FBUyxDQUFTc0QsT0FBTyxJQUFJO0FBQ2hEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwLy4vbGliL21vY2stZGF0YS50cz83ZjZhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIE1vY2sgZGF0YSBoZWxwZXIgZm9yIFByb2ZBSSBkZW1vIG1vZGVcbi8vIFRoaXMgcHJvdmlkZXMgZmFsbGJhY2sgZGF0YSB3aGVuIGRhdGFiYXNlIGlzIHVuYXZhaWxhYmxlXG5cbmltcG9ydCB7IGdldEltYWdlV2l0aEZhbGxiYWNrIH0gZnJvbSAnLi9pbWFnZS1mYWxsYmFja3MnO1xuXG5leHBvcnQgY29uc3QgbW9ja0RhdGEgPSB7XG4gIC8vIERlbW8gdXNlcnNcbiAgZGVtb1VzZXJzOiB7XG4gICAgJ2RlbW9fam9obl9kb2UnOiB7XG4gICAgICBpZDogJ2RlbW9fam9obl9kb2UnLFxuICAgICAgZW1haWw6ICdqb2huQGRvZS5jb20nLFxuICAgICAgbmFtZTogJ0pvaG4gRG9lJyxcbiAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxuICAgICAgbGFzdE5hbWU6ICdEb2UnLFxuICAgICAgbGVhcm5pbmdTdHlsZToge1xuICAgICAgICB2aXN1YWw6IDAuOCxcbiAgICAgICAgYXVkaXRvcnk6IDAuNixcbiAgICAgICAga2luZXN0aGV0aWM6IDAuN1xuICAgICAgfSxcbiAgICAgIHNraWxsTGV2ZWw6IHtcbiAgICAgICAgdGhlb3J5OiAnaW50ZXJtZWRpYXRlJyxcbiAgICAgICAgdG9vbGluZzogJ2JlZ2lubmVyJyxcbiAgICAgICAgcHJvbXB0aW5nOiAnaW50ZXJtZWRpYXRlJ1xuICAgICAgfSxcbiAgICAgIGVtb3Rpb25CYXNlbGluZToge1xuICAgICAgICBjb25mdXNpb25fdGhyZXNob2xkOiAwLjcsXG4gICAgICAgIGZydXN0cmF0aW9uX3RocmVzaG9sZDogMC42LFxuICAgICAgICBlbmdhZ2VtZW50X2Jhc2VsaW5lOiAwLjVcbiAgICAgIH0sXG4gICAgICBwcmVmZXJlbmNlczoge1xuICAgICAgICBwcmVmZXJyZWRfZm9ybWF0OiAnaHlicmlkJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlcycsXG4gICAgICAgIHBhY2U6ICdub3JtYWwnLFxuICAgICAgICBkaWZmaWN1bHR5X3ByZWZlcmVuY2U6ICdhZGFwdGl2ZSdcbiAgICAgIH0sXG4gICAgICB0b3RhbExlc3NvbnNDb21wbGV0ZWQ6IDEyLFxuICAgICAgY3VycmVudFN0cmVhazogNSxcbiAgICAgIGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSxcbiAgICAnZGVtb19wcm9mYWknOiB7XG4gICAgICBpZDogJ2RlbW9fcHJvZmFpJyxcbiAgICAgIGVtYWlsOiAnZGVtb0Bwcm9mYWkuY29tJyxcbiAgICAgIG5hbWU6ICdEZW1vIFVzZXInLFxuICAgICAgZmlyc3ROYW1lOiAnRGVtbycsXG4gICAgICBsYXN0TmFtZTogJ1VzZXInLFxuICAgICAgbGVhcm5pbmdTdHlsZToge1xuICAgICAgICB2aXN1YWw6IDAuNyxcbiAgICAgICAgYXVkaXRvcnk6IDAuNSxcbiAgICAgICAga2luZXN0aGV0aWM6IDAuNlxuICAgICAgfSxcbiAgICAgIHNraWxsTGV2ZWw6IHtcbiAgICAgICAgdGhlb3J5OiAnYmVnaW5uZXInLFxuICAgICAgICB0b29saW5nOiAnYmVnaW5uZXInLFxuICAgICAgICBwcm9tcHRpbmc6ICdiZWdpbm5lcidcbiAgICAgIH0sXG4gICAgICBlbW90aW9uQmFzZWxpbmU6IHtcbiAgICAgICAgY29uZnVzaW9uX3RocmVzaG9sZDogMC43LFxuICAgICAgICBmcnVzdHJhdGlvbl90aHJlc2hvbGQ6IDAuNixcbiAgICAgICAgZW5nYWdlbWVudF9iYXNlbGluZTogMC41XG4gICAgICB9LFxuICAgICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgICAgcHJlZmVycmVkX2Zvcm1hdDogJ2h5YnJpZCcsXG4gICAgICAgIGxhbmd1YWdlOiAnZXMnLFxuICAgICAgICBwYWNlOiAnbm9ybWFsJyxcbiAgICAgICAgZGlmZmljdWx0eV9wcmVmZXJlbmNlOiAnYWRhcHRpdmUnXG4gICAgICB9LFxuICAgICAgdG90YWxMZXNzb25zQ29tcGxldGVkOiAzLFxuICAgICAgY3VycmVudFN0cmVhazogMSxcbiAgICAgIGxhc3RBY3RpdmVBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfVxuICB9LFxuXG4gIC8vIE1vY2sgY291cnNlc1xuICBjb3Vyc2VzOiBbXG4gICAge1xuICAgICAgaWQ6ICdjb3Vyc2UtbWwtZnVuZGFtZW50YWxzJyxcbiAgICAgIHRpdGxlOiAnTWFjaGluZSBMZWFybmluZyBGdW5kYW1lbnRhbHMnLFxuICAgICAgZGVzY3JpcHRpb246ICdBcHJlbmRlIGxvcyBjb25jZXB0b3MgYsOhc2ljb3MgZGUgTWFjaGluZSBMZWFybmluZyBjb24gZWplbXBsb3MgcHLDoWN0aWNvcyB5IHRlb3LDrWEgYXBsaWNhZGEnLFxuICAgICAgY2F0ZWdvcnk6ICd0aGVvcnknLFxuICAgICAgZGlmZmljdWx0eTogMixcbiAgICAgIGltYWdlVXJsOiBnZXRJbWFnZVdpdGhGYWxsYmFjaygnY291cnNlLW1sLWZ1bmRhbWVudGFscycsICdtYWNoaW5lLWxlYXJuaW5nJyksXG4gICAgICBwcm9ncmVzczogNDUsXG4gICAgICB0b3RhbExlc3NvbnM6IDgsXG4gICAgICBjb21wbGV0ZWRMZXNzb25zOiAzLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzb3J0T3JkZXI6IDFcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnY291cnNlLXByb21wdC1lbmdpbmVlcmluZycsXG4gICAgICB0aXRsZTogJ1Byb21wdCBFbmdpbmVlcmluZyBBdmFuemFkbycsXG4gICAgICBkZXNjcmlwdGlvbjogJ0RvbWluYSBlbCBhcnRlIGRlIGNyZWFyIHByb21wdHMgZWZlY3Rpdm9zIHBhcmEgbWF4aW1pemFyIGVsIHBvdGVuY2lhbCBkZSBsYXMgSUFzIGdlbmVyYXRpdmFzJyxcbiAgICAgIGNhdGVnb3J5OiAndG9vbGluZycsXG4gICAgICBkaWZmaWN1bHR5OiAzLFxuICAgICAgaW1hZ2VVcmw6IGdldEltYWdlV2l0aEZhbGxiYWNrKCdjb3Vyc2UtcHJvbXB0LWVuZ2luZWVyaW5nJywgJ3Byb21wdC1lbmdpbmVlcmluZycpLFxuICAgICAgcHJvZ3Jlc3M6IDIwLFxuICAgICAgdG90YWxMZXNzb25zOiA2LFxuICAgICAgY29tcGxldGVkTGVzc29uczogMSxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgc29ydE9yZGVyOiAyXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ2NvdXJzZS1kZWVwLWxlYXJuaW5nJyxcbiAgICAgIHRpdGxlOiAnRGVlcCBMZWFybmluZyBjb24gUHlUb3JjaCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvbnN0cnV5ZSByZWRlcyBuZXVyb25hbGVzIHByb2Z1bmRhcyB5IGVudGllbmRlIGxvcyBhbGdvcml0bW9zIHF1ZSBwb3RlbmNpYW4gbGEgSUEgbW9kZXJuYScsXG4gICAgICBjYXRlZ29yeTogJ2h5YnJpZCcsXG4gICAgICBkaWZmaWN1bHR5OiA0LFxuICAgICAgaW1hZ2VVcmw6IGdldEltYWdlV2l0aEZhbGxiYWNrKCdjb3Vyc2UtZGVlcC1sZWFybmluZycsICdkZWVwLWxlYXJuaW5nJyksXG4gICAgICBwcm9ncmVzczogMCxcbiAgICAgIHRvdGFsTGVzc29uczogMTIsXG4gICAgICBjb21wbGV0ZWRMZXNzb25zOiAwLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzb3J0T3JkZXI6IDNcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnY291cnNlLW5scC1iYXNpY3MnLFxuICAgICAgdGl0bGU6ICdQcm9jZXNhbWllbnRvIGRlIExlbmd1YWplIE5hdHVyYWwnLFxuICAgICAgZGVzY3JpcHRpb246ICdFeHBsb3JhIGPDs21vIGxhcyBtw6FxdWluYXMgZW50aWVuZGVuIHkgZ2VuZXJhbiBsZW5ndWFqZSBodW1hbm8nLFxuICAgICAgY2F0ZWdvcnk6ICd0aGVvcnknLFxuICAgICAgZGlmZmljdWx0eTogMyxcbiAgICAgIGltYWdlVXJsOiBnZXRJbWFnZVdpdGhGYWxsYmFjaygnY291cnNlLW5scC1iYXNpY3MnLCAnbmxwJyksXG4gICAgICBwcm9ncmVzczogNzUsXG4gICAgICB0b3RhbExlc3NvbnM6IDUsXG4gICAgICBjb21wbGV0ZWRMZXNzb25zOiA0LFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBzb3J0T3JkZXI6IDRcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnY291cnNlLWFpLWV0aGljcycsXG4gICAgICB0aXRsZTogJ8OJdGljYSBlbiBJbnRlbGlnZW5jaWEgQXJ0aWZpY2lhbCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvbXByZW5kZSBsb3MgYXNwZWN0b3Mgw6l0aWNvcyB5IHNvY2lhbGVzIGRlbCBkZXNhcnJvbGxvIGRlIElBIHJlc3BvbnNhYmxlJyxcbiAgICAgIGNhdGVnb3J5OiAndGhlb3J5JyxcbiAgICAgIGRpZmZpY3VsdHk6IDIsXG4gICAgICBpbWFnZVVybDogZ2V0SW1hZ2VXaXRoRmFsbGJhY2soJ2NvdXJzZS1haS1ldGhpY3MnLCAnYWktZXRoaWNzJyksXG4gICAgICBwcm9ncmVzczogMTAwLFxuICAgICAgdG90YWxMZXNzb25zOiA0LFxuICAgICAgY29tcGxldGVkTGVzc29uczogNCxcbiAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgc29ydE9yZGVyOiA1XG4gICAgfVxuICBdLFxuXG4gIC8vIE1vY2sgbGVzc29ucyBmb3IgZWFjaCBjb3Vyc2VcbiAgbGVzc29uczoge1xuICAgICdjb3Vyc2UtbWwtZnVuZGFtZW50YWxzJzogW1xuICAgICAge1xuICAgICAgICBpZDogJ2xlc3Nvbi1tbC1pbnRybycsXG4gICAgICAgIHRpdGxlOiAnwr9RdcOpIGVzIE1hY2hpbmUgTGVhcm5pbmc/JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdJbnRyb2R1Y2Npw7NuIGNvbmNlcHR1YWwgYWwgYXByZW5kaXphamUgYXV0b23DoXRpY28gY29uIGVqZW1wbG9zIHByw6FjdGljb3MnLFxuICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogNjAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDEsXG4gICAgICAgIGhhc1ZpZGVvQ29udGVudDogdHJ1ZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiBmYWxzZSxcbiAgICAgICAgaGFzUXVpejogdHJ1ZSxcbiAgICAgICAgaXNDb21wbGV0ZWQ6IHRydWUsXG4gICAgICAgIHByb2dyZXNzOiAxMDBcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAnbGVzc29uLW1sLXR5cGVzJyxcbiAgICAgICAgdGl0bGU6ICdUaXBvcyBkZSBBcHJlbmRpemFqZSBBdXRvbcOhdGljbycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnU3VwZXJ2aXNhZG8sIG5vIHN1cGVydmlzYWRvIHkgcG9yIHJlZnVlcnpvOiBjdcOhbmRvIHVzYXIgY2FkYSB1bm8nLFxuICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogOTAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDIsXG4gICAgICAgIGhhc1ZpZGVvQ29udGVudDogdHJ1ZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiB0cnVlLFxuICAgICAgICBoYXNRdWl6OiB0cnVlLFxuICAgICAgICBpc0NvbXBsZXRlZDogdHJ1ZSxcbiAgICAgICAgcHJvZ3Jlc3M6IDEwMFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdsZXNzb24tbWwtYWxnb3JpdGhtcycsXG4gICAgICAgIHRpdGxlOiAnQWxnb3JpdG1vcyBGdW5kYW1lbnRhbGVzJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdSZWdyZXNpw7NuIGxpbmVhbCwgw6FyYm9sZXMgZGUgZGVjaXNpw7NuIHkgay1tZWFucyBleHBsaWNhZG9zJyxcbiAgICAgICAgZXN0aW1hdGVkRHVyYXRpb246IDEyMDAsXG4gICAgICAgIGRpZmZpY3VsdHlMZXZlbDogMixcbiAgICAgICAgaGFzVmlkZW9Db250ZW50OiBmYWxzZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiB0cnVlLFxuICAgICAgICBoYXNRdWl6OiB0cnVlLFxuICAgICAgICBpc0NvbXBsZXRlZDogdHJ1ZSxcbiAgICAgICAgcHJvZ3Jlc3M6IDEwMFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdsZXNzb24tbWwtZXZhbHVhdGlvbicsXG4gICAgICAgIHRpdGxlOiAnRXZhbHVhY2nDs24gZGUgTW9kZWxvcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTcOpdHJpY2FzIHkgdMOpY25pY2FzIHBhcmEgbWVkaXIgZWwgcmVuZGltaWVudG8gZGUgdHVzIG1vZGVsb3MnLFxuICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogODAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDMsXG4gICAgICAgIGhhc1ZpZGVvQ29udGVudDogdHJ1ZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiB0cnVlLFxuICAgICAgICBoYXNRdWl6OiB0cnVlLFxuICAgICAgICBpc0NvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgIHByb2dyZXNzOiA2MFxuICAgICAgfVxuICAgIF0sXG4gICAgJ2NvdXJzZS1wcm9tcHQtZW5naW5lZXJpbmcnOiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnbGVzc29uLXByb21wdC1pbnRybycsXG4gICAgICAgIHRpdGxlOiAnRnVuZGFtZW50b3MgZGUgUHJvbXB0IEVuZ2luZWVyaW5nJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBcHJlbmRlIGxvcyBwcmluY2lwaW9zIGLDoXNpY29zIHBhcmEgY3JlYXIgcHJvbXB0cyBlZmVjdGl2b3MnLFxuICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogNjAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDEsXG4gICAgICAgIGhhc1ZpZGVvQ29udGVudDogdHJ1ZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiBmYWxzZSxcbiAgICAgICAgaGFzUXVpejogdHJ1ZSxcbiAgICAgICAgaXNDb21wbGV0ZWQ6IHRydWUsXG4gICAgICAgIHByb2dyZXNzOiAxMDBcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAnbGVzc29uLXByb21wdC1hZHZhbmNlZCcsXG4gICAgICAgIHRpdGxlOiAnVMOpY25pY2FzIEF2YW56YWRhcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ2hhaW4tb2YtdGhvdWdodCwgZmV3LXNob3QgbGVhcm5pbmcgeSBtw6FzIHTDqWNuaWNhcyBhdmFuemFkYXMnLFxuICAgICAgICBlc3RpbWF0ZWREdXJhdGlvbjogOTAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDMsXG4gICAgICAgIGhhc1ZpZGVvQ29udGVudDogdHJ1ZSxcbiAgICAgICAgaGFzQ29kZUV4YW1wbGVzOiB0cnVlLFxuICAgICAgICBoYXNRdWl6OiB0cnVlLFxuICAgICAgICBpc0NvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgIHByb2dyZXNzOiAwXG4gICAgICB9XG4gICAgXVxuICB9IGFzIHsgW2tleTogc3RyaW5nXTogYW55W10gfSxcblxuICAvLyBNb2NrIGV4ZXJjaXNlc1xuICBleGVyY2lzZXM6IFtcbiAgICB7XG4gICAgICBpZDogJ2V4ZXJjaXNlLXJlZ3Jlc3Npb24tYmFzaWMnLFxuICAgICAgdGl0bGU6ICdJbXBsZW1lbnRhIFJlZ3Jlc2nDs24gTGluZWFsIFNpbXBsZScsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NyZWEgdW4gbW9kZWxvIGRlIHJlZ3Jlc2nDs24gbGluZWFsIGRlc2RlIGNlcm8gdXNhbmRvIFB5dGhvbicsXG4gICAgICBpbnN0cnVjdGlvbnM6IFtcbiAgICAgICAgJ0ltcG9ydGEgbGFzIGxpYnJlcsOtYXMgbmVjZXNhcmlhcyAobnVtcHksIG1hdHBsb3RsaWIpJyxcbiAgICAgICAgJ0NhcmdhIGVsIGRhdGFzZXQgZGUgcHJlY2lvcyBkZSBjYXNhcycsXG4gICAgICAgICdJbXBsZW1lbnRhIGxhIGZ1bmNpw7NuIGRlIGNvc3RvJyxcbiAgICAgICAgJ1VzYSBncmFkaWVudGUgZGVzY2VuZGVudGUgcGFyYSBvcHRpbWl6YXInLFxuICAgICAgICAnVmlzdWFsaXphIGxvcyByZXN1bHRhZG9zJ1xuICAgICAgXSxcbiAgICAgIHN0YXJ0ZXJDb2RlOiBgaW1wb3J0IG51bXB5IGFzIG5wXG5pbXBvcnQgbWF0cGxvdGxpYi5weXBsb3QgYXMgcGx0XG5cbiMgVE9ETzogSW1wbGVtZW50YSBhcXXDrSB0dSBzb2x1Y2nDs25cbmRlZiBsaW5lYXJfcmVncmVzc2lvbihYLCB5LCBsZWFybmluZ19yYXRlPTAuMDEsIGVwb2Nocz0xMDAwKTpcbiAgICAjIFR1IGPDs2RpZ28gYXF1w61cbiAgICBwYXNzXG5cbiMgRGF0b3MgZGUgZWplbXBsb1xuWCA9IG5wLmFycmF5KFsxLCAyLCAzLCA0LCA1XSlcbnkgPSBucC5hcnJheShbMiwgNCwgNiwgOCwgMTBdKWAsXG4gICAgICBleHBlY3RlZE91dHB1dDogJ1VuIG1vZGVsbyBlbnRyZW5hZG8gcXVlIHByZWRpZ2EgY29ycmVjdGFtZW50ZSBsb3MgdmFsb3JlcyBkZSB5JyxcbiAgICAgIGV2YWx1YXRpb25Dcml0ZXJpYTogW1xuICAgICAgICAnSW1wbGVtZW50YWNpw7NuIGNvcnJlY3RhIGRlbCBhbGdvcml0bW8nLFxuICAgICAgICAnVXNvIGFwcm9waWFkbyBkZSBudW1weScsXG4gICAgICAgICdDw7NkaWdvIGxpbXBpbyB5IGJpZW4gY29tZW50YWRvJyxcbiAgICAgICAgJ1Zpc3VhbGl6YWNpw7NuIGRlIHJlc3VsdGFkb3MnXG4gICAgICBdLFxuICAgICAgaGludHM6IFtcbiAgICAgICAgJ1JlY3VlcmRhIG5vcm1hbGl6YXIgbG9zIGRhdG9zIGFudGVzIGRlIGVudHJlbmFyJyxcbiAgICAgICAgJ0xhIGZ1bmNpw7NuIGRlIGNvc3RvIGRlYmVyw61hIGRlY3JlY2VyIGVuIGNhZGEgw6lwb2NhJ1xuICAgICAgXSxcbiAgICAgIGRpZmZpY3VsdHk6IDIsXG4gICAgICBleGVyY2lzZVR5cGU6ICdjb2RpbmcnXG4gICAgfVxuICBdLFxuXG4gIC8vIE1vY2sgY29udmVyc2F0aW9uc1xuICBjb252ZXJzYXRpb25zOiBbXG4gICAge1xuICAgICAgaWQ6ICdjb252LWRlbW8tMScsXG4gICAgICB1c2VySWQ6ICdkZW1vX2pvaG5fZG9lJyxcbiAgICAgIHRpdGxlOiAnQ29uc3VsdGEgc29icmUgcmVkZXMgbmV1cm9uYWxlcycsXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIGVtb3Rpb25hbF9zdGF0ZTogJ2VuZ2FnZWQnLFxuICAgICAgICBhZGFwdGF0aW9uX2NvdW50OiAxLFxuICAgICAgICB0b3BpYzogJ25ldXJhbCBuZXR3b3JrcydcbiAgICAgIH0sXG4gICAgICBpc0FjdGl2ZTogdHJ1ZSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDg2NDAwMDAwKS50b0lTT1N0cmluZygpLCAvLyAxIGRheSBhZ29cbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ21zZy0xJyxcbiAgICAgICAgICBjb250ZW50OiAnwr9QdWVkZXMgZXhwbGljYXJtZSBjw7NtbyBmdW5jaW9uYW4gbGFzIHJlZGVzIG5ldXJvbmFsZXM/JyxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gODY0MDAwMDApLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnbXNnLTInLFxuICAgICAgICAgIGNvbnRlbnQ6ICdMYXMgcmVkZXMgbmV1cm9uYWxlcyBzb24gc2lzdGVtYXMgY29tcHV0YWNpb25hbGVzIGluc3BpcmFkb3MgZW4gZWwgZnVuY2lvbmFtaWVudG8gZGVsIGNlcmVicm8gaHVtYW5vLi4uJyxcbiAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSA4NjM0MDAwMCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICBdXG4gICAgfVxuICBdLFxuXG4gIC8vIE1vY2sgdXNlciBwcm9ncmVzc1xuICB1c2VyUHJvZ3Jlc3M6IHtcbiAgICAnZGVtb19qb2huX2RvZSc6IHtcbiAgICAgIHRvdGFsTGVzc29uc0NvbXBsZXRlZDogMTIsXG4gICAgICBjdXJyZW50U3RyZWFrOiA1LFxuICAgICAgY291cnNlc0luUHJvZ3Jlc3M6IDMsXG4gICAgICBhdmdTZXNzaW9uVGltZTogMTgsXG4gICAgICByZWNlbnRBY3Rpdml0eTogW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdhY3Rpdml0eS0xJyxcbiAgICAgICAgICB0eXBlOiAnbGVzc29uX2NvbXBsZXRlZCcsXG4gICAgICAgICAgdGl0bGU6ICdBbGdvcml0bW9zIEZ1bmRhbWVudGFsZXMnLFxuICAgICAgICAgIGNvdXJzZU5hbWU6ICdNYWNoaW5lIExlYXJuaW5nIEZ1bmRhbWVudGFscycsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzYwMDAwMCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBzY29yZTogODVcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnYWN0aXZpdHktMicsXG4gICAgICAgICAgdHlwZTogJ2V4ZXJjaXNlX3N1Ym1pdHRlZCcsXG4gICAgICAgICAgdGl0bGU6ICdJbXBsZW1lbnRhIFJlZ3Jlc2nDs24gTGluZWFsJyxcbiAgICAgICAgICBjb3Vyc2VOYW1lOiAnTWFjaGluZSBMZWFybmluZyBGdW5kYW1lbnRhbHMnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDcyMDAwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgc2NvcmU6IDkyXG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9XG4gIH1cbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBjaGVjayBpZiB1c2VyIGlzIGRlbW8gdXNlclxuZXhwb3J0IGZ1bmN0aW9uIGlzRGVtb1VzZXIodXNlcklkPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAhISh1c2VySWQgJiYgKHVzZXJJZC5zdGFydHNXaXRoKCdkZW1vXycpIHx8IHVzZXJJZC5zdGFydHNXaXRoKCd0ZW1wXycpKSk7XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgZGVtbyB1c2VyIGRhdGFcbmV4cG9ydCBmdW5jdGlvbiBnZXREZW1vVXNlcih1c2VySWQ6IHN0cmluZykge1xuICByZXR1cm4gKG1vY2tEYXRhLmRlbW9Vc2VycyBhcyBhbnkpW3VzZXJJZF0gfHwgbnVsbDtcbn1cbiJdLCJuYW1lcyI6WyJnZXRJbWFnZVdpdGhGYWxsYmFjayIsIm1vY2tEYXRhIiwiZGVtb1VzZXJzIiwiaWQiLCJlbWFpbCIsIm5hbWUiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImxlYXJuaW5nU3R5bGUiLCJ2aXN1YWwiLCJhdWRpdG9yeSIsImtpbmVzdGhldGljIiwic2tpbGxMZXZlbCIsInRoZW9yeSIsInRvb2xpbmciLCJwcm9tcHRpbmciLCJlbW90aW9uQmFzZWxpbmUiLCJjb25mdXNpb25fdGhyZXNob2xkIiwiZnJ1c3RyYXRpb25fdGhyZXNob2xkIiwiZW5nYWdlbWVudF9iYXNlbGluZSIsInByZWZlcmVuY2VzIiwicHJlZmVycmVkX2Zvcm1hdCIsImxhbmd1YWdlIiwicGFjZSIsImRpZmZpY3VsdHlfcHJlZmVyZW5jZSIsInRvdGFsTGVzc29uc0NvbXBsZXRlZCIsImN1cnJlbnRTdHJlYWsiLCJsYXN0QWN0aXZlQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjb3Vyc2VzIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImNhdGVnb3J5IiwiZGlmZmljdWx0eSIsImltYWdlVXJsIiwicHJvZ3Jlc3MiLCJ0b3RhbExlc3NvbnMiLCJjb21wbGV0ZWRMZXNzb25zIiwiaXNBY3RpdmUiLCJzb3J0T3JkZXIiLCJsZXNzb25zIiwiZXN0aW1hdGVkRHVyYXRpb24iLCJkaWZmaWN1bHR5TGV2ZWwiLCJoYXNWaWRlb0NvbnRlbnQiLCJoYXNDb2RlRXhhbXBsZXMiLCJoYXNRdWl6IiwiaXNDb21wbGV0ZWQiLCJleGVyY2lzZXMiLCJpbnN0cnVjdGlvbnMiLCJzdGFydGVyQ29kZSIsImV4cGVjdGVkT3V0cHV0IiwiZXZhbHVhdGlvbkNyaXRlcmlhIiwiaGludHMiLCJleGVyY2lzZVR5cGUiLCJjb252ZXJzYXRpb25zIiwidXNlcklkIiwiY29udGV4dCIsImVtb3Rpb25hbF9zdGF0ZSIsImFkYXB0YXRpb25fY291bnQiLCJ0b3BpYyIsImNyZWF0ZWRBdCIsIm5vdyIsIm1lc3NhZ2VzIiwiY29udGVudCIsInJvbGUiLCJ1c2VyUHJvZ3Jlc3MiLCJjb3Vyc2VzSW5Qcm9ncmVzcyIsImF2Z1Nlc3Npb25UaW1lIiwicmVjZW50QWN0aXZpdHkiLCJ0eXBlIiwiY291cnNlTmFtZSIsInRpbWVzdGFtcCIsInNjb3JlIiwiaXNEZW1vVXNlciIsInN0YXJ0c1dpdGgiLCJnZXREZW1vVXNlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/mock-data.ts\n");

/***/ }),

/***/ "(rsc)/./lib/video-service.ts":
/*!******************************!*\
  !*** ./lib/video-service.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VideoService: () => (/* binding */ VideoService),\n/* harmony export */   videoService: () => (/* binding */ videoService)\n/* harmony export */ });\n/**\n * Enhanced Video Service for ProfAI\n * Manages YouTube video integration with educational content\n */ class VideoService {\n    constructor(youtubeApiKey){\n        this.youtubeApiKey = null;\n        // Educational AI/ML YouTube channels that typically allow embedding\n        this.trustedEducationalChannels = [\n            {\n                name: \"3Blue1Brown\",\n                channelId: \"UCYO_jab_esuFRV4b17AJtAw\",\n                category: \"mathematics\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"Two Minute Papers\",\n                channelId: \"UCbfYPyITQ-7l4upoX8nvctg\",\n                category: \"ai-research\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"Fireship\",\n                channelId: \"UCsBjURrPoezykLs9EqgamOA\",\n                category: \"programming\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"Computerphile\",\n                channelId: \"UC9-y-6csu5WGm29I7JiwpnA\",\n                category: \"computer-science\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"Crash Course Computer Science\",\n                channelId: \"UCsx5g1cECGBhEhBAa8kSJEQ\",\n                category: \"cs-education\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"StatQuest with Josh Starmer\",\n                channelId: \"UCtYLUTtgS3k1Fg4y5tAhLbw\",\n                category: \"statistics\",\n                quality: \"high\",\n                embedding: true\n            },\n            {\n                name: \"Sentdex\",\n                channelId: \"UCfzlCWGWYyIQ0aLC5w48gBQ\",\n                category: \"python-ml\",\n                quality: \"medium\",\n                embedding: true\n            },\n            {\n                name: \"Code Bullet\",\n                channelId: \"UC0e3QhIYukixgh5VVpKHH9Q\",\n                category: \"ai-programming\",\n                quality: \"medium\",\n                embedding: true\n            }\n        ];\n        // Curated educational videos by topic\n        this.curatedVideoDatabase = {\n            \"machine-learning\": [\n                {\n                    videoId: \"ukzFI9rgwfU\",\n                    title: \"Machine Learning Explained\",\n                    description: \"A comprehensive introduction to machine learning concepts\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/ukzFI9rgwfU/hqdefault.jpg\",\n                    channel: \"Zach Star\",\n                    educationalValue: \"high\",\n                    difficulty: \"beginner\",\n                    embeddable: true,\n                    language: \"en\"\n                },\n                {\n                    videoId: \"aircAruvnKk\",\n                    title: \"But what is a Neural Network?\",\n                    description: \"3Blue1Brown's excellent visual explanation of neural networks\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/aircAruvnKk/hqdefault.jpg\",\n                    channel: \"3Blue1Brown\",\n                    educationalValue: \"high\",\n                    difficulty: \"beginner\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"neural-networks\": [\n                {\n                    videoId: \"aircAruvnKk\",\n                    title: \"But what is a Neural Network?\",\n                    description: \"Visual and intuitive explanation of neural networks\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/aircAruvnKk/hqdefault.jpg\",\n                    channel: \"3Blue1Brown\",\n                    educationalValue: \"high\",\n                    difficulty: \"beginner\",\n                    embeddable: true,\n                    language: \"en\"\n                },\n                {\n                    videoId: \"IHZwWFHWa-w\",\n                    title: \"Neural Networks Explained\",\n                    description: \"Comprehensive neural network tutorial\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/IHZwWFHWa-w/hqdefault.jpg\",\n                    channel: \"Zach Star\",\n                    educationalValue: \"high\",\n                    difficulty: \"intermediate\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"deep-learning\": [\n                {\n                    videoId: \"R9OHn5ZF4Uo\",\n                    title: \"Deep Learning in 5 Minutes\",\n                    description: \"Quick introduction to deep learning concepts\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/R9OHn5ZF4Uo/hqdefault.jpg\",\n                    channel: \"Siraj Raval\",\n                    educationalValue: \"high\",\n                    difficulty: \"beginner\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"transformers\": [\n                {\n                    videoId: \"kCc8FmEb1nY\",\n                    title: \"Attention is All You Need (Transformer) - Model explanation\",\n                    description: \"Deep dive into transformer architecture\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/kCc8FmEb1nY/hqdefault.jpg\",\n                    channel: \"The A.I. Hacker - Michael Phi\",\n                    educationalValue: \"high\",\n                    difficulty: \"advanced\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"prompt-engineering\": [\n                {\n                    videoId: \"dOxUroR57xs\",\n                    title: \"Prompt Engineering Guide\",\n                    description: \"Complete guide to effective prompt engineering\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/dOxUroR57xs/hqdefault.jpg\",\n                    channel: \"AI Explained\",\n                    educationalValue: \"high\",\n                    difficulty: \"intermediate\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"computer-vision\": [\n                {\n                    videoId: \"SPuwxIyRpFI\",\n                    title: \"Computer Vision Explained\",\n                    description: \"Introduction to computer vision and image processing\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/SPuwxIyRpFI/hqdefault.jpg\",\n                    channel: \"Computerphile\",\n                    educationalValue: \"high\",\n                    difficulty: \"intermediate\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ],\n            \"nlp\": [\n                {\n                    videoId: \"CMrHM8a3hqw\",\n                    title: \"Natural Language Processing Explained\",\n                    description: \"Comprehensive introduction to NLP concepts\",\n                    thumbnailUrl: \"https://i.ytimg.com/vi/CMrHM8a3hqw/hqdefault.jpg\",\n                    channel: \"Computerphile\",\n                    educationalValue: \"high\",\n                    difficulty: \"intermediate\",\n                    embeddable: true,\n                    language: \"en\"\n                }\n            ]\n        };\n        this.youtubeApiKey = youtubeApiKey || process.env.YOUTUBE_API_KEY || null;\n    }\n    /**\n   * Find the most relevant video for a given topic and user context\n   */ findBestVideoForTopic(topic, difficulty = \"beginner\", language = \"en\") {\n        const normalizedTopic = this.normalizeTopic(topic);\n        // First, try exact match in curated database\n        let videos = this.curatedVideoDatabase[normalizedTopic] || [];\n        // If no exact match, try fuzzy matching\n        if (videos.length === 0) {\n            videos = this.findVideosByFuzzyMatch(topic);\n        }\n        // Filter by criteria\n        const filteredVideos = videos.filter((video)=>{\n            const difficultyMatch = !video.difficulty || this.isDifficultyMatch(video.difficulty, difficulty);\n            const languageMatch = !video.language || video.language === language || language === \"any\";\n            const embeddable = video.embeddable !== false;\n            return difficultyMatch && languageMatch && embeddable;\n        });\n        // Sort by relevance and educational value\n        const videosCopy = [\n            ...filteredVideos\n        ];\n        const sortedVideos = videosCopy.sort((a, b)=>{\n            const aScore = this.calculateRelevanceScore(a, topic, difficulty);\n            const bScore = this.calculateRelevanceScore(b, topic, difficulty);\n            return bScore - aScore;\n        });\n        return sortedVideos[0] || null;\n    }\n    /**\n   * Get multiple video recommendations for a topic (internal implementation)\n   */ getVideoRecommendationsInternal(topic, count = 3, criteria) {\n        const normalizedTopic = this.normalizeTopic(topic);\n        let videos = this.curatedVideoDatabase[normalizedTopic] || [];\n        // Add fuzzy matches\n        videos = [\n            ...videos,\n            ...this.findVideosByFuzzyMatch(topic)\n        ];\n        // Remove duplicates\n        videos = videos.filter((video, index, self)=>index === self.findIndex((v)=>v.videoId === video.videoId));\n        // Apply criteria filters\n        if (criteria) {\n            videos = this.applySearchCriteria(videos, criteria);\n        }\n        // Sort and limit\n        const videosCopy = [\n            ...videos\n        ];\n        const sortedVideos = videosCopy.sort((a, b)=>this.calculateRelevanceScore(b, topic, criteria?.difficulty) - this.calculateRelevanceScore(a, topic, criteria?.difficulty));\n        return sortedVideos.slice(0, count);\n    }\n    /**\n   * Get video recommendations using search criteria object\n   */ async getVideoRecommendationsByCriteria(criteria) {\n        const topic = criteria.topic;\n        const count = 3; // Default count\n        // Use the existing method with the criteria as third parameter\n        return Promise.resolve(this.getVideoRecommendationsInternal(topic, count, criteria));\n    }\n    /**\n   * Get multiple video recommendations for a topic\n   */ getVideoRecommendations(topic, count = 3, criteria) {\n        return this.getVideoRecommendationsInternal(topic, count, criteria);\n    }\n    /**\n   * Create a learning playlist for a topic\n   */ createLearningPlaylist(topic, difficulty = \"beginner\") {\n        const videos = this.getVideoRecommendations(topic, 5, {\n            difficulty,\n            educationalOnly: true\n        });\n        return {\n            id: `playlist_${topic}_${difficulty}_${Date.now()}`,\n            title: `${topic.charAt(0).toUpperCase() + topic.slice(1)} - ${difficulty} level`,\n            description: `Curated learning playlist for ${topic} at ${difficulty} level`,\n            videos,\n            topic,\n            totalDuration: videos.reduce((total, video)=>{\n                const duration = this.parseDuration(video.duration || \"0:00\");\n                return total + duration;\n            }, 0)\n        };\n    }\n    /**\n   * Check if a video is embeddable (placeholder for real API check)\n   */ async checkEmbeddable(videoId) {\n        // This would require YouTube API to check oembed endpoint\n        // For now, return true for curated videos\n        const allVideos = Object.values(this.curatedVideoDatabase).flat();\n        const video = allVideos.find((v)=>v.videoId === videoId);\n        return video?.embeddable !== false;\n    }\n    /**\n   * Get video metadata from YouTube API (if available)\n   */ async getVideoMetadata(videoId) {\n        if (!this.youtubeApiKey) {\n            // Fallback to curated data\n            const allVideos = Object.values(this.curatedVideoDatabase).flat();\n            return allVideos.find((v)=>v.videoId === videoId) || null;\n        }\n        try {\n            // YouTube API call would go here\n            // For now, return curated data\n            const allVideos = Object.values(this.curatedVideoDatabase).flat();\n            return allVideos.find((v)=>v.videoId === videoId) || null;\n        } catch (error) {\n            console.error(\"Error fetching video metadata:\", error);\n            return null;\n        }\n    }\n    /**\n   * Generate video embed URL\n   */ getEmbedUrl(videoId, options) {\n        const baseUrl = `https://www.youtube.com/embed/${videoId}`;\n        const params = new URLSearchParams();\n        if (options?.autoplay) params.set(\"autoplay\", \"1\");\n        if (options?.start) params.set(\"start\", options.start.toString());\n        if (options?.end) params.set(\"end\", options.end.toString());\n        if (options?.modestbranding !== false) params.set(\"modestbranding\", \"1\");\n        // Educational-friendly defaults\n        params.set(\"rel\", \"0\"); // Don't show related videos\n        params.set(\"fs\", \"1\"); // Allow fullscreen\n        params.set(\"cc_load_policy\", \"1\"); // Show captions when available\n        return `${baseUrl}?${params.toString()}`;\n    }\n    // Private helper methods\n    normalizeTopic(topic) {\n        return topic.toLowerCase().replace(/\\s+/g, \"-\").replace(/[^\\w-]/g, \"\");\n    }\n    findVideosByFuzzyMatch(topic) {\n        const topicLower = topic.toLowerCase();\n        const matches = [];\n        for (const [key, videos] of Object.entries(this.curatedVideoDatabase)){\n            if (key.includes(topicLower) || topicLower.includes(key.replace(\"-\", \" \"))) {\n                matches.push(...videos);\n            }\n        }\n        return matches;\n    }\n    calculateRelevanceScore(video, topic, difficulty) {\n        let score = 0;\n        // Educational value weight\n        if (video.educationalValue === \"high\") score += 3;\n        else if (video.educationalValue === \"medium\") score += 2;\n        else score += 1;\n        // Difficulty match\n        if (difficulty && video.difficulty === difficulty) score += 2;\n        // Embeddable preference\n        if (video.embeddable) score += 1;\n        // Trusted channel bonus\n        if (this.isTrustedChannel(video.channel)) score += 2;\n        // Title relevance (simple keyword matching)\n        const titleLower = video.title.toLowerCase();\n        const topicLower = topic.toLowerCase();\n        if (titleLower.includes(topicLower)) score += 2;\n        return score;\n    }\n    isDifficultyMatch(videoDifficulty, requestedDifficulty) {\n        const levels = {\n            \"beginner\": 1,\n            \"intermediate\": 2,\n            \"advanced\": 3\n        };\n        const videoLevel = levels[videoDifficulty] || 2;\n        const requestedLevel = levels[requestedDifficulty] || 2;\n        // Allow videos one level up or down\n        return Math.abs(videoLevel - requestedLevel) <= 1;\n    }\n    applySearchCriteria(videos, criteria) {\n        return videos.filter((video)=>{\n            if (criteria.difficulty && !this.isDifficultyMatch(video.difficulty || \"intermediate\", criteria.difficulty)) {\n                return false;\n            }\n            if (criteria.language && video.language && video.language !== criteria.language) {\n                return false;\n            }\n            if (criteria.educationalOnly && video.educationalValue === \"low\") {\n                return false;\n            }\n            if (criteria.excludeChannels && video.channel && criteria.excludeChannels.includes(video.channel)) {\n                return false;\n            }\n            return true;\n        });\n    }\n    isTrustedChannel(channelName) {\n        if (!channelName) return false;\n        return this.trustedEducationalChannels.some((channel)=>channel.name === channelName);\n    }\n    parseDuration(duration) {\n        // Parse duration string like \"5:30\" to seconds\n        const parts = duration.split(\":\").reverse();\n        let seconds = 0;\n        parts.forEach((part, index)=>{\n            seconds += parseInt(part) * Math.pow(60, index);\n        });\n        return seconds;\n    }\n}\n// Create singleton instance\nconst videoService = new VideoService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU8sSUFBSStCLFNBQVM2RCxlQUFlLENBQUNaLFFBQVEsQ0FBQy9ELE1BQU1qQixPQUFPLEdBQUc7Z0JBQ2pHLE9BQU87WUFDVDtZQUVBLE9BQU87UUFDVDtJQUNGO0lBRVFtRixpQkFBaUJVLFdBQW9CLEVBQVc7UUFDdEQsSUFBSSxDQUFDQSxhQUFhLE9BQU87UUFDekIsT0FBTyxJQUFJLENBQUN4RywwQkFBMEIsQ0FBQ3lHLElBQUksQ0FDekM5RixDQUFBQSxVQUFXQSxRQUFRVixJQUFJLEtBQUt1RztJQUVoQztJQUVReEMsY0FBY0QsUUFBZ0IsRUFBVTtRQUM5QywrQ0FBK0M7UUFDL0MsTUFBTTJDLFFBQVEzQyxTQUFTNEMsS0FBSyxDQUFDLEtBQUtDLE9BQU87UUFDekMsSUFBSUMsVUFBVTtRQUVkSCxNQUFNSSxPQUFPLENBQUMsQ0FBQ0MsTUFBTXBFO1lBQ25Ca0UsV0FBV0csU0FBU0QsUUFBUVYsS0FBS1ksR0FBRyxDQUFDLElBQUl0RTtRQUMzQztRQUVBLE9BQU9rRTtJQUNUO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUssZUFBZSxJQUFJckgsZUFBZSIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC8uL2xpYi92aWRlby1zZXJ2aWNlLnRzPzUxNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmhhbmNlZCBWaWRlbyBTZXJ2aWNlIGZvciBQcm9mQUlcbiAqIE1hbmFnZXMgWW91VHViZSB2aWRlbyBpbnRlZ3JhdGlvbiB3aXRoIGVkdWNhdGlvbmFsIGNvbnRlbnRcbiAqL1xuXG5leHBvcnQgdHlwZSBEaWZmaWN1bHR5ID0gJ2JlZ2lubmVyJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJztcblxuZXhwb3J0IGludGVyZmFjZSBWaWRlb1JlY29tbWVuZGF0aW9uIHtcbiAgdmlkZW9JZDogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgZHVyYXRpb24/OiBzdHJpbmc7XG4gIHRodW1ibmFpbFVybDogc3RyaW5nO1xuICBjaGFubmVsPzogc3RyaW5nO1xuICByZWxldmFuY2VTY29yZT86IG51bWJlcjtcbiAgZW1iZWRkYWJsZT86IGJvb2xlYW47XG4gIGVkdWNhdGlvbmFsVmFsdWU/OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnO1xuICBkaWZmaWN1bHR5PzogRGlmZmljdWx0eTtcbiAgbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gIHB1Ymxpc2hlZEF0Pzogc3RyaW5nO1xuICB2aWV3Q291bnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlkZW9QbGF5bGlzdCB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHZpZGVvczogVmlkZW9SZWNvbW1lbmRhdGlvbltdO1xuICB0b3BpYzogc3RyaW5nO1xuICB0b3RhbER1cmF0aW9uPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpZGVvU2VhcmNoQ3JpdGVyaWEge1xuICB0b3BpYzogc3RyaW5nO1xuICBkaWZmaWN1bHR5PzogRGlmZmljdWx0eTtcbiAgbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gIG1heER1cmF0aW9uPzogbnVtYmVyOyAvLyBpbiBtaW51dGVzXG4gIGNoYW5uZWw/OiBzdHJpbmc7XG4gIGV4Y2x1ZGVDaGFubmVscz86IHN0cmluZ1tdO1xuICBlZHVjYXRpb25hbE9ubHk/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgVmlkZW9TZXJ2aWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSB5b3V0dWJlQXBpS2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICAvLyBFZHVjYXRpb25hbCBBSS9NTCBZb3VUdWJlIGNoYW5uZWxzIHRoYXQgdHlwaWNhbGx5IGFsbG93IGVtYmVkZGluZ1xuICBwcml2YXRlIHJlYWRvbmx5IHRydXN0ZWRFZHVjYXRpb25hbENoYW5uZWxzID0gW1xuICAgIHtcbiAgICAgIG5hbWU6ICczQmx1ZTFCcm93bicsXG4gICAgICBjaGFubmVsSWQ6ICdVQ1lPX2phYl9lc3VGUlY0YjE3QUp0QXcnLFxuICAgICAgY2F0ZWdvcnk6ICdtYXRoZW1hdGljcycsXG4gICAgICBxdWFsaXR5OiAnaGlnaCcsXG4gICAgICBlbWJlZGRpbmc6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdUd28gTWludXRlIFBhcGVycycsXG4gICAgICBjaGFubmVsSWQ6ICdVQ2JmWVB5SVRRLTdsNHVwb1g4bnZjdGcnLFxuICAgICAgY2F0ZWdvcnk6ICdhaS1yZXNlYXJjaCcsXG4gICAgICBxdWFsaXR5OiAnaGlnaCcsXG4gICAgICBlbWJlZGRpbmc6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdGaXJlc2hpcCcsXG4gICAgICBjaGFubmVsSWQ6ICdVQ3NCalVSclBvZXp5a0xzOUVxZ2FtT0EnLFxuICAgICAgY2F0ZWdvcnk6ICdwcm9ncmFtbWluZycsXG4gICAgICBxdWFsaXR5OiAnaGlnaCcsXG4gICAgICBlbWJlZGRpbmc6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdDb21wdXRlcnBoaWxlJyxcbiAgICAgIGNoYW5uZWxJZDogJ1VDOS15LTZjc3U1V0dtMjlJN0ppd3BuQScsXG4gICAgICBjYXRlZ29yeTogJ2NvbXB1dGVyLXNjaWVuY2UnLFxuICAgICAgcXVhbGl0eTogJ2hpZ2gnLFxuICAgICAgZW1iZWRkaW5nOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnQ3Jhc2ggQ291cnNlIENvbXB1dGVyIFNjaWVuY2UnLFxuICAgICAgY2hhbm5lbElkOiAnVUNzeDVnMWNFQ0dCaEVoQkFhOGtTSkVRJyxcbiAgICAgIGNhdGVnb3J5OiAnY3MtZWR1Y2F0aW9uJyxcbiAgICAgIHF1YWxpdHk6ICdoaWdoJyxcbiAgICAgIGVtYmVkZGluZzogdHJ1ZVxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ1N0YXRRdWVzdCB3aXRoIEpvc2ggU3Rhcm1lcicsXG4gICAgICBjaGFubmVsSWQ6ICdVQ3RZTFVUdGdTM2sxRmc0eTV0QWhMYncnLFxuICAgICAgY2F0ZWdvcnk6ICdzdGF0aXN0aWNzJyxcbiAgICAgIHF1YWxpdHk6ICdoaWdoJyxcbiAgICAgIGVtYmVkZGluZzogdHJ1ZVxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ1NlbnRkZXgnLFxuICAgICAgY2hhbm5lbElkOiAnVUNmemxDV0dXWXlJUTBhTEM1dzQ4Z0JRJyxcbiAgICAgIGNhdGVnb3J5OiAncHl0aG9uLW1sJyxcbiAgICAgIHF1YWxpdHk6ICdtZWRpdW0nLFxuICAgICAgZW1iZWRkaW5nOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnQ29kZSBCdWxsZXQnLFxuICAgICAgY2hhbm5lbElkOiAnVUMwZTNRaElZdWtpeGdoNVZWcEtISDlRJyxcbiAgICAgIGNhdGVnb3J5OiAnYWktcHJvZ3JhbW1pbmcnLFxuICAgICAgcXVhbGl0eTogJ21lZGl1bScsXG4gICAgICBlbWJlZGRpbmc6IHRydWVcbiAgICB9XG4gIF07XG5cbiAgLy8gQ3VyYXRlZCBlZHVjYXRpb25hbCB2aWRlb3MgYnkgdG9waWNcbiAgcHJpdmF0ZSByZWFkb25seSBjdXJhdGVkVmlkZW9EYXRhYmFzZTogUmVjb3JkPHN0cmluZywgVmlkZW9SZWNvbW1lbmRhdGlvbltdPiA9IHtcbiAgICAnbWFjaGluZS1sZWFybmluZyc6IFtcbiAgICAgIHtcbiAgICAgICAgdmlkZW9JZDogJ3VrekZJOXJnd2ZVJyxcbiAgICAgICAgdGl0bGU6ICdNYWNoaW5lIExlYXJuaW5nIEV4cGxhaW5lZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQSBjb21wcmVoZW5zaXZlIGludHJvZHVjdGlvbiB0byBtYWNoaW5lIGxlYXJuaW5nIGNvbmNlcHRzJyxcbiAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS91a3pGSTlyZ3dmVS9ocWRlZmF1bHQuanBnJyxcbiAgICAgICAgY2hhbm5lbDogJ1phY2ggU3RhcicsXG4gICAgICAgIGVkdWNhdGlvbmFsVmFsdWU6ICdoaWdoJyxcbiAgICAgICAgZGlmZmljdWx0eTogJ2JlZ2lubmVyJyxcbiAgICAgICAgZW1iZWRkYWJsZTogdHJ1ZSxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdhaXJjQXJ1dm5LaycsXG4gICAgICAgIHRpdGxlOiAnQnV0IHdoYXQgaXMgYSBOZXVyYWwgTmV0d29yaz8nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJzNCbHVlMUJyb3duXFwncyBleGNlbGxlbnQgdmlzdWFsIGV4cGxhbmF0aW9uIG9mIG5ldXJhbCBuZXR3b3JrcycsXG4gICAgICAgIHRodW1ibmFpbFVybDogJ2h0dHBzOi8vaS55dGltZy5jb20vdmkvYWlyY0FydXZuS2svaHFkZWZhdWx0LmpwZycsXG4gICAgICAgIGNoYW5uZWw6ICczQmx1ZTFCcm93bicsXG4gICAgICAgIGVkdWNhdGlvbmFsVmFsdWU6ICdoaWdoJyxcbiAgICAgICAgZGlmZmljdWx0eTogJ2JlZ2lubmVyJyxcbiAgICAgICAgZW1iZWRkYWJsZTogdHJ1ZSxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgIH1cbiAgICBdLFxuICAgICduZXVyYWwtbmV0d29ya3MnOiBbXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdhaXJjQXJ1dm5LaycsXG4gICAgICAgIHRpdGxlOiAnQnV0IHdoYXQgaXMgYSBOZXVyYWwgTmV0d29yaz8nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Zpc3VhbCBhbmQgaW50dWl0aXZlIGV4cGxhbmF0aW9uIG9mIG5ldXJhbCBuZXR3b3JrcycsXG4gICAgICAgIHRodW1ibmFpbFVybDogJ2h0dHBzOi8vaS55dGltZy5jb20vdmkvYWlyY0FydXZuS2svaHFkZWZhdWx0LmpwZycsXG4gICAgICAgIGNoYW5uZWw6ICczQmx1ZTFCcm93bicsXG4gICAgICAgIGVkdWNhdGlvbmFsVmFsdWU6ICdoaWdoJyxcbiAgICAgICAgZGlmZmljdWx0eTogJ2JlZ2lubmVyJyxcbiAgICAgICAgZW1iZWRkYWJsZTogdHJ1ZSxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdJSFp3V0ZIV2EtdycsXG4gICAgICAgIHRpdGxlOiAnTmV1cmFsIE5ldHdvcmtzIEV4cGxhaW5lZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tcHJlaGVuc2l2ZSBuZXVyYWwgbmV0d29yayB0dXRvcmlhbCcsXG4gICAgICAgIHRodW1ibmFpbFVybDogJ2h0dHBzOi8vaS55dGltZy5jb20vdmkvSUhad1dGSFdhLXcvaHFkZWZhdWx0LmpwZycsXG4gICAgICAgIGNoYW5uZWw6ICdaYWNoIFN0YXInLFxuICAgICAgICBlZHVjYXRpb25hbFZhbHVlOiAnaGlnaCcsXG4gICAgICAgIGRpZmZpY3VsdHk6ICdpbnRlcm1lZGlhdGUnLFxuICAgICAgICBlbWJlZGRhYmxlOiB0cnVlLFxuICAgICAgICBsYW5ndWFnZTogJ2VuJ1xuICAgICAgfVxuICAgIF0sXG4gICAgJ2RlZXAtbGVhcm5pbmcnOiBbXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdSOU9IbjVaRjRVbycsXG4gICAgICAgIHRpdGxlOiAnRGVlcCBMZWFybmluZyBpbiA1IE1pbnV0ZXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1F1aWNrIGludHJvZHVjdGlvbiB0byBkZWVwIGxlYXJuaW5nIGNvbmNlcHRzJyxcbiAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9SOU9IbjVaRjRVby9ocWRlZmF1bHQuanBnJyxcbiAgICAgICAgY2hhbm5lbDogJ1NpcmFqIFJhdmFsJyxcbiAgICAgICAgZWR1Y2F0aW9uYWxWYWx1ZTogJ2hpZ2gnLFxuICAgICAgICBkaWZmaWN1bHR5OiAnYmVnaW5uZXInLFxuICAgICAgICBlbWJlZGRhYmxlOiB0cnVlLFxuICAgICAgICBsYW5ndWFnZTogJ2VuJ1xuICAgICAgfVxuICAgIF0sXG4gICAgJ3RyYW5zZm9ybWVycyc6IFtcbiAgICAgIHtcbiAgICAgICAgdmlkZW9JZDogJ2tDYzhGbUViMW5ZJyxcbiAgICAgICAgdGl0bGU6ICdBdHRlbnRpb24gaXMgQWxsIFlvdSBOZWVkIChUcmFuc2Zvcm1lcikgLSBNb2RlbCBleHBsYW5hdGlvbicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRGVlcCBkaXZlIGludG8gdHJhbnNmb3JtZXIgYXJjaGl0ZWN0dXJlJyxcbiAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9rQ2M4Rm1FYjFuWS9ocWRlZmF1bHQuanBnJyxcbiAgICAgICAgY2hhbm5lbDogJ1RoZSBBLkkuIEhhY2tlciAtIE1pY2hhZWwgUGhpJyxcbiAgICAgICAgZWR1Y2F0aW9uYWxWYWx1ZTogJ2hpZ2gnLFxuICAgICAgICBkaWZmaWN1bHR5OiAnYWR2YW5jZWQnLFxuICAgICAgICBlbWJlZGRhYmxlOiB0cnVlLFxuICAgICAgICBsYW5ndWFnZTogJ2VuJ1xuICAgICAgfVxuICAgIF0sXG4gICAgJ3Byb21wdC1lbmdpbmVlcmluZyc6IFtcbiAgICAgIHtcbiAgICAgICAgdmlkZW9JZDogJ2RPeFVyb1I1N3hzJyxcbiAgICAgICAgdGl0bGU6ICdQcm9tcHQgRW5naW5lZXJpbmcgR3VpZGUnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbXBsZXRlIGd1aWRlIHRvIGVmZmVjdGl2ZSBwcm9tcHQgZW5naW5lZXJpbmcnLFxuICAgICAgICB0aHVtYm5haWxVcmw6ICdodHRwczovL2kueXRpbWcuY29tL3ZpL2RPeFVyb1I1N3hzL2hxZGVmYXVsdC5qcGcnLFxuICAgICAgICBjaGFubmVsOiAnQUkgRXhwbGFpbmVkJyxcbiAgICAgICAgZWR1Y2F0aW9uYWxWYWx1ZTogJ2hpZ2gnLFxuICAgICAgICBkaWZmaWN1bHR5OiAnaW50ZXJtZWRpYXRlJyxcbiAgICAgICAgZW1iZWRkYWJsZTogdHJ1ZSxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgIH1cbiAgICBdLFxuICAgICdjb21wdXRlci12aXNpb24nOiBbXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdTUHV3eEl5UnBGSScsXG4gICAgICAgIHRpdGxlOiAnQ29tcHV0ZXIgVmlzaW9uIEV4cGxhaW5lZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSW50cm9kdWN0aW9uIHRvIGNvbXB1dGVyIHZpc2lvbiBhbmQgaW1hZ2UgcHJvY2Vzc2luZycsXG4gICAgICAgIHRodW1ibmFpbFVybDogJ2h0dHBzOi8vaS55dGltZy5jb20vdmkvU1B1d3hJeVJwRkkvaHFkZWZhdWx0LmpwZycsXG4gICAgICAgIGNoYW5uZWw6ICdDb21wdXRlcnBoaWxlJyxcbiAgICAgICAgZWR1Y2F0aW9uYWxWYWx1ZTogJ2hpZ2gnLFxuICAgICAgICBkaWZmaWN1bHR5OiAnaW50ZXJtZWRpYXRlJyxcbiAgICAgICAgZW1iZWRkYWJsZTogdHJ1ZSxcbiAgICAgICAgbGFuZ3VhZ2U6ICdlbidcbiAgICAgIH1cbiAgICBdLFxuICAgICdubHAnOiBbXG4gICAgICB7XG4gICAgICAgIHZpZGVvSWQ6ICdDTXJITThhM2hxdycsXG4gICAgICAgIHRpdGxlOiAnTmF0dXJhbCBMYW5ndWFnZSBQcm9jZXNzaW5nIEV4cGxhaW5lZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQ29tcHJlaGVuc2l2ZSBpbnRyb2R1Y3Rpb24gdG8gTkxQIGNvbmNlcHRzJyxcbiAgICAgICAgdGh1bWJuYWlsVXJsOiAnaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9DTXJITThhM2hxdy9ocWRlZmF1bHQuanBnJyxcbiAgICAgICAgY2hhbm5lbDogJ0NvbXB1dGVycGhpbGUnLFxuICAgICAgICBlZHVjYXRpb25hbFZhbHVlOiAnaGlnaCcsXG4gICAgICAgIGRpZmZpY3VsdHk6ICdpbnRlcm1lZGlhdGUnLFxuICAgICAgICBlbWJlZGRhYmxlOiB0cnVlLFxuICAgICAgICBsYW5ndWFnZTogJ2VuJ1xuICAgICAgfVxuICAgIF1cbiAgfTtcblxuICBjb25zdHJ1Y3Rvcih5b3V0dWJlQXBpS2V5Pzogc3RyaW5nKSB7XG4gICAgdGhpcy55b3V0dWJlQXBpS2V5ID0geW91dHViZUFwaUtleSB8fCBwcm9jZXNzLmVudi5ZT1VUVUJFX0FQSV9LRVkgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBGaW5kIHRoZSBtb3N0IHJlbGV2YW50IHZpZGVvIGZvciBhIGdpdmVuIHRvcGljIGFuZCB1c2VyIGNvbnRleHRcbiAgICovXG4gIGZpbmRCZXN0VmlkZW9Gb3JUb3BpYyhcbiAgICB0b3BpYzogc3RyaW5nLFxuICAgIGRpZmZpY3VsdHk6ICdiZWdpbm5lcicgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcgPSAnYmVnaW5uZXInLFxuICAgIGxhbmd1YWdlOiBzdHJpbmcgPSAnZW4nXG4gICk6IFZpZGVvUmVjb21tZW5kYXRpb24gfCBudWxsIHtcbiAgICBcbiAgICBjb25zdCBub3JtYWxpemVkVG9waWMgPSB0aGlzLm5vcm1hbGl6ZVRvcGljKHRvcGljKTtcbiAgICBcbiAgICAvLyBGaXJzdCwgdHJ5IGV4YWN0IG1hdGNoIGluIGN1cmF0ZWQgZGF0YWJhc2VcbiAgICBsZXQgdmlkZW9zID0gdGhpcy5jdXJhdGVkVmlkZW9EYXRhYmFzZVtub3JtYWxpemVkVG9waWNdIHx8IFtdO1xuICAgIFxuICAgIC8vIElmIG5vIGV4YWN0IG1hdGNoLCB0cnkgZnV6enkgbWF0Y2hpbmdcbiAgICBpZiAodmlkZW9zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdmlkZW9zID0gdGhpcy5maW5kVmlkZW9zQnlGdXp6eU1hdGNoKHRvcGljKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRmlsdGVyIGJ5IGNyaXRlcmlhXG4gICAgY29uc3QgZmlsdGVyZWRWaWRlb3MgPSB2aWRlb3MuZmlsdGVyKHZpZGVvID0+IHtcbiAgICAgIGNvbnN0IGRpZmZpY3VsdHlNYXRjaCA9ICF2aWRlby5kaWZmaWN1bHR5IHx8IFxuICAgICAgICB0aGlzLmlzRGlmZmljdWx0eU1hdGNoKHZpZGVvLmRpZmZpY3VsdHksIGRpZmZpY3VsdHkpO1xuICAgICAgY29uc3QgbGFuZ3VhZ2VNYXRjaCA9ICF2aWRlby5sYW5ndWFnZSB8fCB2aWRlby5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2UgfHwgbGFuZ3VhZ2UgPT09ICdhbnknO1xuICAgICAgY29uc3QgZW1iZWRkYWJsZSA9IHZpZGVvLmVtYmVkZGFibGUgIT09IGZhbHNlO1xuICAgICAgXG4gICAgICByZXR1cm4gZGlmZmljdWx0eU1hdGNoICYmIGxhbmd1YWdlTWF0Y2ggJiYgZW1iZWRkYWJsZTtcbiAgICB9KTtcblxuICAgIC8vIFNvcnQgYnkgcmVsZXZhbmNlIGFuZCBlZHVjYXRpb25hbCB2YWx1ZVxuICAgIGNvbnN0IHZpZGVvc0NvcHkgPSBbLi4uZmlsdGVyZWRWaWRlb3NdO1xuICAgIGNvbnN0IHNvcnRlZFZpZGVvcyA9IHZpZGVvc0NvcHkuc29ydCgoYSwgYikgPT4ge1xuICAgICAgY29uc3QgYVNjb3JlID0gdGhpcy5jYWxjdWxhdGVSZWxldmFuY2VTY29yZShhLCB0b3BpYywgZGlmZmljdWx0eSk7XG4gICAgICBjb25zdCBiU2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlKGIsIHRvcGljLCBkaWZmaWN1bHR5KTtcbiAgICAgIHJldHVybiBiU2NvcmUgLSBhU2NvcmU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc29ydGVkVmlkZW9zWzBdIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IG11bHRpcGxlIHZpZGVvIHJlY29tbWVuZGF0aW9ucyBmb3IgYSB0b3BpYyAoaW50ZXJuYWwgaW1wbGVtZW50YXRpb24pXG4gICAqL1xuICBnZXRWaWRlb1JlY29tbWVuZGF0aW9uc0ludGVybmFsKFxuICAgIHRvcGljOiBzdHJpbmcsXG4gICAgY291bnQ6IG51bWJlciA9IDMsXG4gICAgY3JpdGVyaWE/OiBQYXJ0aWFsPFZpZGVvU2VhcmNoQ3JpdGVyaWE+XG4gICk6IFZpZGVvUmVjb21tZW5kYXRpb25bXSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZFRvcGljID0gdGhpcy5ub3JtYWxpemVUb3BpYyh0b3BpYyk7XG4gICAgbGV0IHZpZGVvcyA9IHRoaXMuY3VyYXRlZFZpZGVvRGF0YWJhc2Vbbm9ybWFsaXplZFRvcGljXSB8fCBbXTtcbiAgICBcbiAgICAvLyBBZGQgZnV6enkgbWF0Y2hlc1xuICAgIHZpZGVvcyA9IFsuLi52aWRlb3MsIC4uLnRoaXMuZmluZFZpZGVvc0J5RnV6enlNYXRjaCh0b3BpYyldO1xuICAgIFxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzXG4gICAgdmlkZW9zID0gdmlkZW9zLmZpbHRlcigodmlkZW8sIGluZGV4LCBzZWxmKSA9PiBcbiAgICAgIGluZGV4ID09PSBzZWxmLmZpbmRJbmRleCh2ID0+IHYudmlkZW9JZCA9PT0gdmlkZW8udmlkZW9JZClcbiAgICApO1xuXG4gICAgLy8gQXBwbHkgY3JpdGVyaWEgZmlsdGVyc1xuICAgIGlmIChjcml0ZXJpYSkge1xuICAgICAgdmlkZW9zID0gdGhpcy5hcHBseVNlYXJjaENyaXRlcmlhKHZpZGVvcywgY3JpdGVyaWEpO1xuICAgIH1cblxuICAgIC8vIFNvcnQgYW5kIGxpbWl0XG4gICAgY29uc3QgdmlkZW9zQ29weSA9IFsuLi52aWRlb3NdO1xuICAgIGNvbnN0IHNvcnRlZFZpZGVvcyA9IHZpZGVvc0NvcHkuc29ydCgoYSwgYikgPT4gXG4gICAgICB0aGlzLmNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlKGIsIHRvcGljLCBjcml0ZXJpYT8uZGlmZmljdWx0eSkgLSBcbiAgICAgIHRoaXMuY2FsY3VsYXRlUmVsZXZhbmNlU2NvcmUoYSwgdG9waWMsIGNyaXRlcmlhPy5kaWZmaWN1bHR5KVxuICAgICk7XG4gICAgXG4gICAgcmV0dXJuIHNvcnRlZFZpZGVvcy5zbGljZSgwLCBjb3VudCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHZpZGVvIHJlY29tbWVuZGF0aW9ucyB1c2luZyBzZWFyY2ggY3JpdGVyaWEgb2JqZWN0XG4gICAqL1xuICBhc3luYyBnZXRWaWRlb1JlY29tbWVuZGF0aW9uc0J5Q3JpdGVyaWEoY3JpdGVyaWE6IFZpZGVvU2VhcmNoQ3JpdGVyaWEpOiBQcm9taXNlPFZpZGVvUmVjb21tZW5kYXRpb25bXT4ge1xuICAgIGNvbnN0IHRvcGljID0gY3JpdGVyaWEudG9waWM7XG4gICAgY29uc3QgY291bnQgPSAzOyAvLyBEZWZhdWx0IGNvdW50XG4gICAgXG4gICAgLy8gVXNlIHRoZSBleGlzdGluZyBtZXRob2Qgd2l0aCB0aGUgY3JpdGVyaWEgYXMgdGhpcmQgcGFyYW1ldGVyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLmdldFZpZGVvUmVjb21tZW5kYXRpb25zSW50ZXJuYWwodG9waWMsIGNvdW50LCBjcml0ZXJpYSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBtdWx0aXBsZSB2aWRlbyByZWNvbW1lbmRhdGlvbnMgZm9yIGEgdG9waWNcbiAgICovXG4gIGdldFZpZGVvUmVjb21tZW5kYXRpb25zKFxuICAgIHRvcGljOiBzdHJpbmcsXG4gICAgY291bnQ6IG51bWJlciA9IDMsXG4gICAgY3JpdGVyaWE/OiBQYXJ0aWFsPFZpZGVvU2VhcmNoQ3JpdGVyaWE+XG4gICk6IFZpZGVvUmVjb21tZW5kYXRpb25bXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0VmlkZW9SZWNvbW1lbmRhdGlvbnNJbnRlcm5hbCh0b3BpYywgY291bnQsIGNyaXRlcmlhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBsZWFybmluZyBwbGF5bGlzdCBmb3IgYSB0b3BpY1xuICAgKi9cbiAgY3JlYXRlTGVhcm5pbmdQbGF5bGlzdChcbiAgICB0b3BpYzogc3RyaW5nLFxuICAgIGRpZmZpY3VsdHk6ICdiZWdpbm5lcicgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcgPSAnYmVnaW5uZXInXG4gICk6IFZpZGVvUGxheWxpc3Qge1xuICAgIFxuICAgIGNvbnN0IHZpZGVvcyA9IHRoaXMuZ2V0VmlkZW9SZWNvbW1lbmRhdGlvbnModG9waWMsIDUsIHtcbiAgICAgIGRpZmZpY3VsdHksXG4gICAgICBlZHVjYXRpb25hbE9ubHk6IHRydWVcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBpZDogYHBsYXlsaXN0XyR7dG9waWN9XyR7ZGlmZmljdWx0eX1fJHtEYXRlLm5vdygpfWAsXG4gICAgICB0aXRsZTogYCR7dG9waWMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0b3BpYy5zbGljZSgxKX0gLSAke2RpZmZpY3VsdHl9IGxldmVsYCxcbiAgICAgIGRlc2NyaXB0aW9uOiBgQ3VyYXRlZCBsZWFybmluZyBwbGF5bGlzdCBmb3IgJHt0b3BpY30gYXQgJHtkaWZmaWN1bHR5fSBsZXZlbGAsXG4gICAgICB2aWRlb3MsXG4gICAgICB0b3BpYyxcbiAgICAgIHRvdGFsRHVyYXRpb246IHZpZGVvcy5yZWR1Y2UoKHRvdGFsLCB2aWRlbykgPT4ge1xuICAgICAgICBjb25zdCBkdXJhdGlvbiA9IHRoaXMucGFyc2VEdXJhdGlvbih2aWRlby5kdXJhdGlvbiB8fCAnMDowMCcpO1xuICAgICAgICByZXR1cm4gdG90YWwgKyBkdXJhdGlvbjtcbiAgICAgIH0sIDApXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBhIHZpZGVvIGlzIGVtYmVkZGFibGUgKHBsYWNlaG9sZGVyIGZvciByZWFsIEFQSSBjaGVjaylcbiAgICovXG4gIGFzeW5jIGNoZWNrRW1iZWRkYWJsZSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBUaGlzIHdvdWxkIHJlcXVpcmUgWW91VHViZSBBUEkgdG8gY2hlY2sgb2VtYmVkIGVuZHBvaW50XG4gICAgLy8gRm9yIG5vdywgcmV0dXJuIHRydWUgZm9yIGN1cmF0ZWQgdmlkZW9zXG4gICAgXG4gICAgY29uc3QgYWxsVmlkZW9zID0gT2JqZWN0LnZhbHVlcyh0aGlzLmN1cmF0ZWRWaWRlb0RhdGFiYXNlKS5mbGF0KCk7XG4gICAgY29uc3QgdmlkZW8gPSBhbGxWaWRlb3MuZmluZCh2ID0+IHYudmlkZW9JZCA9PT0gdmlkZW9JZCk7XG4gICAgXG4gICAgcmV0dXJuIHZpZGVvPy5lbWJlZGRhYmxlICE9PSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdmlkZW8gbWV0YWRhdGEgZnJvbSBZb3VUdWJlIEFQSSAoaWYgYXZhaWxhYmxlKVxuICAgKi9cbiAgYXN5bmMgZ2V0VmlkZW9NZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFZpZGVvUmVjb21tZW5kYXRpb24gfCBudWxsPiB7XG4gICAgaWYgKCF0aGlzLnlvdXR1YmVBcGlLZXkpIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGN1cmF0ZWQgZGF0YVxuICAgICAgY29uc3QgYWxsVmlkZW9zID0gT2JqZWN0LnZhbHVlcyh0aGlzLmN1cmF0ZWRWaWRlb0RhdGFiYXNlKS5mbGF0KCk7XG4gICAgICByZXR1cm4gYWxsVmlkZW9zLmZpbmQodiA9PiB2LnZpZGVvSWQgPT09IHZpZGVvSWQpIHx8IG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFlvdVR1YmUgQVBJIGNhbGwgd291bGQgZ28gaGVyZVxuICAgICAgLy8gRm9yIG5vdywgcmV0dXJuIGN1cmF0ZWQgZGF0YVxuICAgICAgY29uc3QgYWxsVmlkZW9zID0gT2JqZWN0LnZhbHVlcyh0aGlzLmN1cmF0ZWRWaWRlb0RhdGFiYXNlKS5mbGF0KCk7XG4gICAgICByZXR1cm4gYWxsVmlkZW9zLmZpbmQodiA9PiB2LnZpZGVvSWQgPT09IHZpZGVvSWQpIHx8IG51bGw7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHZpZGVvIG1ldGFkYXRhOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB2aWRlbyBlbWJlZCBVUkxcbiAgICovXG4gIGdldEVtYmVkVXJsKHZpZGVvSWQ6IHN0cmluZywgb3B0aW9ucz86IHtcbiAgICBhdXRvcGxheT86IGJvb2xlYW47XG4gICAgc3RhcnQ/OiBudW1iZXI7XG4gICAgZW5kPzogbnVtYmVyO1xuICAgIG1vZGVzdGJyYW5kaW5nPzogYm9vbGVhbjtcbiAgfSk6IHN0cmluZyB7XG4gICAgY29uc3QgYmFzZVVybCA9IGBodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8ke3ZpZGVvSWR9YDtcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgXG4gICAgaWYgKG9wdGlvbnM/LmF1dG9wbGF5KSBwYXJhbXMuc2V0KCdhdXRvcGxheScsICcxJyk7XG4gICAgaWYgKG9wdGlvbnM/LnN0YXJ0KSBwYXJhbXMuc2V0KCdzdGFydCcsIG9wdGlvbnMuc3RhcnQudG9TdHJpbmcoKSk7XG4gICAgaWYgKG9wdGlvbnM/LmVuZCkgcGFyYW1zLnNldCgnZW5kJywgb3B0aW9ucy5lbmQudG9TdHJpbmcoKSk7XG4gICAgaWYgKG9wdGlvbnM/Lm1vZGVzdGJyYW5kaW5nICE9PSBmYWxzZSkgcGFyYW1zLnNldCgnbW9kZXN0YnJhbmRpbmcnLCAnMScpO1xuICAgIFxuICAgIC8vIEVkdWNhdGlvbmFsLWZyaWVuZGx5IGRlZmF1bHRzXG4gICAgcGFyYW1zLnNldCgncmVsJywgJzAnKTsgLy8gRG9uJ3Qgc2hvdyByZWxhdGVkIHZpZGVvc1xuICAgIHBhcmFtcy5zZXQoJ2ZzJywgJzEnKTsgLy8gQWxsb3cgZnVsbHNjcmVlblxuICAgIHBhcmFtcy5zZXQoJ2NjX2xvYWRfcG9saWN5JywgJzEnKTsgLy8gU2hvdyBjYXB0aW9ucyB3aGVuIGF2YWlsYWJsZVxuICAgIFxuICAgIHJldHVybiBgJHtiYXNlVXJsfT8ke3BhcmFtcy50b1N0cmluZygpfWA7XG4gIH1cblxuICAvLyBQcml2YXRlIGhlbHBlciBtZXRob2RzXG4gIHByaXZhdGUgbm9ybWFsaXplVG9waWModG9waWM6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRvcGljLnRvTG93ZXJDYXNlKClcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csICctJylcbiAgICAgIC5yZXBsYWNlKC9bXlxcdy1dL2csICcnKTtcbiAgfVxuXG4gIHByaXZhdGUgZmluZFZpZGVvc0J5RnV6enlNYXRjaCh0b3BpYzogc3RyaW5nKTogVmlkZW9SZWNvbW1lbmRhdGlvbltdIHtcbiAgICBjb25zdCB0b3BpY0xvd2VyID0gdG9waWMudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBtYXRjaGVzOiBWaWRlb1JlY29tbWVuZGF0aW9uW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgW2tleSwgdmlkZW9zXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLmN1cmF0ZWRWaWRlb0RhdGFiYXNlKSkge1xuICAgICAgaWYgKGtleS5pbmNsdWRlcyh0b3BpY0xvd2VyKSB8fCB0b3BpY0xvd2VyLmluY2x1ZGVzKGtleS5yZXBsYWNlKCctJywgJyAnKSkpIHtcbiAgICAgICAgbWF0Y2hlcy5wdXNoKC4uLnZpZGVvcyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hdGNoZXM7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlKFxuICAgIHZpZGVvOiBWaWRlb1JlY29tbWVuZGF0aW9uLCBcbiAgICB0b3BpYzogc3RyaW5nLCBcbiAgICBkaWZmaWN1bHR5Pzogc3RyaW5nXG4gICk6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gMDtcblxuICAgIC8vIEVkdWNhdGlvbmFsIHZhbHVlIHdlaWdodFxuICAgIGlmICh2aWRlby5lZHVjYXRpb25hbFZhbHVlID09PSAnaGlnaCcpIHNjb3JlICs9IDM7XG4gICAgZWxzZSBpZiAodmlkZW8uZWR1Y2F0aW9uYWxWYWx1ZSA9PT0gJ21lZGl1bScpIHNjb3JlICs9IDI7XG4gICAgZWxzZSBzY29yZSArPSAxO1xuXG4gICAgLy8gRGlmZmljdWx0eSBtYXRjaFxuICAgIGlmIChkaWZmaWN1bHR5ICYmIHZpZGVvLmRpZmZpY3VsdHkgPT09IGRpZmZpY3VsdHkpIHNjb3JlICs9IDI7XG5cbiAgICAvLyBFbWJlZGRhYmxlIHByZWZlcmVuY2VcbiAgICBpZiAodmlkZW8uZW1iZWRkYWJsZSkgc2NvcmUgKz0gMTtcblxuICAgIC8vIFRydXN0ZWQgY2hhbm5lbCBib251c1xuICAgIGlmICh0aGlzLmlzVHJ1c3RlZENoYW5uZWwodmlkZW8uY2hhbm5lbCkpIHNjb3JlICs9IDI7XG5cbiAgICAvLyBUaXRsZSByZWxldmFuY2UgKHNpbXBsZSBrZXl3b3JkIG1hdGNoaW5nKVxuICAgIGNvbnN0IHRpdGxlTG93ZXIgPSB2aWRlby50aXRsZS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IHRvcGljTG93ZXIgPSB0b3BpYy50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh0aXRsZUxvd2VyLmluY2x1ZGVzKHRvcGljTG93ZXIpKSBzY29yZSArPSAyO1xuXG4gICAgcmV0dXJuIHNjb3JlO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0RpZmZpY3VsdHlNYXRjaChcbiAgICB2aWRlb0RpZmZpY3VsdHk6IHN0cmluZywgXG4gICAgcmVxdWVzdGVkRGlmZmljdWx0eTogc3RyaW5nXG4gICk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGxldmVscyA9IHsgJ2JlZ2lubmVyJzogMSwgJ2ludGVybWVkaWF0ZSc6IDIsICdhZHZhbmNlZCc6IDMgfTtcbiAgICBjb25zdCB2aWRlb0xldmVsID0gbGV2ZWxzW3ZpZGVvRGlmZmljdWx0eSBhcyBrZXlvZiB0eXBlb2YgbGV2ZWxzXSB8fCAyO1xuICAgIGNvbnN0IHJlcXVlc3RlZExldmVsID0gbGV2ZWxzW3JlcXVlc3RlZERpZmZpY3VsdHkgYXMga2V5b2YgdHlwZW9mIGxldmVsc10gfHwgMjtcbiAgICBcbiAgICAvLyBBbGxvdyB2aWRlb3Mgb25lIGxldmVsIHVwIG9yIGRvd25cbiAgICByZXR1cm4gTWF0aC5hYnModmlkZW9MZXZlbCAtIHJlcXVlc3RlZExldmVsKSA8PSAxO1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBseVNlYXJjaENyaXRlcmlhKFxuICAgIHZpZGVvczogVmlkZW9SZWNvbW1lbmRhdGlvbltdLCBcbiAgICBjcml0ZXJpYTogUGFydGlhbDxWaWRlb1NlYXJjaENyaXRlcmlhPlxuICApOiBWaWRlb1JlY29tbWVuZGF0aW9uW10ge1xuICAgIHJldHVybiB2aWRlb3MuZmlsdGVyKHZpZGVvID0+IHtcbiAgICAgIGlmIChjcml0ZXJpYS5kaWZmaWN1bHR5ICYmICF0aGlzLmlzRGlmZmljdWx0eU1hdGNoKHZpZGVvLmRpZmZpY3VsdHkgfHwgJ2ludGVybWVkaWF0ZScsIGNyaXRlcmlhLmRpZmZpY3VsdHkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGNyaXRlcmlhLmxhbmd1YWdlICYmIHZpZGVvLmxhbmd1YWdlICYmIHZpZGVvLmxhbmd1YWdlICE9PSBjcml0ZXJpYS5sYW5ndWFnZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChjcml0ZXJpYS5lZHVjYXRpb25hbE9ubHkgJiYgdmlkZW8uZWR1Y2F0aW9uYWxWYWx1ZSA9PT0gJ2xvdycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoY3JpdGVyaWEuZXhjbHVkZUNoYW5uZWxzICYmIHZpZGVvLmNoYW5uZWwgJiYgY3JpdGVyaWEuZXhjbHVkZUNoYW5uZWxzLmluY2x1ZGVzKHZpZGVvLmNoYW5uZWwpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGlzVHJ1c3RlZENoYW5uZWwoY2hhbm5lbE5hbWU/OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBpZiAoIWNoYW5uZWxOYW1lKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHRoaXMudHJ1c3RlZEVkdWNhdGlvbmFsQ2hhbm5lbHMuc29tZShcbiAgICAgIGNoYW5uZWwgPT4gY2hhbm5lbC5uYW1lID09PSBjaGFubmVsTmFtZVxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIHBhcnNlRHVyYXRpb24oZHVyYXRpb246IHN0cmluZyk6IG51bWJlciB7XG4gICAgLy8gUGFyc2UgZHVyYXRpb24gc3RyaW5nIGxpa2UgXCI1OjMwXCIgdG8gc2Vjb25kc1xuICAgIGNvbnN0IHBhcnRzID0gZHVyYXRpb24uc3BsaXQoJzonKS5yZXZlcnNlKCk7XG4gICAgbGV0IHNlY29uZHMgPSAwO1xuICAgIFxuICAgIHBhcnRzLmZvckVhY2goKHBhcnQsIGluZGV4KSA9PiB7XG4gICAgICBzZWNvbmRzICs9IHBhcnNlSW50KHBhcnQpICogTWF0aC5wb3coNjAsIGluZGV4KTtcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gc2Vjb25kcztcbiAgfVxufVxuXG4vLyBDcmVhdGUgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgdmlkZW9TZXJ2aWNlID0gbmV3IFZpZGVvU2VydmljZSgpO1xuIl0sIm5hbWVzIjpbIlZpZGVvU2VydmljZSIsImNvbnN0cnVjdG9yIiwieW91dHViZUFwaUtleSIsInRydXN0ZWRFZHVjYXRpb25hbENoYW5uZWxzIiwibmFtZSIsImNoYW5uZWxJZCIsImNhdGVnb3J5IiwicXVhbGl0eSIsImVtYmVkZGluZyIsImN1cmF0ZWRWaWRlb0RhdGFiYXNlIiwidmlkZW9JZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJ0aHVtYm5haWxVcmwiLCJjaGFubmVsIiwiZWR1Y2F0aW9uYWxWYWx1ZSIsImRpZmZpY3VsdHkiLCJlbWJlZGRhYmxlIiwibGFuZ3VhZ2UiLCJwcm9jZXNzIiwiZW52IiwiWU9VVFVCRV9BUElfS0VZIiwiZmluZEJlc3RWaWRlb0ZvclRvcGljIiwidG9waWMiLCJub3JtYWxpemVkVG9waWMiLCJub3JtYWxpemVUb3BpYyIsInZpZGVvcyIsImxlbmd0aCIsImZpbmRWaWRlb3NCeUZ1enp5TWF0Y2giLCJmaWx0ZXJlZFZpZGVvcyIsImZpbHRlciIsInZpZGVvIiwiZGlmZmljdWx0eU1hdGNoIiwiaXNEaWZmaWN1bHR5TWF0Y2giLCJsYW5ndWFnZU1hdGNoIiwidmlkZW9zQ29weSIsInNvcnRlZFZpZGVvcyIsInNvcnQiLCJhIiwiYiIsImFTY29yZSIsImNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlIiwiYlNjb3JlIiwiZ2V0VmlkZW9SZWNvbW1lbmRhdGlvbnNJbnRlcm5hbCIsImNvdW50IiwiY3JpdGVyaWEiLCJpbmRleCIsInNlbGYiLCJmaW5kSW5kZXgiLCJ2IiwiYXBwbHlTZWFyY2hDcml0ZXJpYSIsInNsaWNlIiwiZ2V0VmlkZW9SZWNvbW1lbmRhdGlvbnNCeUNyaXRlcmlhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJnZXRWaWRlb1JlY29tbWVuZGF0aW9ucyIsImNyZWF0ZUxlYXJuaW5nUGxheWxpc3QiLCJlZHVjYXRpb25hbE9ubHkiLCJpZCIsIkRhdGUiLCJub3ciLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInRvdGFsRHVyYXRpb24iLCJyZWR1Y2UiLCJ0b3RhbCIsImR1cmF0aW9uIiwicGFyc2VEdXJhdGlvbiIsImNoZWNrRW1iZWRkYWJsZSIsImFsbFZpZGVvcyIsIk9iamVjdCIsInZhbHVlcyIsImZsYXQiLCJmaW5kIiwiZ2V0VmlkZW9NZXRhZGF0YSIsImVycm9yIiwiY29uc29sZSIsImdldEVtYmVkVXJsIiwib3B0aW9ucyIsImJhc2VVcmwiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJhdXRvcGxheSIsInNldCIsInN0YXJ0IiwidG9TdHJpbmciLCJlbmQiLCJtb2Rlc3RicmFuZGluZyIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsInRvcGljTG93ZXIiLCJtYXRjaGVzIiwia2V5IiwiZW50cmllcyIsImluY2x1ZGVzIiwicHVzaCIsInNjb3JlIiwiaXNUcnVzdGVkQ2hhbm5lbCIsInRpdGxlTG93ZXIiLCJ2aWRlb0RpZmZpY3VsdHkiLCJyZXF1ZXN0ZWREaWZmaWN1bHR5IiwibGV2ZWxzIiwidmlkZW9MZXZlbCIsInJlcXVlc3RlZExldmVsIiwiTWF0aCIsImFicyIsImV4Y2x1ZGVDaGFubmVscyIsImNoYW5uZWxOYW1lIiwic29tZSIsInBhcnRzIiwic3BsaXQiLCJyZXZlcnNlIiwic2Vjb25kcyIsImZvckVhY2giLCJwYXJ0IiwicGFyc2VJbnQiLCJwb3ciLCJ2aWRlb1NlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/video-service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjnufloga%2FDocuments%2FHacknation%2Fprofai_mvp%2Fapp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();